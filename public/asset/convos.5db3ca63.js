!function(){"use strict";function e(){}const n=e=>e;function t(e,n){for(const t in n)e[t]=n[t];return e}function a(e){return e()}function r(){return Object.create(null)}function o(e){e.forEach(a)}function i(e){return"function"==typeof e}function s(e,n){return e!=e?n==n:e!==n||e&&"object"==typeof e||"function"==typeof e}function c(e,n){const t=e.subscribe(n);return t.unsubscribe?()=>t.unsubscribe():t}function d(e){let n;return c(e,e=>n=e)(),n}function u(e,n,t){e.$$.on_destroy.push(c(n,t))}function l(e,n,t){if(e){const a=f(e,n,t);return e[0](a)}}function f(e,n,a){return e[1]?t({},t(n.$$scope.ctx,e[1](a?a(n):{}))):n.$$scope.ctx}function p(e,n,a,r){return e[1]?t({},t(n.$$scope.changed||{},e[1](r?r(a):{}))):n.$$scope.changed||{}}function g(e,n,t=n){return e.set(t),n}const m="undefined"!=typeof window;let h=m?()=>window.performance.now():()=>Date.now(),$=m?e=>requestAnimationFrame(e):e;const v=new Set;let b,y=!1;function _(){v.forEach(e=>{e[0](h())||(v.delete(e),e[1]())}),(y=v.size>0)&&$(_)}function w(e,n){e.appendChild(n)}function x(e,n,t){e.insertBefore(n,t||null)}function k(e){e.parentNode.removeChild(e)}function E(e,n){for(let t=0;t<e.length;t+=1)e[t]&&e[t].d(n)}function O(e){return document.createElement(e)}function N(e){return document.createTextNode(e)}function S(){return N(" ")}function A(){return N("")}function C(e,n,t,a){return e.addEventListener(n,t,a),()=>e.removeEventListener(n,t,a)}function M(e){return function(n){return n.preventDefault(),e.call(this,n)}}function D(e,n,t){null==t?e.removeAttribute(n):e.setAttribute(n,t)}function T(e,n){n=""+n,e.data!==n&&(e.data=n)}function P(e,n){(null!=n||e.value)&&(e.value=n)}function L(e,n,t,a){e.style.setProperty(n,t,a?"important":"")}function R(e,n,t){e.classList[t?"add":"remove"](n)}class j{constructor(e,n=null){this.e=O("div"),this.a=n,this.u(e)}m(e,n=null){for(let t=0;t<this.n.length;t+=1)x(e,this.n[t],n);this.t=e}u(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}p(e){this.d(),this.u(e),this.m(this.t,this.a)}d(){this.n.forEach(k)}}let I,U=0,B={};function H(e,n,t,a,r,o,i,s=0){const c=16.666/a;let d="{\n";for(let e=0;e<=1;e+=c){const a=n+(t-n)*o(e);d+=100*e+`%{${i(a,1-a)}}\n`}const u=d+`100% {${i(t,1-t)}}\n}`,l=`__svelte_${function(e){let n=5381,t=e.length;for(;t--;)n=(n<<5)-n^e.charCodeAt(t);return n>>>0}(u)}_${s}`;if(!B[l]){if(!b){const e=O("style");document.head.appendChild(e),b=e.sheet}B[l]=!0,b.insertRule(`@keyframes ${l} ${u}`,b.cssRules.length)}const f=e.style.animation||"";return e.style.animation=`${f?`${f}, `:""}${l} ${a}ms linear ${r}ms 1 both`,U+=1,l}function z(e,n){e.style.animation=(e.style.animation||"").split(", ").filter(n?e=>e.indexOf(n)<0:e=>-1===e.indexOf("__svelte")).join(", "),n&&!--U&&$(()=>{if(U)return;let e=b.cssRules.length;for(;e--;)b.deleteRule(e);B={}})}function q(e){I=e}function F(){if(!I)throw new Error("Function called outside component initialization");return I}function K(e){F().$$.on_mount.push(e)}function G(e,n){F().$$.context.set(e,n)}function W(e){return F().$$.context.get(e)}function Z(e,n){const t=e.$$.callbacks[n.type];t&&t.slice().forEach(e=>e(n))}const V=[],Y=[],J=[],Q=[],X=Promise.resolve();let ee,ne=!1;function te(){ne||(ne=!0,X.then(oe))}function ae(e){J.push(e)}function re(e){Q.push(e)}function oe(){const e=new Set;do{for(;V.length;){const e=V.shift();q(e),ie(e.$$)}for(;Y.length;)Y.pop()();for(let n=0;n<J.length;n+=1){const t=J[n];e.has(t)||(t(),e.add(t))}J.length=0}while(V.length);for(;Q.length;)Q.pop()();ne=!1}function ie(e){e.fragment&&(e.update(e.dirty),o(e.before_update),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_update.forEach(ae))}function se(e,n,t){e.dispatchEvent(function(e,n){const t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!1,!1,n),t}(`${n?"intro":"outro"}${t}`))}const ce=new Set;let de;function ue(){de={r:0,c:[],p:de}}function le(){de.r||o(de.c),de=de.p}function fe(e,n){e&&e.i&&(ce.delete(e),e.i(n))}function pe(e,n,t,a){if(e&&e.o){if(ce.has(e))return;ce.add(e),de.c.push(()=>{ce.delete(e),a&&(t&&e.d(1),a())}),e.o(n)}}const ge={duration:0};function me(t,a,r,s){let c=a(t,r),d=s?0:1,u=null,l=null,f=null;function p(){f&&z(t,f)}function g(e,n){const t=e.b-d;return n*=Math.abs(t),{a:d,b:e.b,d:t,duration:n,start:e.start,end:e.start+n,group:e.group}}function m(a){const{delay:r=0,duration:i=300,easing:s=n,tick:m=e,css:b}=c||ge,w={start:h()+r,b:a};a||(w.group=de,de.r+=1),u?l=w:(b&&(p(),f=H(t,d,a,i,r,s,b)),a&&m(0,1),u=g(w,i),ae(()=>se(t,a,"start")),function(e){let n;y||(y=!0,$(_)),new Promise(t=>{v.add(n=[e,t])})}(e=>{if(l&&e>l.start&&(u=g(l,i),l=null,se(t,u.b,"start"),b&&(p(),f=H(t,d,u.b,u.duration,0,s,c.css))),u)if(e>=u.end)m(d=u.b,1-d),se(t,u.b,"end"),l||(u.b?p():--u.group.r||o(u.group.c)),u=null;else if(e>=u.start){const n=e-u.start;d=u.a+u.d*s(n/u.duration),m(d,1-d)}return!(!u&&!l)}))}return{run(e){i(c)?(ee||(ee=Promise.resolve()).then(()=>{ee=null}),ee).then(()=>{c=c(),m(e)}):m(e)},end(){p(),u=l=null}}}const he="undefined"!=typeof window?window:global;function $e(e,n,t){-1!==e.$$.props.indexOf(n)&&(e.$$.bound[n]=t,t(e.$$.ctx[n]))}function ve(e,n,t){const{fragment:r,on_mount:s,on_destroy:c,after_update:d}=e.$$;r.m(n,t),ae(()=>{const n=s.map(a).filter(i);c?c.push(...n):o(n),e.$$.on_mount=[]}),d.forEach(ae)}function be(e,n){e.$$.fragment&&(o(e.$$.on_destroy),e.$$.fragment.d(n),e.$$.on_destroy=e.$$.fragment=null,e.$$.ctx={})}function ye(n,t,a,i,s,c){const d=I;q(n);const u=t.props||{},l=n.$$={fragment:null,ctx:null,props:c,update:e,not_equal:s,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:r(),dirty:null};let f=!1;l.ctx=a?a(n,u,(e,t,a=t)=>(l.ctx&&s(l.ctx[e],l.ctx[e]=a)&&(l.bound[e]&&l.bound[e](a),f&&function(e,n){e.$$.dirty||(V.push(e),te(),e.$$.dirty=r()),e.$$.dirty[n]=!0}(n,e)),t)):u,l.update(),f=!0,o(l.before_update),l.fragment=i(l.ctx),t.target&&(t.hydrate?l.fragment.l(function(e){return Array.from(e.childNodes)}(t.target)):l.fragment.c(),t.intro&&fe(n.$$.fragment),ve(n,t.target,t.anchor),oe()),q(d)}class _e{$destroy(){be(this,1),this.$destroy=e}$on(e,n){const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const e=t.indexOf(n);-1!==e&&t.splice(e,1)}}$set(){}}function we(e,n){return e(n={exports:{}},n.exports),n.exports}var xe=we((function(e){var n=function(e){var n,t=Object.prototype,a=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function c(e,n,t,a){var r=n&&n.prototype instanceof m?n:m,o=Object.create(r.prototype),i=new N(a||[]);return o._invoke=function(e,n,t){var a=u;return function(r,o){if(a===f)throw new Error("Generator is already running");if(a===p){if("throw"===r)throw o;return A()}for(t.method=r,t.arg=o;;){var i=t.delegate;if(i){var s=k(i,t);if(s){if(s===g)continue;return s}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(a===u)throw a=p,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);a=f;var c=d(e,n,t);if("normal"===c.type){if(a=t.done?p:l,c.arg===g)continue;return{value:c.arg,done:t.done}}"throw"===c.type&&(a=p,t.method="throw",t.arg=c.arg)}}}(e,t,i),o}function d(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var u="suspendedStart",l="suspendedYield",f="executing",p="completed",g={};function m(){}function h(){}function $(){}var v={};v[o]=function(){return this};var b=Object.getPrototypeOf,y=b&&b(b(S([])));y&&y!==t&&a.call(y,o)&&(v=y);var _=$.prototype=m.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(n){e[n]=function(e){return this._invoke(n,e)}}))}function x(e){var n;this._invoke=function(t,r){function o(){return new Promise((function(n,o){!function n(t,r,o,i){var s=d(e[t],e,r);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==typeof u&&a.call(u,"__await")?Promise.resolve(u.__await).then((function(e){n("next",e,o,i)}),(function(e){n("throw",e,o,i)})):Promise.resolve(u).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,i)}))}i(s.arg)}(t,r,n,o)}))}return n=n?n.then(o,o):o()}}function k(e,t){var a=e.iterator[t.method];if(a===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,k(e,t),"throw"===t.method))return g;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var r=d(a,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,g;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,g):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function E(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function O(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return i.next=i}}return{next:A}}function A(){return{value:n,done:!0}}return h.prototype=_.constructor=$,$.constructor=h,$[s]=h.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===h||"GeneratorFunction"===(n.displayName||n.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,$):(e.__proto__=$,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},w(x.prototype),x.prototype[i]=function(){return this},e.AsyncIterator=x,e.async=function(n,t,a,r){var o=new x(c(n,t,a,r));return e.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(_),_[s]="Generator",_[o]=function(){return this},_.toString=function(){return"[object Generator]"},e.keys=function(e){var n=[];for(var t in e)n.push(t);return n.reverse(),function t(){for(;n.length;){var a=n.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=S,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(a,r){return s.type="throw",s.arg=e,t.next=a,r&&(t.method="next",t.arg=n),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=a.call(i,"catchLoc"),d=a.call(i,"finallyLoc");if(c&&d){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=n,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),g},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),O(t),g}},catch:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===e){var a=t.completion;if("throw"===a.type){var r=a.arg;O(t)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=n),g}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}}));function ke(e,n,t,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void t(e)}s.done?n(c):Promise.resolve(c).then(a,r)}var Ee=function(e){return function(){var n=this,t=arguments;return new Promise((function(a,r){var o=e.apply(n,t);function i(e){ke(o,a,r,i,s,"next",e)}function s(e){ke(o,a,r,i,s,"throw",e)}i(void 0)}))}};var Oe=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")};function Ne(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var Se=function(e,n,t){return n&&Ne(e.prototype,n),t&&Ne(e,t),e},Ae=we((function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t(a){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=t=function(e){return n(e)}:e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},t(a)}e.exports=t}));var Ce=function(e){if(Array.isArray(e))return e};var Me=function(e,n){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var t=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(t.push(i.value),!n||t.length!==n);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return t}};var De=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")};var Te=function(e,n){return Ce(e)||Me(e,n)||De()};var Pe=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e};var Le=function(e,n){return!n||"object"!==Ae(n)&&"function"!=typeof n?Pe(e):n},Re=we((function(e){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n})),je=we((function(e){function n(t,a){return e.exports=n=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},n(t,a)}e.exports=n}));var Ie=function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&je(e,n)};var Ue=function(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e},Be=function(){function e(){Oe(this,e),this._on={},this._proxyTo={},this._reactiveAttr={},this._syncWithLocalStorage={}}return Se(e,[{key:"emit",value:function(e,n){var t=this._on[e];if(!t)return this;for(var a=0;a<t.length;a++)t[a][0](n);return this}},{key:"on",value:function(e,n){var t=n?null:new Promise((function(e){n=e})),a=this._on[e]||(this._on[e]=[]),r=[n];a.push(r);var o=function(){var e=a.indexOf(r);-1!=e&&a.splice(e,1)};return t?t.finally(o):o}},{key:"subscribe",value:function(e){return e(this),this.on("update",e)}},{key:"update",value:function(e){for(var n=this,t=Object.keys(e),a=0,r=0;r<t.length;r++){var o=t[r];this._proxyTo[o]?this[this._proxyTo[o]].update(Ue({},o,e[o])):this._reactiveAttr.hasOwnProperty(o)&&(this._reactiveAttr[o]!==e[o]&&a++,this._reactiveAttr[o]=e[o]),this._syncWithLocalStorage[o]&&this._localStorage(o,this._reactiveAttr[o])}return(!this._updatedTid&&a||0==t.length)&&(this._updatedTid=setTimeout((function(){delete n._updatedTid,n.emit("update",n)}),1)),this}},{key:"_localStorage",value:function(e,n){return e="convos:"+e,2==arguments.length?localStorage.setItem(e,JSON.stringify(n)):localStorage.hasOwnProperty(e)?JSON.parse(localStorage.getItem(e)):void 0}},{key:"_localStorageAttr",value:function(e,n){var t=this._localStorage(e);this._updateableAttr(e,void 0===t?n:t),this._syncWithLocalStorage[e]=!0,void 0===t&&this._localStorage(e,n)}},{key:"_proxyAttr",value:function(e,n){var t=this;this._proxyTo[e]=n,Object.defineProperty(this,e,{get:function(){return t[n]._reactiveAttr[e]}})}},{key:"_readOnlyAttr",value:function(e,n){if(void 0===n)throw'Read-only attribute "'+e+'" cannot be undefined for '+this.constructor.name;var t="function"==typeof n?{get:n}:{value:n,writable:!1};Object.defineProperty(this,e,t)}},{key:"_updateableAttr",value:function(e,n){var t=this;this._reactiveAttr[e]=n,Object.defineProperty(this,e,{get:function(){return t._reactiveAttr[e]}})}}]),e}(),He=.618033988749;function ze(e,n){var t;return function(){for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];var i=this;t&&clearTimeout(t),t=setTimeout((function(){e.apply(i,r)}),n)}}function qe(e){return(e||"").split("").map((function(e){return"has-mode-"+e})).join(" ")}function Fe(e,n){for(;e;){if(n.tagName?e==n:e.matches&&e.matches(n))return e;e=e.parentNode}return null}function Ke(e,n,t){var a=e&&e.querySelector("."+n.split(" ").join("."));return a||((a=document.createElement("div")).className=n,e&&e.appendChild(a),t&&t(a),a)}function Ge(e){var n=e.errors;return n&&n[0]?n[0].message||"Unknown error.":""}function We(e){var n=document,t=e.replace(/\W/g,"_");if(!n.getElementById(t)){var a=n.createElement("script"),r=[t,e];a.id=r[0],a.src=r[1],n.getElementsByTagName("head")[0].appendChild(a)}}function Ze(e,n,t){var a=e.querySelectorAll(n);if(!t)return[].slice.call(a,0);for(var r=[],o=0;o<a.length;o++)r.push(t(a[o],o));return r}function Ve(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function Ye(e,n){return"is-visible"===n?!e.hasAttribute("hidden"):("toggle"===n&&(n=e.hasAttribute("hidden")),n?e.removeAttribute("hidden"):e.setAttribute("hidden",""))}function Je(e,n){return e.name.localeCompare(n.name)}function Qe(e,n){return e&&e.tagName&&e.tagName.toLowerCase()===n}function Xe(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;if(0==e.length)return"#000";for(var t=0,a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<5)-t),t&=t;return"#"+function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.95,a=Math.floor(6*e),r=6*e-a,o=t*(1-n),i=t*(1-r*n),s=t*(1-(1-r)*n),c=255,d=255,u=255;switch(a){case 0:c=t,d=s,u=o;break;case 1:c=i,d=t,u=o;break;case 2:c=o,d=t,u=s;break;case 3:c=o,d=i,u=t;break;case 4:c=s,d=o,u=t;break;case 5:c=t,d=o,u=i}return[Math.floor(255*c),Math.floor(255*d),Math.floor(255*u)]}(((t=Math.abs(t%n/n))+He)%1,.4,.7).map((function(e){return e.toString(16)})).join("")}function en(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)}))}var nn=["error","loading","pending","success"],tn=function(e){function n(e){var t;return Oe(this,n),(t=Le(this,Re(n).call(this)))._readOnlyAttr("api",e.api),t._readOnlyAttr("defaultParams",e.defaultParams||{}),t._readOnlyAttr("id",e.id),t._readOnlyAttr("req",{body:null,headers:{}}),t._readOnlyAttr("res",{body:{},headers:{}}),t._updateableAttr("err",null),t._updateableAttr("status","pending"),t}return Ie(n,e),Se(n,[{key:"error",value:function(e){if(e)return this.update({err:Array.isArray(e)?e:[{message:e}],status:"error"});if(this.err&&this.err.length){var n=this.err[0],t=n.path&&n.path.match(/\w$/)&&n.path.split("/").pop();return t?t+": "+n.message:n.message}return""}},{key:"perform",value:function(e){var n=this;return this._promise||(this._promise=new Promise(function(){var t=Ee(xe.mark((function t(a){var r,o,i,s,c,d;return xe.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.api.spec(n.id);case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return",a(n.error('Invalid operationId "'+n.id+'".')));case 5:return n.update({status:"loading"}),t.next=8,n._paramsToRequest(r,e||n.defaultParams);case 8:return o=t.sent,i=Te(o,2),s=i[0],c=i[1],n.emit("start",c),"object"==Ae(c.body)&&(c.body=JSON.stringify(c.body)),t.next=16,fetch(s,c);case 16:d=t.sent,delete n._promise,d.json().then((function(e){return a(n.parse(d,e))}));case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))}},{key:"is",value:function(e){if(-1==nn.indexOf(e))throw"Invalid status: "+e;return this.status==e}},{key:"parse",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.body;this.res.body=n||e,this.res.status=e.status||"201",this.res.statusText=e.statusText,e.headers&&(this.res.headers=e.headers);var t=null;return String(this.res.status).match(/^[23]/)||(t=n&&n.errors?n.errors:[{message:e.statusText||"Unknown error."}]),this.update({err:t,status:t?"error":"success"})}},{key:"reset",value:function(){return this.res.body={},this.res.headers={},this.res.status=0,this.update({err:null,status:"pending"})}},{key:"_extractValue",value:function(e,n){if(n.schema&&"form"==(e.tagName||"").toLowerCase()){var t={};return Object.keys(n.schema.properties).forEach((function(n){t[n]=e[n]&&e[n].value})),t}if(e[n.name]&&e[n.name].tagName)return e[n.name].value;if(n.schema){var a={};return Object.keys(n.schema.properties).forEach((function(n){a[n]=e[n]})),a}return e[n.name]}},{key:"_hasProperty",value:function(e,n){return"body"==n.in||("form"==(e.tagName||"").toLowerCase()?!!e[n.name]:e.hasOwnProperty(n.name))}},{key:"_paramsToRequest",value:function(e,n){var t=this,a={headers:this.req.headers,method:e.method},r=new URL(e.url);return(e.parameters||[]).forEach((function(e){if(t._hasProperty(n,e)||e.required)if("path"==e.in){var o=new RegExp("(%7B|\\{)"+Ve(e.name)+"(%7D|\\})","i");r.pathname=r.pathname.replace(o,t._extractValue(n,e))}else if("query"==e.in)r.searchParams.set(e.name,t._extractValue(n,e));else if("body"==e.in)a.body=t._extractValue(n,e);else{if("header"!=e.in)throw"[Api] Parameter in:"+e.in+" is not supported.";a.header[e.name]=t._extractValue(n,e.name)}})),[r,a]}}]),n}(Be),an=function(){function e(n){Oe(this,e),this.protocol=location.protocol,this.url=n}var n;return Se(e,[{key:"operation",value:function(e,n){var t=new tn({api:this,id:e,defaultParams:n});return t.req.headers={"Content-Type":"application/json"},t}},{key:"spec",value:(n=Ee(xe.mark((function e(n){var t,a,r=this;return xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._op||!n){e.next=2;break}return e.abrupt("return",this._op[n]);case 2:if(!this._spec){e.next=4;break}return e.abrupt("return",this._spec);case 4:return e.next=6,fetch(this.url);case 6:return t=e.sent,e.next=9,t.json();case 9:if(a=e.sent,this._op={},this._spec=a,Object.keys(a.paths).forEach((function(e){Object.keys(a.paths[e]).forEach((function(n){var t=a.paths[e][n],o=t.operationId;o&&(t.method=n.toUpperCase(),t.url=r.protocol+"//"+a.host+a.basePath+e+".json",t.parameters=(t.parameters||[]).map((function(e){if(!e.$ref)return e;for(var n=e.$ref.replace(/^#\//,"").split("/"),t=a;n.length;)t=t[n.shift()];return t})),r._op[o]=t)}))})),!this._op||!n){e.next=15;break}return e.abrupt("return",this._op[n]);case 15:if(!this._spec){e.next=17;break}return e.abrupt("return",this._spec);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),e}(),rn=we((function(e,n){var t,a;t=function(e){var n=[],t=Object.keys,a={},r={},o=/^(no-?highlight|plain|text)$/i,i=/\blang(?:uage)?-([\w-]+)\b/i,s=/((^(<[^>]+>|\t|)+|(?:\n)))/gm,c="</span>",d={classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:void 0};function u(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function l(e){return e.nodeName.toLowerCase()}function f(e,n){var t=e&&e.exec(n);return t&&0===t.index}function p(e){return o.test(e)}function g(e){var n,t={},a=Array.prototype.slice.call(arguments,1);for(n in e)t[n]=e[n];return a.forEach((function(e){for(n in e)t[n]=e[n]})),t}function m(e){var n=[];return function e(t,a){for(var r=t.firstChild;r;r=r.nextSibling)3===r.nodeType?a+=r.nodeValue.length:1===r.nodeType&&(n.push({event:"start",offset:a,node:r}),a=e(r,a),l(r).match(/br|hr|img|input/)||n.push({event:"stop",offset:a,node:r}));return a}(e,0),n}function h(e){function n(e){return e&&e.source||e}function a(t,a){return new RegExp(n(t),"m"+(e.case_insensitive?"i":"")+(a?"g":""))}!function r(o,i){if(!o.compiled){if(o.compiled=!0,o.keywords=o.keywords||o.beginKeywords,o.keywords){var s={},c=function(n,t){e.case_insensitive&&(t=t.toLowerCase()),t.split(" ").forEach((function(e){var t=e.split("|");s[t[0]]=[n,t[1]?Number(t[1]):1]}))};"string"==typeof o.keywords?c("keyword",o.keywords):t(o.keywords).forEach((function(e){c(e,o.keywords[e])})),o.keywords=s}o.lexemesRe=a(o.lexemes||/\w+/,!0),i&&(o.beginKeywords&&(o.begin="\\b("+o.beginKeywords.split(" ").join("|")+")\\b"),o.begin||(o.begin=/\B|\b/),o.beginRe=a(o.begin),o.endSameAsBegin&&(o.end=o.begin),o.end||o.endsWithParent||(o.end=/\B|\b/),o.end&&(o.endRe=a(o.end)),o.terminator_end=n(o.end)||"",o.endsWithParent&&i.terminator_end&&(o.terminator_end+=(o.end?"|":"")+i.terminator_end)),o.illegal&&(o.illegalRe=a(o.illegal)),null==o.relevance&&(o.relevance=1),o.contains||(o.contains=[]),o.contains=Array.prototype.concat.apply([],o.contains.map((function(e){return function(e){return e.variants&&!e.cached_variants&&(e.cached_variants=e.variants.map((function(n){return g(e,{variants:null},n)}))),e.cached_variants||e.endsWithParent&&[g(e)]||[e]}("self"===e?o:e)}))),o.contains.forEach((function(e){r(e,o)})),o.starts&&r(o.starts,i);var d=o.contains.map((function(e){return e.beginKeywords?"\\.?(?:"+e.begin+")\\.?":e.begin})).concat([o.terminator_end,o.illegal]).map(n).filter(Boolean);o.terminators=d.length?a(function(e,t){for(var a=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./,r=0,o="",i=0;i<e.length;i++){var s=r,c=n(e[i]);for(i>0&&(o+=t);c.length>0;){var d=a.exec(c);if(null==d){o+=c;break}o+=c.substring(0,d.index),c=c.substring(d.index+d[0].length),"\\"==d[0][0]&&d[1]?o+="\\"+String(Number(d[1])+s):(o+=d[0],"("==d[0]&&r++)}}return o}(d,"|"),!0):{exec:function(){return null}}}}(e)}function $(e,n,t,r){function o(e){return new RegExp(e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"m")}function i(e,n){var t=m.case_insensitive?n[0].toLowerCase():n[0];return e.keywords.hasOwnProperty(t)&&e.keywords[t]}function s(e,n,t,a){var r='<span class="'+(a?"":d.classPrefix);return e?(r+=e+'">')+n+(t?"":c):n}function l(){x+=null!=y.subLanguage?function(){var e="string"==typeof y.subLanguage;if(e&&!a[y.subLanguage])return u(k);var n=e?$(y.subLanguage,k,!0,_[y.subLanguage]):v(k,y.subLanguage.length?y.subLanguage:void 0);return y.relevance>0&&(E+=n.relevance),e&&(_[y.subLanguage]=n.top),s(n.language,n.value,!1,!0)}():function(){var e,n,t,a;if(!y.keywords)return u(k);for(a="",n=0,y.lexemesRe.lastIndex=0,t=y.lexemesRe.exec(k);t;)a+=u(k.substring(n,t.index)),(e=i(y,t))?(E+=e[1],a+=s(e[0],u(t[0]))):a+=u(t[0]),n=y.lexemesRe.lastIndex,t=y.lexemesRe.exec(k);return a+u(k.substr(n))}(),k=""}function p(e){x+=e.className?s(e.className,"",!0):"",y=Object.create(e,{parent:{value:y}})}function g(e,n){if(k+=e,null==n)return l(),0;var a=function(e,n){var t,a;for(t=0,a=n.contains.length;t<a;t++)if(f(n.contains[t].beginRe,e))return n.contains[t].endSameAsBegin&&(n.contains[t].endRe=o(n.contains[t].beginRe.exec(e)[0])),n.contains[t]}(n,y);if(a)return a.skip?k+=n:(a.excludeBegin&&(k+=n),l(),a.returnBegin||a.excludeBegin||(k=n)),p(a),a.returnBegin?0:n.length;var r=function e(n,t){if(f(n.endRe,t)){for(;n.endsParent&&n.parent;)n=n.parent;return n}if(n.endsWithParent)return e(n.parent,t)}(y,n);if(r){var i=y;i.skip?k+=n:(i.returnEnd||i.excludeEnd||(k+=n),l(),i.excludeEnd&&(k=n));do{y.className&&(x+=c),y.skip||y.subLanguage||(E+=y.relevance),y=y.parent}while(y!==r.parent);return r.starts&&(r.endSameAsBegin&&(r.starts.endRe=r.endRe),p(r.starts)),i.returnEnd?0:n.length}if(function(e,n){return!t&&f(n.illegalRe,e)}(n,y))throw new Error('Illegal lexeme "'+n+'" for mode "'+(y.className||"<unnamed>")+'"');return k+=n,n.length||1}var m=w(e);if(!m)throw new Error('Unknown language: "'+e+'"');h(m);var b,y=r||m,_={},x="";for(b=y;b!==m;b=b.parent)b.className&&(x=s(b.className,"",!0)+x);var k="",E=0;try{for(var O,N,S=0;y.terminators.lastIndex=S,O=y.terminators.exec(n);)N=g(n.substring(S,O.index),O[0]),S=O.index+N;for(g(n.substr(S)),b=y;b.parent;b=b.parent)b.className&&(x+=c);return{relevance:E,value:x,language:e,top:y}}catch(e){if(e.message&&-1!==e.message.indexOf("Illegal"))return{relevance:0,value:u(n)};throw e}}function v(e,n){n=n||d.languages||t(a);var r={relevance:0,value:u(e)},o=r;return n.filter(w).filter(x).forEach((function(n){var t=$(n,e,!1);t.language=n,t.relevance>o.relevance&&(o=t),t.relevance>r.relevance&&(o=r,r=t)})),o.language&&(r.second_best=o),r}function b(e){return d.tabReplace||d.useBR?e.replace(s,(function(e,n){return d.useBR&&"\n"===e?"<br>":d.tabReplace?n.replace(/\t/g,d.tabReplace):""})):e}function y(e){var t,a,o,s,c,f=function(e){var n,t,a,r,o=e.className+" ";if(o+=e.parentNode?e.parentNode.className:"",t=i.exec(o))return w(t[1])?t[1]:"no-highlight";for(n=0,a=(o=o.split(/\s+/)).length;n<a;n++)if(p(r=o[n])||w(r))return r}(e);p(f)||(d.useBR?(t=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=e.innerHTML.replace(/\n/g,"").replace(/<br[ \/]*>/g,"\n"):t=e,c=t.textContent,o=f?$(f,c,!0):v(c),(a=m(t)).length&&((s=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=o.value,o.value=function(e,t,a){var r=0,o="",i=[];function s(){return e.length&&t.length?e[0].offset!==t[0].offset?e[0].offset<t[0].offset?e:t:"start"===t[0].event?e:t:e.length?e:t}function c(e){o+="<"+l(e)+n.map.call(e.attributes,(function(e){return" "+e.nodeName+'="'+u(e.value).replace('"',"&quot;")+'"'})).join("")+">"}function d(e){o+="</"+l(e)+">"}function f(e){("start"===e.event?c:d)(e.node)}for(;e.length||t.length;){var p=s();if(o+=u(a.substring(r,p[0].offset)),r=p[0].offset,p===e){i.reverse().forEach(d);do{f(p.splice(0,1)[0]),p=s()}while(p===e&&p.length&&p[0].offset===r);i.reverse().forEach(c)}else"start"===p[0].event?i.push(p[0].node):i.pop(),f(p.splice(0,1)[0])}return o+u(a.substr(r))}(a,m(s),c)),o.value=b(o.value),e.innerHTML=o.value,e.className=function(e,n,t){var a=n?r[n]:t,o=[e.trim()];return e.match(/\bhljs\b/)||o.push("hljs"),-1===e.indexOf(a)&&o.push(a),o.join(" ").trim()}(e.className,f,o.language),e.result={language:o.language,re:o.relevance},o.second_best&&(e.second_best={language:o.second_best.language,re:o.second_best.relevance}))}function _(){if(!_.called){_.called=!0;var e=document.querySelectorAll("pre code");n.forEach.call(e,y)}}function w(e){return e=(e||"").toLowerCase(),a[e]||a[r[e]]}function x(e){var n=w(e);return n&&!n.disableAutodetect}return e.highlight=$,e.highlightAuto=v,e.fixMarkup=b,e.highlightBlock=y,e.configure=function(e){d=g(d,e)},e.initHighlighting=_,e.initHighlightingOnLoad=function(){addEventListener("DOMContentLoaded",_,!1),addEventListener("load",_,!1)},e.registerLanguage=function(n,t){var o=a[n]=t(e);o.aliases&&o.aliases.forEach((function(e){r[e]=n}))},e.listLanguages=function(){return t(a)},e.getLanguage=w,e.autoDetection=x,e.inherit=g,e.IDENT_RE="[a-zA-Z]\\w*",e.UNDERSCORE_IDENT_RE="[a-zA-Z_]\\w*",e.NUMBER_RE="\\b\\d+(\\.\\d+)?",e.C_NUMBER_RE="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",e.BINARY_NUMBER_RE="\\b(0b[01]+)",e.RE_STARTERS_RE="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",e.BACKSLASH_ESCAPE={begin:"\\\\[\\s\\S]",relevance:0},e.APOS_STRING_MODE={className:"string",begin:"'",end:"'",illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},e.QUOTE_STRING_MODE={className:"string",begin:'"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},e.PHRASAL_WORDS_MODE={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},e.COMMENT=function(n,t,a){var r=e.inherit({className:"comment",begin:n,end:t,contains:[]},a||{});return r.contains.push(e.PHRASAL_WORDS_MODE),r.contains.push({className:"doctag",begin:"(?:TODO|FIXME|NOTE|BUG|XXX):",relevance:0}),r},e.C_LINE_COMMENT_MODE=e.COMMENT("//","$"),e.C_BLOCK_COMMENT_MODE=e.COMMENT("/\\*","\\*/"),e.HASH_COMMENT_MODE=e.COMMENT("#","$"),e.NUMBER_MODE={className:"number",begin:e.NUMBER_RE,relevance:0},e.C_NUMBER_MODE={className:"number",begin:e.C_NUMBER_RE,relevance:0},e.BINARY_NUMBER_MODE={className:"number",begin:e.BINARY_NUMBER_RE,relevance:0},e.CSS_NUMBER_MODE={className:"number",begin:e.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},e.REGEXP_MODE={className:"regexp",begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[e.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[e.BACKSLASH_ESCAPE]}]},e.TITLE_MODE={className:"title",begin:e.IDENT_RE,relevance:0},e.UNDERSCORE_TITLE_MODE={className:"title",begin:e.UNDERSCORE_IDENT_RE,relevance:0},e.METHOD_GUARD={begin:"\\.\\s*"+e.UNDERSCORE_IDENT_RE,relevance:0},e},a="object"==typeof window&&window||"object"==typeof self&&self,n.nodeType?a&&(a.hljs=t({})):t(n)}));rn.registerLanguage("css",(function(e){var n={begin:/(?:[A-Z\_\.\-]+|--[a-zA-Z0-9_-]+)\s*:/,returnBegin:!0,end:";",endsWithParent:!0,contains:[{className:"attribute",begin:/\S/,end:":",excludeEnd:!0,starts:{endsWithParent:!0,excludeEnd:!0,contains:[{begin:/[\w-]+\(/,returnBegin:!0,contains:[{className:"built_in",begin:/[\w-]+/},{begin:/\(/,end:/\)/,contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]}]},e.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,e.C_BLOCK_COMMENT_MODE,{className:"number",begin:"#[0-9A-Fa-f]+"},{className:"meta",begin:"!important"}]}}]};return{case_insensitive:!0,illegal:/[=\/|'\$]/,contains:[e.C_BLOCK_COMMENT_MODE,{className:"selector-id",begin:/#[A-Za-z0-9_-]+/},{className:"selector-class",begin:/\.[A-Za-z0-9_-]+/},{className:"selector-attr",begin:/\[/,end:/\]/,illegal:"$"},{className:"selector-pseudo",begin:/:(:)?[a-zA-Z0-9\_\-\+\(\)"'.]+/},{begin:"@(font-face|page)",lexemes:"[a-z-]+",keywords:"font-face page"},{begin:"@",end:"[{;]",illegal:/:/,contains:[{className:"keyword",begin:/\w+/},{begin:/\s/,endsWithParent:!0,excludeEnd:!0,relevance:0,contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,e.CSS_NUMBER_MODE]}]},{className:"selector-tag",begin:"[a-zA-Z-][a-zA-Z0-9_-]*",relevance:0},{begin:"{",end:"}",illegal:/\S/,contains:[e.C_BLOCK_COMMENT_MODE,n]}]}})),rn.registerLanguage("diff",(function(e){return{aliases:["patch"],contains:[{className:"meta",relevance:10,variants:[{begin:/^@@ +\-\d+,\d+ +\+\d+,\d+ +@@$/},{begin:/^\*\*\* +\d+,\d+ +\*\*\*\*$/},{begin:/^\-\-\- +\d+,\d+ +\-\-\-\-$/}]},{className:"comment",variants:[{begin:/Index: /,end:/$/},{begin:/={3,}/,end:/$/},{begin:/^\-{3}/,end:/$/},{begin:/^\*{3} /,end:/$/},{begin:/^\+{3}/,end:/$/},{begin:/\*{5}/,end:/\*{5}$/}]},{className:"addition",begin:"^\\+",end:"$"},{className:"deletion",begin:"^\\-",end:"$"},{className:"addition",begin:"^\\!",end:"$"}]}})),rn.registerLanguage("dockerfile",(function(e){return{aliases:["docker"],case_insensitive:!0,keywords:"from maintainer expose env arg user onbuild stopsignal",contains:[e.HASH_COMMENT_MODE,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,e.NUMBER_MODE,{beginKeywords:"run cmd entrypoint volume add copy workdir label healthcheck shell",starts:{end:/[^\\]$/,subLanguage:"bash"}}],illegal:"</"}})),rn.registerLanguage("go",(function(e){var n={keyword:"break default func interface select case map struct chan else goto package switch const fallthrough if range type continue for import return var go defer bool byte complex64 complex128 float32 float64 int8 int16 int32 int64 string uint8 uint16 uint32 uint64 int uint uintptr rune",literal:"true false iota nil",built_in:"append cap close complex copy imag len make new panic print println real recover delete"};return{aliases:["golang"],keywords:n,illegal:"</",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{className:"string",variants:[e.QUOTE_STRING_MODE,{begin:"'",end:"[^\\\\]'"},{begin:"`",end:"`"}]},{className:"number",variants:[{begin:e.C_NUMBER_RE+"[i]",relevance:1},e.C_NUMBER_MODE]},{begin:/:=/},{className:"function",beginKeywords:"func",end:/\s*\{/,excludeEnd:!0,contains:[e.TITLE_MODE,{className:"params",begin:/\(/,end:/\)/,keywords:n,illegal:/["']/}]}]}})),rn.registerLanguage("http",(function(e){var n="HTTP/[0-9\\.]+";return{aliases:["https"],illegal:"\\S",contains:[{begin:"^"+n,end:"$",contains:[{className:"number",begin:"\\b\\d{3}\\b"}]},{begin:"^[A-Z]+ (.*?) "+n+"$",returnBegin:!0,end:"$",contains:[{className:"string",begin:" ",end:" ",excludeBegin:!0,excludeEnd:!0},{begin:n},{className:"keyword",begin:"[A-Z]+"}]},{className:"attribute",begin:"^\\w",end:": ",excludeEnd:!0,illegal:"\\n|\\s|=",starts:{end:"$",relevance:0}},{begin:"\\n\\n",starts:{subLanguage:[],endsWithParent:!0}}]}})),rn.registerLanguage("javascript",(function(e){var n="[A-Za-z$_][0-9A-Za-z$_]*",t={keyword:"in of if for while finally var new function do return void else break catch instanceof with throw case default try this switch continue typeof delete let yield const export super debugger as async await static import from as",literal:"true false null undefined NaN Infinity",built_in:"eval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Error EvalError InternalError RangeError ReferenceError StopIteration SyntaxError TypeError URIError Number Math Date String RegExp Array Float32Array Float64Array Int16Array Int32Array Int8Array Uint16Array Uint32Array Uint8Array Uint8ClampedArray ArrayBuffer DataView JSON Intl arguments require module console window document Symbol Set Map WeakSet WeakMap Proxy Reflect Promise"},a={className:"number",variants:[{begin:"\\b(0[bB][01]+)"},{begin:"\\b(0[oO][0-7]+)"},{begin:e.C_NUMBER_RE}],relevance:0},r={className:"subst",begin:"\\$\\{",end:"\\}",keywords:t,contains:[]},o={begin:"html`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,r],subLanguage:"xml"}},i={begin:"css`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,r],subLanguage:"css"}},s={className:"string",begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE,r]};r.contains=[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,o,i,s,a,e.REGEXP_MODE];var c=r.contains.concat([e.C_BLOCK_COMMENT_MODE,e.C_LINE_COMMENT_MODE]);return{aliases:["js","jsx"],keywords:t,contains:[{className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},{className:"meta",begin:/^#!/,end:/$/},e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,o,i,s,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,a,{begin:/[{,]\s*/,relevance:0,contains:[{begin:n+"\\s*:",returnBegin:!0,relevance:0,contains:[{className:"attr",begin:n,relevance:0}]}]},{begin:"("+e.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,e.REGEXP_MODE,{className:"function",begin:"(\\(.*?\\)|"+n+")\\s*=>",returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:n},{begin:/\(\s*\)/},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:t,contains:c}]}]},{className:"",begin:/\s/,end:/\s*/,skip:!0},{begin:/</,end:/(\/[A-Za-z0-9\\._:-]+|[A-Za-z0-9\\._:-]+\/)>/,subLanguage:"xml",contains:[{begin:/<[A-Za-z0-9\\._:-]+\s*\/>/,skip:!0},{begin:/<[A-Za-z0-9\\._:-]+/,end:/(\/[A-Za-z0-9\\._:-]+|[A-Za-z0-9\\._:-]+\/)>/,skip:!0,contains:[{begin:/<[A-Za-z0-9\\._:-]+\s*\/>/,skip:!0},"self"]}]}],relevance:0},{className:"function",beginKeywords:"function",end:/\{/,excludeEnd:!0,contains:[e.inherit(e.TITLE_MODE,{begin:n}),{className:"params",begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,contains:c}],illegal:/\[|%/},{begin:/\$[(.]/},e.METHOD_GUARD,{className:"class",beginKeywords:"class",end:/[{;=]/,excludeEnd:!0,illegal:/[:"\[\]]/,contains:[{beginKeywords:"extends"},e.UNDERSCORE_TITLE_MODE]},{beginKeywords:"constructor get set",end:/\{/,excludeEnd:!0}],illegal:/#(?!!)/}})),rn.registerLanguage("markdown",(function(e){return{aliases:["md","mkdown","mkd"],contains:[{className:"section",variants:[{begin:"^#{1,6}",end:"$"},{begin:"^.+?\\n[=-]{2,}$"}]},{begin:"<",end:">",subLanguage:"xml",relevance:0},{className:"bullet",begin:"^\\s*([*+-]|(\\d+\\.))\\s+"},{className:"strong",begin:"[*_]{2}.+?[*_]{2}"},{className:"emphasis",variants:[{begin:"\\*.+?\\*"},{begin:"_.+?_",relevance:0}]},{className:"quote",begin:"^>\\s+",end:"$"},{className:"code",variants:[{begin:"^```w*s*$",end:"^```s*$"},{begin:"`.+?`"},{begin:"^( {4}|\t)",end:"$",relevance:0}]},{begin:"^[-\\*]{3,}",end:"$"},{begin:"\\[.+?\\][\\(\\[].*?[\\)\\]]",returnBegin:!0,contains:[{className:"string",begin:"\\[",end:"\\]",excludeBegin:!0,returnEnd:!0,relevance:0},{className:"link",begin:"\\]\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0},{className:"symbol",begin:"\\]\\[",end:"\\]",excludeBegin:!0,excludeEnd:!0}],relevance:10},{begin:/^\[[^\n]+\]:/,returnBegin:!0,contains:[{className:"symbol",begin:/\[/,end:/\]/,excludeBegin:!0,excludeEnd:!0},{className:"link",begin:/:\s*/,end:/$/,excludeBegin:!0}]}]}})),rn.registerLanguage("mojolicious",(function(e){return{subLanguage:"xml",contains:[{className:"meta",begin:"^__(END|DATA)__$"},{begin:"^\\s*%{1,2}={0,2}",end:"$",subLanguage:"perl"},{begin:"<%{1,2}={0,2}",end:"={0,1}%>",subLanguage:"perl",excludeBegin:!0,excludeEnd:!0}]}})),rn.registerLanguage("nginx",(function(e){var n={className:"variable",variants:[{begin:/\$\d+/},{begin:/\$\{/,end:/}/},{begin:"[\\$\\@]"+e.UNDERSCORE_IDENT_RE}]},t={endsWithParent:!0,lexemes:"[a-z/_]+",keywords:{literal:"on off yes no true false none blocked debug info notice warn error crit select break last permanent redirect kqueue rtsig epoll poll /dev/poll"},relevance:0,illegal:"=>",contains:[e.HASH_COMMENT_MODE,{className:"string",contains:[e.BACKSLASH_ESCAPE,n],variants:[{begin:/"/,end:/"/},{begin:/'/,end:/'/}]},{begin:"([a-z]+):/",end:"\\s",endsWithParent:!0,excludeEnd:!0,contains:[n]},{className:"regexp",contains:[e.BACKSLASH_ESCAPE,n],variants:[{begin:"\\s\\^",end:"\\s|{|;",returnEnd:!0},{begin:"~\\*?\\s+",end:"\\s|{|;",returnEnd:!0},{begin:"\\*(\\.[a-z\\-]+)+"},{begin:"([a-z\\-]+\\.)+\\*"}]},{className:"number",begin:"\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}(:\\d{1,5})?\\b"},{className:"number",begin:"\\b\\d+[kKmMgGdshdwy]*\\b",relevance:0},n]};return{aliases:["nginxconf"],contains:[e.HASH_COMMENT_MODE,{begin:e.UNDERSCORE_IDENT_RE+"\\s+{",returnBegin:!0,end:"{",contains:[{className:"section",begin:e.UNDERSCORE_IDENT_RE}],relevance:0},{begin:e.UNDERSCORE_IDENT_RE+"\\s",end:";|{",returnBegin:!0,contains:[{className:"attribute",begin:e.UNDERSCORE_IDENT_RE,starts:t}],relevance:0}],illegal:"[^\\s\\}]"}})),rn.registerLanguage("perl",(function(e){var n="getpwent getservent quotemeta msgrcv scalar kill dbmclose undef lc ma syswrite tr send umask sysopen shmwrite vec qx utime local oct semctl localtime readpipe do return format read sprintf dbmopen pop getpgrp not getpwnam rewinddir qqfileno qw endprotoent wait sethostent bless s|0 opendir continue each sleep endgrent shutdown dump chomp connect getsockname die socketpair close flock exists index shmgetsub for endpwent redo lstat msgctl setpgrp abs exit select print ref gethostbyaddr unshift fcntl syscall goto getnetbyaddr join gmtime symlink semget splice x|0 getpeername recv log setsockopt cos last reverse gethostbyname getgrnam study formline endhostent times chop length gethostent getnetent pack getprotoent getservbyname rand mkdir pos chmod y|0 substr endnetent printf next open msgsnd readdir use unlink getsockopt getpriority rindex wantarray hex system getservbyport endservent int chr untie rmdir prototype tell listen fork shmread ucfirst setprotoent else sysseek link getgrgid shmctl waitpid unpack getnetbyname reset chdir grep split require caller lcfirst until warn while values shift telldir getpwuid my getprotobynumber delete and sort uc defined srand accept package seekdir getprotobyname semop our rename seek if q|0 chroot sysread setpwent no crypt getc chown sqrt write setnetent setpriority foreach tie sin msgget map stat getlogin unless elsif truncate exec keys glob tied closedirioctl socket readlink eval xor readline binmode setservent eof ord bind alarm pipe atan2 getgrent exp time push setgrent gt lt or ne m|0 break given say state when",t={className:"subst",begin:"[$@]\\{",end:"\\}",keywords:n},a={begin:"->{",end:"}"},r={variants:[{begin:/\$\d/},{begin:/[\$%@](\^\w\b|#\w+(::\w+)*|{\w+}|\w+(::\w*)*)/},{begin:/[\$%@][^\s\w{]/,relevance:0}]},o=[e.BACKSLASH_ESCAPE,t,r],i=[r,e.HASH_COMMENT_MODE,e.COMMENT("^\\=\\w","\\=cut",{endsWithParent:!0}),a,{className:"string",contains:o,variants:[{begin:"q[qwxr]?\\s*\\(",end:"\\)",relevance:5},{begin:"q[qwxr]?\\s*\\[",end:"\\]",relevance:5},{begin:"q[qwxr]?\\s*\\{",end:"\\}",relevance:5},{begin:"q[qwxr]?\\s*\\|",end:"\\|",relevance:5},{begin:"q[qwxr]?\\s*\\<",end:"\\>",relevance:5},{begin:"qw\\s+q",end:"q",relevance:5},{begin:"'",end:"'",contains:[e.BACKSLASH_ESCAPE]},{begin:'"',end:'"'},{begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE]},{begin:"{\\w+}",contains:[],relevance:0},{begin:"-?\\w+\\s*\\=\\>",contains:[],relevance:0}]},{className:"number",begin:"(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b",relevance:0},{begin:"(\\/\\/|"+e.RE_STARTERS_RE+"|\\b(split|return|print|reverse|grep)\\b)\\s*",keywords:"split return print reverse grep",relevance:0,contains:[e.HASH_COMMENT_MODE,{className:"regexp",begin:"(s|tr|y)/(\\\\.|[^/])*/(\\\\.|[^/])*/[a-z]*",relevance:10},{className:"regexp",begin:"(m|qr)?/",end:"/[a-z]*",contains:[e.BACKSLASH_ESCAPE],relevance:0}]},{className:"function",beginKeywords:"sub",end:"(\\s*\\(.*?\\))?[;{]",excludeEnd:!0,relevance:5,contains:[e.TITLE_MODE]},{begin:"-\\w\\b",relevance:0},{begin:"^__DATA__$",end:"^__END__$",subLanguage:"mojolicious",contains:[{begin:"^@@.*",end:"$",className:"comment"}]}];return t.contains=i,a.contains=i,{aliases:["pl","pm"],lexemes:/[\w\.]+/,keywords:n,contains:i}})),rn.registerLanguage("python",(function(e){var n={keyword:"and elif is global as in if from raise for except finally print import pass return exec else break not with class assert yield try while continue del or def lambda async await nonlocal|10",built_in:"Ellipsis NotImplemented",literal:"False None True"},t={className:"meta",begin:/^(>>>|\.\.\.) /},a={className:"subst",begin:/\{/,end:/\}/,keywords:n,illegal:/#/},r={className:"string",contains:[e.BACKSLASH_ESCAPE],variants:[{begin:/(u|b)?r?'''/,end:/'''/,contains:[e.BACKSLASH_ESCAPE,t],relevance:10},{begin:/(u|b)?r?"""/,end:/"""/,contains:[e.BACKSLASH_ESCAPE,t],relevance:10},{begin:/(fr|rf|f)'''/,end:/'''/,contains:[e.BACKSLASH_ESCAPE,t,a]},{begin:/(fr|rf|f)"""/,end:/"""/,contains:[e.BACKSLASH_ESCAPE,t,a]},{begin:/(u|r|ur)'/,end:/'/,relevance:10},{begin:/(u|r|ur)"/,end:/"/,relevance:10},{begin:/(b|br)'/,end:/'/},{begin:/(b|br)"/,end:/"/},{begin:/(fr|rf|f)'/,end:/'/,contains:[e.BACKSLASH_ESCAPE,a]},{begin:/(fr|rf|f)"/,end:/"/,contains:[e.BACKSLASH_ESCAPE,a]},e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},o={className:"number",relevance:0,variants:[{begin:e.BINARY_NUMBER_RE+"[lLjJ]?"},{begin:"\\b(0o[0-7]+)[lLjJ]?"},{begin:e.C_NUMBER_RE+"[lLjJ]?"}]},i={className:"params",begin:/\(/,end:/\)/,contains:["self",t,o,r]};return a.contains=[r,o,t],{aliases:["py","gyp","ipython"],keywords:n,illegal:/(<\/|->|\?)|=>/,contains:[t,o,r,e.HASH_COMMENT_MODE,{variants:[{className:"function",beginKeywords:"def"},{className:"class",beginKeywords:"class"}],end:/:/,illegal:/[${=;\n,]/,contains:[e.UNDERSCORE_TITLE_MODE,i,{begin:/->/,endsWithParent:!0,keywords:"None"}]},{className:"meta",begin:/^[\t ]*@/,end:/$/},{begin:/\b(print|exec)\(/}]}})),rn.registerLanguage("scss",(function(e){var n={className:"variable",begin:"(\\$[a-zA-Z-][a-zA-Z0-9_-]*)\\b"},t={className:"number",begin:"#[0-9A-Fa-f]+"};e.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,e.C_BLOCK_COMMENT_MODE;return{case_insensitive:!0,illegal:"[=/|']",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{className:"selector-id",begin:"\\#[A-Za-z0-9_-]+",relevance:0},{className:"selector-class",begin:"\\.[A-Za-z0-9_-]+",relevance:0},{className:"selector-attr",begin:"\\[",end:"\\]",illegal:"$"},{className:"selector-tag",begin:"\\b(a|abbr|acronym|address|area|article|aside|audio|b|base|big|blockquote|body|br|button|canvas|caption|cite|code|col|colgroup|command|datalist|dd|del|details|dfn|div|dl|dt|em|embed|fieldset|figcaption|figure|footer|form|frame|frameset|(h[1-6])|head|header|hgroup|hr|html|i|iframe|img|input|ins|kbd|keygen|label|legend|li|link|map|mark|meta|meter|nav|noframes|noscript|object|ol|optgroup|option|output|p|param|pre|progress|q|rp|rt|ruby|samp|script|section|select|small|span|strike|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|time|title|tr|tt|ul|var|video)\\b",relevance:0},{begin:":(visited|valid|root|right|required|read-write|read-only|out-range|optional|only-of-type|only-child|nth-of-type|nth-last-of-type|nth-last-child|nth-child|not|link|left|last-of-type|last-child|lang|invalid|indeterminate|in-range|hover|focus|first-of-type|first-line|first-letter|first-child|first|enabled|empty|disabled|default|checked|before|after|active)"},{begin:"::(after|before|choices|first-letter|first-line|repeat-index|repeat-item|selection|value)"},n,{className:"attribute",begin:"\\b(z-index|word-wrap|word-spacing|word-break|width|widows|white-space|visibility|vertical-align|unicode-bidi|transition-timing-function|transition-property|transition-duration|transition-delay|transition|transform-style|transform-origin|transform|top|text-underline-position|text-transform|text-shadow|text-rendering|text-overflow|text-indent|text-decoration-style|text-decoration-line|text-decoration-color|text-decoration|text-align-last|text-align|tab-size|table-layout|right|resize|quotes|position|pointer-events|perspective-origin|perspective|page-break-inside|page-break-before|page-break-after|padding-top|padding-right|padding-left|padding-bottom|padding|overflow-y|overflow-x|overflow-wrap|overflow|outline-width|outline-style|outline-offset|outline-color|outline|orphans|order|opacity|object-position|object-fit|normal|none|nav-up|nav-right|nav-left|nav-index|nav-down|min-width|min-height|max-width|max-height|mask|marks|margin-top|margin-right|margin-left|margin-bottom|margin|list-style-type|list-style-position|list-style-image|list-style|line-height|letter-spacing|left|justify-content|initial|inherit|ime-mode|image-orientation|image-resolution|image-rendering|icon|hyphens|height|font-weight|font-variant-ligatures|font-variant|font-style|font-stretch|font-size-adjust|font-size|font-language-override|font-kerning|font-feature-settings|font-family|font|float|flex-wrap|flex-shrink|flex-grow|flex-flow|flex-direction|flex-basis|flex|filter|empty-cells|display|direction|cursor|counter-reset|counter-increment|content|column-width|column-span|column-rule-width|column-rule-style|column-rule-color|column-rule|column-gap|column-fill|column-count|columns|color|clip-path|clip|clear|caption-side|break-inside|break-before|break-after|box-sizing|box-shadow|box-decoration-break|bottom|border-width|border-top-width|border-top-style|border-top-right-radius|border-top-left-radius|border-top-color|border-top|border-style|border-spacing|border-right-width|border-right-style|border-right-color|border-right|border-radius|border-left-width|border-left-style|border-left-color|border-left|border-image-width|border-image-source|border-image-slice|border-image-repeat|border-image-outset|border-image|border-color|border-collapse|border-bottom-width|border-bottom-style|border-bottom-right-radius|border-bottom-left-radius|border-bottom-color|border-bottom|border|background-size|background-repeat|background-position|background-origin|background-image|background-color|background-clip|background-attachment|background-blend-mode|background|backface-visibility|auto|animation-timing-function|animation-play-state|animation-name|animation-iteration-count|animation-fill-mode|animation-duration|animation-direction|animation-delay|animation|align-self|align-items|align-content)\\b",illegal:"[^\\s]"},{begin:"\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},{begin:":",end:";",contains:[n,t,e.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,{className:"meta",begin:"!important"}]},{begin:"@",end:"[{;]",keywords:"mixin include extend for if else each while charset import debug media page content font-face namespace warn",contains:[n,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,t,e.CSS_NUMBER_MODE,{begin:"\\s[A-Za-z0-9_.-]+",relevance:0}]}]}})),rn.registerLanguage("shell",(function(e){return{aliases:["console"],contains:[{className:"meta",begin:"^\\s{0,3}[\\w\\d\\[\\]()@-]*[>%$#]",starts:{end:"$",subLanguage:"bash"}}]}})),rn.registerLanguage("xml",(function(e){var n={endsWithParent:!0,illegal:/</,relevance:0,contains:[{className:"attr",begin:"[A-Za-z0-9\\._:-]+",relevance:0},{begin:/=\s*/,relevance:0,contains:[{className:"string",endsParent:!0,variants:[{begin:/"/,end:/"/},{begin:/'/,end:/'/},{begin:/[^\s"'=<>`]+/}]}]}]};return{aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist","wsf"],case_insensitive:!0,contains:[{className:"meta",begin:"<!DOCTYPE",end:">",relevance:10,contains:[{begin:"\\[",end:"\\]"}]},e.COMMENT("\x3c!--","--\x3e",{relevance:10}),{begin:"<\\!\\[CDATA\\[",end:"\\]\\]>",relevance:10},{className:"meta",begin:/<\?xml/,end:/\?>/,relevance:10},{begin:/<\?(php)?/,end:/\?>/,subLanguage:"php",contains:[{begin:"/\\*",end:"\\*/",skip:!0},{begin:'b"',end:'"',skip:!0},{begin:"b'",end:"'",skip:!0},e.inherit(e.APOS_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0}),e.inherit(e.QUOTE_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0})]},{className:"tag",begin:"<style(?=\\s|>|$)",end:">",keywords:{name:"style"},contains:[n],starts:{end:"</style>",returnEnd:!0,subLanguage:["css","xml"]}},{className:"tag",begin:"<script(?=\\s|>|$)",end:">",keywords:{name:"script"},contains:[n],starts:{end:"<\/script>",returnEnd:!0,subLanguage:["actionscript","javascript","handlebars","xml","vbscript"]}},{className:"tag",begin:"</?",end:"/?>",contains:[{className:"name",begin:/[^\/><\s]+/,relevance:0},n]}]}})),rn.registerLanguage("yaml",(function(e){var n="[a-zA-Z_][\\w\\-]*",t={className:"attr",variants:[{begin:"^[ \\-]*"+n+":"},{begin:'^[ \\-]*"'+n+'":'},{begin:"^[ \\-]*'"+n+"':"}]},a={className:"string",relevance:0,variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/\S+/}],contains:[e.BACKSLASH_ESCAPE,{className:"template-variable",variants:[{begin:"{{",end:"}}"},{begin:"%{",end:"}"}]}]};return{case_insensitive:!0,aliases:["yml","YAML","yaml"],contains:[t,{className:"meta",begin:"^---s*$",relevance:10},{className:"string",begin:"[\\|>] *$",returnEnd:!0,contains:a.contains,end:t.variants[0].begin},{begin:"<%[%=-]?",end:"[%-]?%>",subLanguage:"ruby",excludeBegin:!0,excludeEnd:!0,relevance:0},{className:"type",begin:"!"+e.UNDERSCORE_IDENT_RE},{className:"type",begin:"!!"+e.UNDERSCORE_IDENT_RE},{className:"meta",begin:"&"+e.UNDERSCORE_IDENT_RE+"$"},{className:"meta",begin:"\\*"+e.UNDERSCORE_IDENT_RE+"$"},{className:"bullet",begin:"^ *-",relevance:0},e.HASH_COMMENT_MODE,{beginKeywords:"true false yes no null",keywords:{literal:"true false yes no null"}},e.C_NUMBER_MODE,a]}}));var on=function(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&null!==(e=Re(e)););return e},sn=we((function(e){function n(t,a,r){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=n=Reflect.get:e.exports=n=function(e,n,t){var a=on(e,n);if(a){var r=Object.getOwnPropertyDescriptor(a,n);return r.get?r.get.call(t):r.value}},n(t,a,r||t)}e.exports=n}));var cn=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},dn=we((function(e){function n(t,a,r){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?e.exports=n=function(e,n,t){var a=[null];a.push.apply(a,n);var r=new(Function.bind.apply(e,a));return t&&je(r,t.prototype),r}:e.exports=n=Reflect.construct,n.apply(null,arguments)}e.exports=n})),un=we((function(e){function n(t){var a="function"==typeof Map?new Map:void 0;return e.exports=n=function(e){if(null===e||!cn(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==a){if(a.has(e))return a.get(e);a.set(e,n)}function n(){return dn(e,arguments,Re(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),je(n,e)},n(t)}e.exports=n})),ln=function(e){function n(e){var t;Oe(this,n);var a=e.match(/^\w+:/)[0];return(t=Le(this,Re(n).call(this,e.replace(/^\w+:/,"http:")))).connProtocol=a,t}return Ie(n,e),Se(n,[{key:"fromForm",value:function(e){var n=e.server.value;return e.nick.value.length&&this.searchParams.append("nick",e.nick.value),this.searchParams.append("tls",e.tls.checked?"1":"0"),this.searchParams.append("tls_verify",e.tls_verify&&e.tls_verify.checked?"1":"0"),this.host=n.match(/:\d+$/)?n:n+":6667",this.password=e.password.value,this.username=e.username.value,this}},{key:"toString",value:function(){return this.href.replace(/^http:/,this.connProtocol)}}]),n}(un(URL));var fn=function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}};var pn=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)};var gn=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")};var mn=function(e){return fn(e)||pn(e)||gn()},hn=function(e){function n(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Oe(this,n),(e=Le(this,Re(n).call(this,t))).sorter=a.sorter||Je,e._sort(),e}return Ie(n,e),Se(n,[{key:"filter",value:function(e){return Array.from(this.values()).filter(e)}},{key:"set",value:function(e,t){sn(Re(n.prototype),"set",this).call(this,e,t),this._sort()}},{key:"toArray",value:function(){return Array.from(this.values())}},{key:"_sort",value:function(){var e=this,t=Array.from(this.entries()),a=this.sorter;return this.clear(),t.sort((function(e,n){return a(e[1],n[1])})).forEach((function(t){var a=Te(t,2),r=a[0],o=a[1];return sn(Re(n.prototype),"set",e).call(e,r,o)})),t}}]),n}(un(Map)),$n={0:"Jan",1:"Feb",2:"March",3:"Apr",4:"May",5:"Jun",6:"July",7:"Aug",8:"Sept",9:"Oct",10:"Nov",11:"Dec"},vn=function(e){function n(e){return Oe(this,n),"string"!=typeof e||e.match(/Z$/)||(e+="Z"),Le(this,Re(n).call(this,e||new Date))}return Ie(n,e),Se(n,[{key:"getHumanDate",value:function(){return this.getDate()+". "+this.getMonthAbbr()}},{key:"getHM",value:function(){return[this.getHours(),this.getMinutes()].map((function(e){return e<10?"0"+e:e})).join(":")}},{key:"getMonthAbbr",value:function(){return $n[this.getMonth()]||""}},{key:"toEpoch",value:function(){return this.getTime()/1e3}},{key:"toHuman",value:function(){var e=new n,t=this.toEpoch();return t>e.toEpoch()+86400-e.toEpoch()%86400+86400?this.getDate()+". "+this.getMonthAbbr()+" "+this.getHM():t>e.toEpoch()-e.toEpoch()%86400?this.getHM():this.getYear()==e.getYear()?this.getDate()+". "+this.getMonthAbbr()+" "+this.getHM():this.getDate()+". "+this.getMonthAbbr()+" "+this.getFullYear()}}]),n}(un(Date)),bn=function(){var e={base:"https://twemoji.maxcdn.com/v/12.1.3/",ext:".png",size:"72x72",className:"emoji",convert:{fromCodePoint:function(e){var n="string"==typeof e?parseInt(e,16):e;if(n<65536)return s(n);return s(55296+((n-=65536)>>10),56320+(1023&n))},toCodePoint:h},onerror:function(){this.parentNode&&this.parentNode.replaceChild(c(this.alt,!1),this)},parse:function(n,t){t&&"function"!=typeof t||(t={callback:t});return("string"==typeof n?f:l)(n,{callback:t.callback||d,attributes:"function"==typeof t.attributes?t.attributes:g,base:"string"==typeof t.base?t.base:e.base,ext:t.ext||e.ext,size:t.folder||(a=t.size||e.size,"number"==typeof a?a+"x"+a:a),className:t.className||e.className,onerror:t.onerror||e.onerror});var a},replace:m,test:function(e){t.lastIndex=0;var n=t.test(e);return t.lastIndex=0,n}},n={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},t=/(?:\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c\udffb|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c\udffb|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c\udffb|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb\udffc]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udffd]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d])|(?:\ud83d[\udc68\udc69])(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f)|[#*0-9]\ufe0f?\u20e3|(?:[\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a-\udc6d\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5\udeeb\udeec\udef4-\udefa\udfe0-\udfeb]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd71\udd73-\udd76\udd7a-\udda2\udda5-\uddaa\uddae-\uddb4\uddb7\uddba\uddbc-\uddca\uddd0\uddde-\uddff\ude70-\ude73\ude78-\ude7a\ude80-\ude82\ude90-\ude95]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,a=/\uFE0F/g,r=String.fromCharCode(8205),o=/[&<>'"]/g,i=/^(?:iframe|noframes|noscript|script|select|style|textarea)$/,s=String.fromCharCode;return e;function c(e,n){return document.createTextNode(n?e.replace(a,""):e)}function d(e,n){return"".concat(n.base,n.size,"/",e,n.ext)}function u(e){return h(e.indexOf(r)<0?e.replace(a,""):e)}function l(e,n){for(var a,r,o,s,d,l,f,p,g,m,h,$,v,b=function e(n,t){for(var a,r,o=n.childNodes,s=o.length;s--;)3===(r=(a=o[s]).nodeType)?t.push(a):1!==r||"ownerSVGElement"in a||i.test(a.nodeName.toLowerCase())||e(a,t);return t}(e,[]),y=b.length;y--;){for(o=!1,s=document.createDocumentFragment(),l=(d=b[y]).nodeValue,p=0;f=t.exec(l);){if((g=f.index)!==p&&s.appendChild(c(l.slice(p,g),!0)),$=u(h=f[0]),p=g+h.length,v=n.callback($,n),$&&v){for(r in(m=new Image).onerror=n.onerror,m.setAttribute("draggable","false"),a=n.attributes(h,$))a.hasOwnProperty(r)&&0!==r.indexOf("on")&&!m.hasAttribute(r)&&m.setAttribute(r,a[r]);m.className=n.className,m.alt=h,m.src=v,o=!0,s.appendChild(m)}m||s.appendChild(c(h,!1)),m=null}o&&(p<l.length&&s.appendChild(c(l.slice(p),!0)),d.parentNode.replaceChild(s,d))}return e}function f(e,n){return m(e,(function(e){var t,a,r=e,i=u(e),s=n.callback(i,n);if(i&&s){for(a in r="<img ".concat('class="',n.className,'" ','draggable="false" ','alt="',e,'"',' src="',s,'"'),t=n.attributes(e,i))t.hasOwnProperty(a)&&0!==a.indexOf("on")&&-1===r.indexOf(" "+a+"=")&&(r=r.concat(" ",a,'="',t[a].replace(o,p),'"'));r=r.concat("/>")}return r}))}function p(e){return n[e]}function g(){return null}function m(e,n){return String(e).replace(t,n)}function h(e,n){for(var t=[],a=0,r=0,o=0;o<e.length;)a=e.charCodeAt(o++),r?(t.push((65536+(r-55296<<10)+(a-56320)).toString(16)),r=0):55296<=a&&a<=56319?r=a:t.push(a.toString(16));return t.join(n||"-")}}(),yn=new RegExp("(\\\\?)`([^`]+)`","g"),_n={},wn={},xn=new RegExp("https?://\\S+","g"),kn=new RegExp("\\[([^]+)\\]\\(([^)]+)\\)"),En=new RegExp("(^|\\s)(\\\\?)(\\*+|_+)(\\w[^<]*?)\\3","g"),On={":confused:":":/",":disappointed:":":(",":grin:":";D",":heart:":"&lt;3",":slight_smile:":":)",":smiley:":":D",":stuck_out_tongue:":":P",":wink:":";)"},Nn=new RegExp("(^|\\s)(:\\w+:|"+Object.keys(On).map((function(e){return Ve(On[e])})).join("|")+")(?=\\W|$)","gi"),Sn={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"};function An(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emoji";return window.__emojiList&&(window.__emojiList.forEach((function(e){if(":"==(e.shortname||"")[0]){if(On[e.shortname]&&(wn[On[e.shortname]]=e),wn[e.shortname]=e,e.category){var n=":"+e.category;_n[n]||(_n[n]=[]),_n[n].push(e)}e.shortname.match(/(_|:)\w/g).forEach((function(n){_n[n]||(_n[n]=[]),_n[n].push(e)})),delete e.category,delete e.html,delete e.order,delete e.unicode}})),delete window.__emojiList),"group"==n?_n[e]||[]:(wn[e]||{})[n]}function Cn(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!1!==n.escape&&(e=function(e){return e.replace(/[&<>"']/g,(function(e){return Sn[e]}))}(e)),e=e.replace(/^&gt;\s(.*)/,(function(e,n){return"<blockquote>"+n+"</blockquote>"})).replace(En,(function(e,n,t,a,r){return a.match(/^_/)&&r.match(/^[A-Z]+$/)?e:1==a.length?t?e.replace(/^\\/,""):n+"<em>"+r+"</em>":2==a.length?t?e.replace(/^\\/,""):n+"<strong>"+r+"</strong>":3==a.length?t?e.replace(/^\\/,""):n+"<em><strong>"+r+"</strong></em>":e})).replace(kn,(function(e,n,t){return'<a href="'+t+'">'+n+"</a>"})).replace(yn,(function(e,n,t){return n?e.replace(/^\\/,""):"<code>"+t+"</code>"})),!1!==n.links&&(e=e.replace(xn,(function(e){var n=e.match(/^(.*?)(\W)?$/);return'<a href="'+n[1]+'" target="_blank">'+n[1].replace(/^https:\/\//,"")+"</a>"+(n[2]||"")})).replace(/mailto:(\S+)/,(function(e,n){return'<a href="'+e+'" target="_blank">'+n+"</a>"}))),!1!==n.emoji&&(e=bn.parse(e.replace(Nn,(function(e,n,t){return n+(An(t)||t)})))),e}var Mn={en:{}},Dn="en";function Tn(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),a=1;a<n;a++)t[a-1]=arguments[a];return String(Mn[e]&&Mn[e][Dn]||e).replace(/%(\d+)/g,(function(e,n){return t[n-1]}))}function Pn(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),a=1;a<n;a++)t[a-1]=arguments[a];return Cn(Tn.apply(void 0,[e].concat(t)))}function Ln(e,n){return e.frozen?Tn(e.frozen):e==n?"Connection messages.":(n.frozen?Tn(n.frozen):n.topic)||n.is_private&&Tn("Private conversation.")||Tn("No topic is set.")}function Rn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function jn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Rn(t,!0).forEach((function(n){Ue(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Rn(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var In=new RegExp("^[#&]"),Un={o:"@",v:"+"},Bn={o:10,v:9},Hn=function(e,n){return(Bn[n.mode]||0)-(Bn[e.mode]||0)||e.name.localeCompare(n.name)},zn=function(e){function n(e){var t;Oe(this,n),t=Le(this,Re(n).call(this));var a=["","chat"];return e.connection_id&&a.push(e.connection_id),e.dialog_id&&a.push(e.dialog_id),t._readOnlyAttr("api",e.api),t._readOnlyAttr("color",Xe(e.dialog_id||e.connection_id||"")),t._readOnlyAttr("connection_id",e.connection_id||""),t._readOnlyAttr("events",e.events),t._readOnlyAttr("is_private",(function(){return!In.test(t.name)})),t._readOnlyAttr("participants",new hn([],{sorter:Hn})),t._readOnlyAttr("path",a.map((function(e){return encodeURIComponent(e)})).join("/")),t._updateableAttr("errors",0),t._updateableAttr("last_active",new vn(e.last_active)),t._updateableAttr("last_read",new vn(e.last_read)),t._updateableAttr("messages",[]),t._updateableAttr("mode",""),t._updateableAttr("name",e.name||"Unknown"),t._updateableAttr("status","loading"),t._updateableAttr("topic",e.topic||""),t._updateableAttr("unread",e.unread||0),e.hasOwnProperty("dialog_id")?(t._readOnlyAttr("dialog_id",e.dialog_id),t._updateableAttr("frozen",e.frozen||"")):t._readOnlyAttr("frozen",(function(){return t._calculateFrozen()})),t.events.on("update",t._loadParticipants.bind(Pe(t))),t._addOperations(),t}var t,a,r;return Ie(n,e),Se(n,[{key:"addMessage",value:function(e){e.highlight&&this.events.notifyUser(e.from,e.message),this.addMessages("push",[e]),-1!=["action","error","private"].indexOf(e.type)&&this.update({unread:this.unread+1})}},{key:"addMessages",value:function(e,n){var t=0,a=n.length;switch(e){case"push":t=this.messages.length,a=(n=this.messages.concat(n)).length;break;case"unshift":n=n.concat(this.messages)}for(var r=t;r<a;r++){var o=n[r];o.hasOwnProperty("markdown")||(o.from||(o.from=this.connection_id||"Convos"),o.type||(o.type="notice"),o.vars&&(o.message=Tn.apply(void 0,[o.message].concat(mn(o.vars)))),o.color=Xe(o.from.toLowerCase()),o.ts=new vn(o.ts),o.dayChanged=0!=r&&o.ts.getDate()!=n[r-1].ts.getDate(),o.embeds=(o.message.match(/https?:\/\/(\S+)/g)||[]).map((function(e){return e.replace(/(\W)?$/,"")})),o.fromId=o.from.toLowerCase(),o.isSameSender=0!=r&&n[r].from==n[r-1].from,o.markdown=Cn(o.message))}return this.update({messages:n,status:"loaded"}),this}},{key:"is",value:function(e){return"frozen"==e?this.frozen&&!0:"private"==e?this.is_private:"unread"==e?this.unread&&!0:this.status==e}},{key:"load",value:(r=Ee(xe.mark((function e(){return xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.is_private&&this.dialog_id&&this.send("/ison","_noop"),this.messagesOp&&!this.messagesOp.is("success")){e.next=3;break}return e.abrupt("return",this);case 3:return this.update({status:"loading"}),e.next=6,this.messagesOp.perform(this);case 6:return this._loadParticipants(),e.abrupt("return",this.addMessages("unshift",this.messagesOp.res.body.messages||[]));case 8:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"loadHistoric",value:(a=Ee(xe.mark((function e(){var n,t;return xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this.messages[0])&&!n.end){e.next=3;break}return e.abrupt("return");case 3:return this.update({status:"loading"}),e.next=6,this.messagesOp.perform({before:n.ts.toISOString(),connection_id:this.connection_id,dialog_id:this.dialog_id});case 6:return!(t=this.messagesOp.res.body.messages||[]).length&&this.messages.length&&(n.endOfHistory=!0),e.abrupt("return",this.addMessages("unshift",t));case 9:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"participant",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=this._participantId(e);n.nick=e;var a=this.participants.get(t);return a?Object.keys(n).forEach((function(e){a[e]=n[e]})):(a=jn({mode:""},n,{color:Xe(t),id:t,name:e,ts:new vn}),this.participants.set(t,a)),this.update({}),a}},{key:"send",value:function(e,n){this.events.send({connection_id:this.connection_id,dialog_id:this.dialog_id||"",message:e},n?this[n].bind(this):null)}},{key:"setLastRead",value:(t=Ee(xe.mark((function e(){return xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setLastReadOp){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.setLastReadOp.perform({connection_id:this.connection_id,dialog_id:this.dialog_id});case 4:this.update(jn({errors:0,unread:0},this.setLastReadOp.res.body));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"wsEventMode",value:function(e){if(!e.nick)return this.update({mode:e.mode});this.participant(e.nick,{mode:e.mode}),this.addMessage({message:"%1 got mode %2 from %3.",vars:[e.nick,e.mode,e.from]})}},{key:"wsEventNickChange",value:function(e){var n=this._participantId(e.old_nick);if(this.participants.has(n)&&e.old_nick!=e.new_nick){this.participants.delete(n),this.participant(e.new_nick,e);var t="me"==e.type?"You (%1) changed nick to %2.":"%1 changed nick to %2.";this.addMessage({message:t,vars:[e.old_nick,e.new_nick]})}}},{key:"wsEventPart",value:function(e){var n=this._participantId(e.nick),t=this.participants.get(n)||{};this.addMessage(this._partMessage(e)),t.me||(this.participants.delete(n),this.update({}))}},{key:"wsEventSentNames",value:function(e){this._updateParticipants(e);var n={message:"Participants (%1): %2",vars:[]},t=this.participants.map((function(e){return(Un[e.mode]||"")+e.name}));t.length>1&&(n.message+=" and %3.",n.vars[2]=t.pop()),n.vars[0]=t.length,n.vars[1]=t.join(", "),this.addMessage(n)}},{key:"_addOperations",value:function(){this._readOnlyAttr("setLastReadOp",this.api.operation("setDialogLastRead")),this._readOnlyAttr("messagesOp",this.api.operation("dialogMessages"))}},{key:"_calculateFrozen",value:function(){return""}},{key:"_loadParticipants",value:function(){this.messagesOp&&this.messagesOp.is("success")&&this.events.ready&&!this._participantsLoaded&&(!this.dialog_id||this.is("private")||this.is("frozen")||this.send("/names","_updateParticipants"),this._participantsLoaded=!0)}},{key:"_noop",value:function(){}},{key:"_participantId",value:function(e){return e.toLowerCase()}},{key:"_partMessage",value:function(e){var n={message:"%1 parted.",vars:[e.nick]};return e.kicker?(n.message="%1 was kicked by %2"+(e.message?": %3":""),n.vars.push(e.kicked),n.vars.push(e.message)):e.message&&(n.message+=" Reason: %2",n.vars.push(e.message)),n}},{key:"_updateParticipants",value:function(e){var n=this;this.participants.clear(),e.participants.forEach((function(e){return n.participant(e.nick||e.name,{mode:e.mode})})),e.stopPropagation()}}]),n}(Be);function qn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}var Fn=function(e,n){return(e.is_private||0)-(n.is_private||0)||e.name.localeCompare(n.name)},Kn=function(e){function n(e){var t;return Oe(this,n),(t=Le(this,Re(n).call(this,e)))._readOnlyAttr("dialogs",new hn([],{sorter:Fn})),t._updateableAttr("on_connect_commands",e.on_connect_commands||""),t._updateableAttr("state",e.state||"queued"),t._updateableAttr("wanted_state",e.wanted_state||"connected"),t._updateableAttr("url","string"==typeof e.url?new ln(e.url):e.url),t._updateableAttr("nick",e.nick||t.url.searchParams.get("nick")||""),t.participant(t.nick,{}),t}return Ie(n,e),Se(n,[{key:"addDialog",value:function(e){var n=e.match(/^[a-z]/i);this.send(n?"/query ".concat(e):"/join ".concat(e))}},{key:"ensureDialog",value:function(e){var n=this,t=this.dialogs.get(e.dialog_id);return t?t.update(e):((t=new zn(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?qn(t,!0).forEach((function(n){Ue(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):qn(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},e,{connection_id:this.connection_id,api:this.api,events:this.events}))).on("message",(function(e){return n.emit("message",e)})),t.on("update",(function(){return n.update({})})),this._addDefaultParticipants(t),this.dialogs.set(t.dialog_id,t),this.update({}),t)}},{key:"findDialog",value:function(e){return this.dialogs.get(e.dialog_id)}},{key:"is",value:function(e){return this.state==e}},{key:"removeDialog",value:function(e){return this.dialogs.delete(e.dialog_id),this.update({})}},{key:"update",value:function(e){return e.url&&"string"==typeof e.url&&(e.url=new ln(e.url)),sn(Re(n.prototype),"update",this).call(this,e)}},{key:"wsEventConnection",value:function(e){this.update({state:e.state}),this.addMessage(e.message?{message:"Connection state changed to %1: %2",vars:[e.state,e.message]}:{message:"Connection state changed to %1.",vars:[e.state]})}},{key:"wsEventFrozen",value:function(e){var n=this.findDialog(e);this.ensureDialog(e).participant(this.nick,{me:!0}),e.frozen&&(n||this).addMessage({message:e.frozen,vars:[]})}},{key:"wsEventMessage",value:function(e){return e.dialog_id?this.ensureDialog(e).addMessage(e):this.addMessage(e)}},{key:"wsEventNickChange",value:function(e){var t={old_nick:this.nick,new_nick:e.nick,type:e.type};sn(Re(n.prototype),"wsEventNickChange",this).call(this,t),this.dialogs.forEach((function(e){return e.wsEventNickChange(t)}))}},{key:"wsEventError",value:function(e){var n=this.findDialog(e)||this,t=Ge(e)||"Unknown error from %1.";n.update({errors:this.errors+1}),n.addMessage({message:t,type:"error",sent:e,vars:e.command||e.message})}},{key:"wsEventJoin",value:function(e){var n=this.ensureDialog(e),t=e.nick||this.nick;n.addMessage({message:"%1 joined.",vars:[t]}),n.participant(t,{})}},{key:"wsEventPart",value:function(e){e.nick==this.nick&&this.removeDialog(e)}},{key:"wsEventQuit",value:function(e){this.wsEventPart(e)}},{key:"wsEventSentJoin",value:function(e){this.wsEventJoin(e)}},{key:"wsEventSentList",value:function(e){var n=e.args||"/*/";this.addMessage(e.done?{message:"Found %1 of %2 dialogs from %3.",vars:[e.dialogs.length,e.n_dialogs,n]}:{message:"Found %1 of %2 dialogs from %3, but dialogs are still loading.",vars:[e.dialogs.length,e.n_dialogs,n]})}},{key:"wsEventSentQuery",value:function(e){this.ensureDialog(e)}},{key:"wsEventSentWhois",value:function(e){var n=Object.keys(e.channels),t="%1 (%2)",a=[e.nick,e.host];e.idle_for&&n.length?(t+=" has been idle for %3 in %4.",a.push(e.idle_for),a.push(n.join(", "))):e.idle_for&&!n.length?(t+="has been idle for %3, and is not active in any channels.",a.push(e.idle_for)):(t+="is active in %3.",a.push(n.join(", "))),(this.findDialog(e)||this).addMessage({message:t,vars:a})}},{key:"wsEventTopic",value:function(e){this.ensureDialog(e).addMessage(e.topic?{message:"Topic changed to: %1",vars:[e.topic]}:{message:"No topic is set.",vars:[]})}},{key:"_addDefaultParticipants",value:function(e){e.participant(this.nick),e.is_private&&e.participant(e.name)}},{key:"_addOperations",value:function(){this._readOnlyAttr("setLastReadOp",this.api.operation("setConnectionLastRead")),this._readOnlyAttr("messagesOp",this.api.operation("connectionMessages"))}},{key:"_calculateFrozen",value:function(){switch(this.state){case"connected":return"";case"disconnected":return"Disconnected.";case"unreachable":return"Unreachable.";default:return"Connecting..."}}}]),n}(zn),Gn=function(e){function n(e){var t;return Oe(this,n),(t=Le(this,Re(n).call(this))).name="EmbedMaker",t._localStorageAttr("disableInstagram",!1),t._localStorageAttr("disableTwitter",!1),t._localStorageAttr("expandUrlToMedia",!0),t._readOnlyAttr("api",e.api),t._readOnlyAttr("embeds",{}),t}var t;return Ie(n,e),Se(n,[{key:"render",value:(t=Ee(xe.mark((function e(n,t){var a,r=this;return xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.expandUrlToMedia){e.next=2;break}return e.abrupt("return");case 2:a={},Ze(t,".message__embed",(function(e){a[e.dataset.url]=e})),n.forEach((function(e){r.embeds[e]||r._loadAndRender(e),a[e]||t.appendChild(r._ensureEmbedEl(e)),delete a[e]})),Object.keys(a).forEach((function(e){return a[e].remove()}));case 6:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"renderInstagram",value:function(e){if(!this.disableInstagram)return window.instgrm?window.instgrm.Embeds.process():void We("//platform.instagram.com/en_US/embeds.js")}},{key:"renderPasteEl",value:function(e){rn.highlightBlock(e.querySelector("pre")),Ze(e,".le-meta",(function(e){e.addEventListener("click",(function(){return e.parentNode.classList.toggle("is-expanded")}))}))}},{key:"renderPhoto",value:function(e){var n=this;Ze(e,"img",(function(e){return e.addEventListener("click",(function(){return n.showMedia(e)}))}))}},{key:"renderTwitter",value:function(e){this.disableTwitter||(window.twttr&&window.twttr.widgets.load(),We("//platform.twitter.com/widgets.js"))}},{key:"showMedia",value:function(e){var n=Ke(document.querySelector("body"),"fullscreen-media-wrapper",(function(e){e.addEventListener("click",(function(n){return Ye(e,n.target!=e)}))}));!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(n),n.appendChild(e.cloneNode()),Ye(n,!0)}},{key:"_ensureEmbedEl",value:function(e){return this.embeds[e].el||(this.embeds[e].el=Ke(null,"message__embed",(function(n){n.dataset.url=e})))}},{key:"_loadAndRender",value:function(e){var n=this;return this.embeds[e]={},this.api.operation("embed",{url:e}).perform().then((function(t){var a=n._ensureEmbedEl(e),r=t.res.body;a.innerHTML=r.html,Ze(a,"a",(function(e){e.target="_blank"}));var o=(r.provider_name||"").toLowerCase();return"instagram"==o?n.renderInstagram(a):"twitter"==o?n.renderTwitter(a):-1!=(a.firstChild.className||"").split(/\s+/).indexOf("le-paste")?n.renderPasteEl(a):void Ze(a,".le-photo, .le-thumbnail",(function(e){return n.renderPhoto(a)}))}))}}]),n}(Be);function Wn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Zn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Wn(t,!0).forEach((function(n){Ue(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Wn(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Vn=0,Yn=function(e){function n(e){var t;return Oe(this,n),(t=Le(this,Re(n).call(this))).keepaliveTid=setInterval((function(){return t._send({method:"ping"})}),1e4),t.notificationIcon="",t.queue=[],t.waiting={},t._localStorageAttr("debugEvents",-1!=navigator.userAgent.indexOf("Mozilla")?1:0),t._localStorageAttr("notificationCloseDelay",5e3),t._localStorageAttr("wantNotifications",null),t._readOnlyAttr("wsUrl",e.wsUrl),t._updateableAttr("ready",!1),t}return Ie(n,e),Se(n,[{key:"dispatch",value:function(e){var n=("wsEvent_"+this._getEventNameFromParam(e)).replace(/_(\w)/g,(function(e,n){return n.toUpperCase()}));this.debugEvents&&this._debug(n,e),e.bubbles=!0,e.stopPropagation=function(){e.bubbles=!1};var t=this.waiting[e.id];t&&t(e),e.bubbles&&this.emit("message",Zn({},e,{dispatchTo:n}))}},{key:"ensureConnected",value:function(){this._ws("dequeue")}},{key:"notifyUser",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=this._notificationRejectReason();if(a)this.debugEvents&&console.log("[Events:notifyUser] "+a,e,n,t);else{var r=new Notification(e,Zn({icon:this.notificationIcon},t,{body:n}));r.onclick=function(e){r.cancel(),window.focus()},setTimeout((function(){return r.close()}),this.notificationCloseDelay)}}},{key:"send",value:function(e,n){e.id||"ping"==e.method||(e.id=++Vn),!e.method&&e.message&&(e.method="send"),e.dialog&&["connection_id","dialog_id"].forEach((function(n){e[n]=e.dialog[n]||""})),delete e.dialog,this.debugEvents&&this._debug("send",e),n&&(this.waiting[e.id]=n),this.queue.push(e),this._ws("dequeue")}},{key:"update",value:function(e){return sn(Re(n.prototype),"update",this).call(this,e),e.wantNotifications&&this.notifyUser("Convos","You have enabled notifications!"),this}},{key:"_debug",value:function(e,n){1==this.debugEvents&&"wsEventPong"!=e&&"ping"!=n.method?console.log("[Events:"+(e||"data")+"]",n):this.debugEvents>=2&&console.log("[Events:"+(e||"data")+"]",n)}},{key:"_getEventNameFromParam",value:function(e){if(e.errors)return"error";if("state"==e.event)return e.type;if("sent"==e.event&&e.message.match(/\/\S+/)){var n=e.message.split(" ",2),t=Te(n,2),a=t[0],r=t[1];return e.args=r,e.command=a.substring(1),"sent_"+e.command}return e.event}},{key:"_notificationRejectReason",value:function(){return this.wantNotifications?window.Notification?"granted"!=Notification.permission?Notification.permission:document.hasFocus()?"document.hasFocus":"":"window.Notification":"wantNotifications == false"}},{key:"_send",value:function(e){var n=this.ws&&1==this.ws.readyState&&this.ws;return n&&n.send(JSON.stringify(e)),!!n}},{key:"_ws",value:function(e){var n=this;"dequeue"==e&&this._wsReconnectTid&&(clearTimeout(this._wsReconnectTid),delete this._wsReconnectTid),"start"==e&&this.update({ready:!0}),"stop"==e?(this._wsReconnectTid||(this._wsReconnectTid=setTimeout((function(){return n._ws("dequeue")}),3e3)),this.update({ready:!1}),delete this.ws):this.ws?this.queue=this.queue.filter((function(e){return!n._send(e)})):(this.ws=new WebSocket(this.wsUrl),this.ws.onopen=function(){return n._ws("start")},this.ws.onclose=function(){return n._ws("stop")},this.ws.onerror=function(){return n._ws("stop")},this.ws.onmessage=function(e){return n.dispatch(JSON.parse(e.data))})}}]),n}(Be);function Jn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}var Qn=function(e){function n(e){var t;return Oe(this,n),(t=Le(this,Re(n).call(this,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Jn(t,!0).forEach((function(n){Ue(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Jn(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},e,{connection_id:"",dialog_id:"notifications",is_private:!0,name:"Notifications"}))))._readOnlyAttr("messagesOp",e.messagesOp),t}var t,a;return Ie(n,e),Se(n,[{key:"load",value:(a=Ee(xe.mark((function e(){return xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"loadHistoric",value:(t=Ee(xe.mark((function e(){return xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"_addOperations",value:function(){this._readOnlyAttr("setLastReadOp",this.api.operation("readNotifications"))}}]),n}(zn);function Xn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}var et=function(e){function n(e){var t;Oe(this,n),t=Le(this,Re(n).call(this));var a=e.api;return t._readOnlyAttr("api",(function(){return a})),t._readOnlyAttr("connections",new hn),t._readOnlyAttr("email",(function(){return t.getUserOp.res.body.email||""})),t._readOnlyAttr("embedMaker",new Gn({api:a})),t._readOnlyAttr("events",t._createEvents(e)),t._readOnlyAttr("getUserOp",a.operation("getUser",{connections:!0,dialogs:!0,notifications:!0})),t._readOnlyAttr("notifications",new Qn({api:a,events:t.events,messagesOp:t.getUserOp})),t._localStorageAttr("lastUrl",""),t._localStorageAttr("showGrid",!1),t._proxyAttr("expandUrlToMedia","embedMaker"),t._proxyAttr("wantNotifications","events"),t._proxyAttr("status","getUserOp"),t}var t;return Ie(n,e),Se(n,[{key:"ensureDialog",value:function(e){var n=this;if(e.dialog_id)return this.ensureDialog({connection_id:e.connection_id}).ensureDialog(e);var t=this.findDialog(e);return t?t.update(e):((t=new Kn(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Xn(t,!0).forEach((function(n){Ue(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Xn(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},e,{api:this.api,events:this.events}))).on("update",(function(){return n.update({})})),this.connections.set(t.connection_id,t),this.update({}),t)}},{key:"findDialog",value:function(e){var n=this.connections.get(e.connection_id);return e.dialog_id?n&&n.findDialog(e):n}},{key:"is",value:function(e){return this.getUserOp.is(e)}},{key:"load",value:(t=Ee(xe.mark((function e(){return xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.getUserOp.is("success")){e.next=2;break}return e.abrupt("return",this);case 2:return e.next=4,this.getUserOp.perform();case 4:return this._parseGetUser(this.getUserOp.res.body),this.email&&this.send({method:"ping"}),e.abrupt("return",this);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"removeDialog",value:function(e){if(e.dialog_id){var n=this.findDialog({connection_id:e.connection_id});n&&n.removeDialog(e)}else this.connections.delete(e.connection_id),this.update({})}},{key:"send",value:function(e,n){return this.events.send(e,n)}},{key:"wsEventMe",value:function(e){var n=this.ensureDialog({connection_id:e.connection_id});n.wsEventNickChange(e),n.update(e)}},{key:"wsEventPart",value:function(e){this.emit("dialogEvent",e)}},{key:"wsEventPong",value:function(e){this.wsPongTimestamp=e.ts}},{key:"wsEventSentJoin",value:function(e){this.emit("dialogEvent",e)}},{key:"_createEvents",value:function(e){var n=this,t=new Yn(e);return t.on("message",(function(e){n._dispatchMessageToDialog(e),n[e.dispatchTo]&&n[e.dispatchTo](e)})),t.on("update",(function(e){if(e.ready)return!!n.getUserOp.is("pending")&&n.load();n.getUserOp.update({status:"pending"}),n.connections.forEach((function(e){return e.update({state:"unreachable"})}))})),t}},{key:"_dispatchMessageToDialog",value:function(e){var n=this.findDialog({connection_id:e.connection_id});if(n&&(n[e.dispatchTo]&&n[e.dispatchTo](e),e.bubbles)){var t=n.findDialog(e);t&&t[e.dispatchTo]&&t[e.dispatchTo](e)}}},{key:"_parseGetUser",value:function(e){var n=this;this.connections.clear(),this.notifications.addMessages("set",e.notifications||[]),this.notifications.update({unread:e.unread||0}),(e.connections||[]).forEach((function(e){return n.ensureDialog(e)})),(e.dialogs||[]).forEach((function(e){return n.ensureDialog(e)})),this.update({})}}]),n}(Be);const nt=[];function tt(n,t=e){let a;const r=[];function o(e){if(s(n,e)&&(n=e,a)){const e=!nt.length;for(let e=0;e<r.length;e+=1){const t=r[e];t[1](),nt.push(t,n)}if(e){for(let e=0;e<nt.length;e+=2)nt[e][0](nt[e+1]);nt.length=0}}}return{set:o,update:function(e){o(e(n))},subscribe:function(i,s=e){const c=[i,s];return r.push(c),1===r.length&&(a=t(o)||e),i(n),()=>{const e=r.indexOf(c);-1!==e&&r.splice(e,1),0===r.length&&(a(),a=null)}}}}var at=location.href.replace(/\/+$/,"");function rt(e,n){var t=e.indexOf(n);return-1==t?null:t}function ot(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=it(e);if(!t)return location.href=e;n.event&&n.event.preventDefault(),history[n.replace?"replaceState":"pushState"]({},document.title,t.toString()),setTimeout((function(){return ut.set(t)}),0)}function it(e){if(-1==(e="/"==e.slice(0,1)?at+e:e).indexOf(at))return!1;var n=new URL(e),t=e.substring(at.length+1,rt(e,"?")||rt(e,"#")||e.length);Object.defineProperty(n,"path",{value:t,writable:!1});var a=t.split("/").filter((function(e){return e.length})).map(decodeURIComponent);return Object.defineProperty(n,"pathParts",{value:a,writable:!1}),n}function st(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:d(ut)).searchParams.forEach((function(n,t){var a=e[t];a&&a.tagName&&("checkbox"==a.type?a.checked=!!n:a.value=n,a.syncValue&&a.syncValue())}))}var ct=tt(""),dt=tt({wideEnough:!1,width:0}),ut=tt(it(location.href)),lt=tt(document.title);function ft(e){const n=e-1;return n*n*n+1}function pt(e,{delay:n=0,duration:t=400}){const a=+getComputedStyle(e).opacity;return{delay:n,duration:t,css:e=>`opacity: ${e*a}`}}function gt(e,{delay:n=0,duration:t=400,easing:a=ft,x:r=0,y:o=0,opacity:i=0}){const s=getComputedStyle(e),c=+s.opacity,d="none"===s.transform?"":s.transform,u=c*(1-i);return{delay:n,duration:t,easing:a,css:(e,n)=>`\n\t\t\ttransform: ${d} translate(${(1-e)*r}px, ${(1-e)*o}px);\n\t\t\topacity: ${c-u*n}`}}function mt(n){var t,a,r,o,i;return{c(){D(t=O("i"),"class",a=n.calculateClassName(n.name,n.family)),D(t,"style",r=n.calculateStyle(n.name,n.family,n.style)),D(t,"title",n.title),t.hidden=o=!n.name,i=C(t,"click",n.click_handler)},m(e,n){x(e,t,n)},p(e,n){(e.name||e.family)&&a!==(a=n.calculateClassName(n.name,n.family))&&D(t,"class",a),(e.name||e.family||e.style)&&r!==(r=n.calculateStyle(n.name,n.family,n.style))&&D(t,"style",r),e.title&&D(t,"title",n.title),e.name&&o!==(o=!n.name)&&(t.hidden=o)},i:e,o:e,d(e){e&&k(t),i()}}}function ht(e,n,t){const a={regular:"far",solid:"fas"},r={batman:"https://www.gravatar.com/avatar/ab1839667863f31e359d98364cfdef61",marcusr:"https://www.gravatar.com/avatar/6c056546d802b1a9ac186ab63f9fb632"},o=["fas fa-anchor","fas fa-atom","fas fa-award","fas fa-balance-scale","fas fa-baseball-ball","fas fa-basketball-ball","fas fa-bicycle","fas fa-bolt","fas fa-book-reader","fas fa-candy-cane","fas fa-carrot","fas fa-cat","fas fa-chess-knight","fas fa-child","fas fa-coffee","fas fa-cookie-bite","fas fa-crow","fas fa-dice","fas fa-dog","fas fa-dove","fas fa-feather","fas fa-fish","fas fa-gem","fas fa-ghost","fas fa-hard-hat","fas fa-hat-cowboy","fas fa-hat-wizard","fas fa-hiking","fas fa-horse-head","fas fa-horse","fas fa-id-badge","fas fa-igloo","fas fa-mask","fas fa-meteor","fas fa-paint-brush","fas fa-paw","fas fa-pepper-hot","fas fa-pizza-slice","fas fa-portrait","fas fa-puzzle-piece","fas fa-rainbow","fas fa-robot","fas fa-rocket","fas fa-running","fas fa-seedling","fas fa-skating","fas fa-skiing","fas fa-smile","fas fa-snowboarding","fas fa-snowflake","fas fa-snowman","fas fa-swimmer","fas fa-umbrella","fas fa-user-astronaut","fas fa-user-graduate","fas fa-user-ninja","fas fa-user-secret","fas fa-walking","fas fa-yin-yang"];let{class:i="",animation:s="",family:c="",name:d,style:u="",title:l=""}=n;return e.$set=e=>{"class"in e&&t("className",i=e.class),"animation"in e&&t("animation",s=e.animation),"family"in e&&t("family",c=e.family),"name"in e&&t("name",d=e.name),"style"in e&&t("style",u=e.style),"title"in e&&t("title",l=e.title)},{className:i,animation:s,family:c,name:d,style:u,title:l,calculateClassName:function(e,n){const t=[],c=e.match(/^pick:(.+)$/);if(c){if(r[c[1]])return"fas fa-contributor";t.push(function(e){e.match(/^\d+$/)&&console.log(o[e]);if(e.match(/^\d+$/))return o[e];let n=0;for(let t=0;t<e.length;t++)n=e.charCodeAt(t)+((n<<5)-n),n&=n;return n=Math.abs(n),o[n%o.length]}(c[1]))}else t.push(a[n]||"fas"),t.push("fa-"+e);return s&&t.push(s.split(" ").map(e=>"fa-"+e)),i&&t.push(i.split(" ")),t.join(" ")},calculateStyle:function(e,n,t){const a=[];t&&a.push(t);const o=e.match(/^pick:(.+)$/);return o&&r[o[1]]&&a.push('background-image:url("'+r[o[1]]+'")'),a.join(";")},click_handler:function(n){Z(e,n)}}}Object.defineProperty(ut,"base",{get:function(){return at},set:function(e){at=e.replace(/\/+$/,""),ut.set(it(d(ut).toString()))}});class $t extends _e{constructor(e){super(),ye(this,e,ht,mt,s,["class","animation","family","name","style","title"])}}function vt(e){var n,t,a,r,o;const i=e.$$slots.default,s=l(i,e,null);var c=new $t({props:{name:e.$activeMenu?"times-circle":"bars"}});return{c(){n=O("header"),s&&s.c(),t=S(),a=O("a"),c.$$.fragment.c(),D(a,"href",r="#activeMenu:"+(e.$activeMenu?"":"nav")),D(a,"class","chat-header__hamburger"),D(n,"class","chat-header")},l(e){s&&s.l(header_nodes)},m(e,r){x(e,n,r),s&&s.m(n,null),w(n,t),w(n,a),ve(c,a,null),o=!0},p(e,n){s&&s.p&&e.$$scope&&s.p(p(i,n,e,null),f(i,n,null));var t={};e.$activeMenu&&(t.name=n.$activeMenu?"times-circle":"bars"),c.$set(t),o&&!e.$activeMenu||r===(r="#activeMenu:"+(n.$activeMenu?"":"nav"))||D(a,"href",r)},i(e){o||(fe(s,e),fe(c.$$.fragment,e),o=!0)},o(e){pe(s,e),pe(c.$$.fragment,e),o=!1},d(e){e&&k(n),s&&s.d(e),be(c)}}}function bt(e,n,t){let a;u(e,ct,e=>{t("$activeMenu",a=e)});let{$$slots:r={},$$scope:o}=n;return e.$set=e=>{"$$scope"in e&&t("$$scope",o=e.$$scope)},{$activeMenu:a,$$slots:r,$$scope:o}}class yt extends _e{constructor(e){super(),ye(this,e,bt,vt,s,[])}}var _t=[];function wt(e,n){return wt[e]?wt[e](n):[]}function xt(e,n,t){const a=Object.create(e);return a.opt=n[t],a.i=t,a}function kt(e){var n,t,a=e.opt.text||e.opt.val+"";return{c(){D(n=O("a"),"href","#index:"+e.i),D(n,"tabindex","-1"),R(n,"has-focus",e.i==e.activeAutocompleteIndex),t=C(n,"click",M(e.selectOption))},m(e,t){x(e,n,t),n.innerHTML=a},p(e,t){e.autocompleteOptions&&a!==(a=t.opt.text||t.opt.val+"")&&(n.innerHTML=a),e.activeAutocompleteIndex&&R(n,"has-focus",t.i==t.activeAutocompleteIndex)},d(e){e&&k(n),t()}}}function Et(e){var n,t,a,r,i,s,c,d,u,l,f,p=new $t({props:{name:"paper-plane"}});let g=e.autocompleteOptions,m=[];for(let n=0;n<g.length;n+=1)m[n]=kt(xt(e,g,n));return{c(){n=O("div"),t=O("textarea"),r=S(),i=O("a"),p.$$.fragment.c(),s=S(),c=O("div");for(let e=0;e<m.length;e+=1)m[e].c();D(t,"id","chat_input_textarea"),D(t,"placeholder",a=Tn("What is on your mind %1?",e.$connection.nick)),D(i,"href","#send"),D(i,"class","btn-send"),D(c,"class",d="chat-input_autocomplete chat-input_autocomplete_"+e.autocompleteCategory),c.hidden=u=!e.autocompleteOptions.length,D(n,"class","chat-input"),f=[C(t,"change",e.change_handler),C(t,"keydown",e.keydown_handler),C(t,"keyup",e.keyup_handler),C(i,"click",M(e.sendMessage))]},m(a,o){x(a,n,o),w(n,t),e.textarea_binding(t),w(n,r),w(n,i),ve(p,i,null),w(n,s),w(n,c);for(let e=0;e<m.length;e+=1)m[e].m(c,null);l=!0},p(e,n){if(l&&!e.$connection||a===(a=Tn("What is on your mind %1?",n.$connection.nick))||D(t,"placeholder",a),e.activeAutocompleteIndex||e.autocompleteOptions){let t;for(g=n.autocompleteOptions,t=0;t<g.length;t+=1){const a=xt(n,g,t);m[t]?m[t].p(e,a):(m[t]=kt(a),m[t].c(),m[t].m(c,null))}for(;t<m.length;t+=1)m[t].d(1);m.length=g.length}l&&!e.autocompleteCategory||d===(d="chat-input_autocomplete chat-input_autocomplete_"+n.autocompleteCategory)||D(c,"class",d),l&&!e.autocompleteOptions||u===(u=!n.autocompleteOptions.length)||(c.hidden=u)},i(e){l||(fe(p.$$.fragment,e),l=!0)},o(e){pe(p.$$.fragment,e),l=!1},d(t){t&&k(n),e.textarea_binding(null),be(p),E(m,t),o(f)}}}function Ot(n,t,a){let r,o=e;n.$$.on_destroy.push(()=>o());let i,{dialog:s={}}=t,d=0,u="none",l=0;const f=W("user");function p(e,n={}){const t=n.space||"";a("inputEl",i.value=y[0]+e+t+y[3],i),a("inputEl",i.selectionStart=a("inputEl",i.selectionEnd=(y[0]+e+t).length,i),i),t.length&&a("pos",l=i.selectionStart)}function g(e){const n=v[d];n&&p(n.val,e)}function m(e,n){v.length&&(e.preventDefault(),a("activeAutocompleteIndex",d+=n),d<0&&a("activeAutocompleteIndex",d=v.length-1),d>=v.length&&a("activeAutocompleteIndex",d=0),g({space:""}))}function h(){const e={message:i.value,method:"send",dialog:s};e.message=e.message.replace(/^\/j\s/,"/join ");(e.message.match(/^\/(\w+)\s*(\S*)/)||["","message",""]).slice(1);e.message.length&&f.send(e),a("inputEl",i.value="",i)}const $={ArrowDown:e=>m(e,e.shiftKey?4:1),ArrowUp:e=>m(e,e.shiftKey?-4:-1),Tab:e=>m(e,e.shiftKey?-1:1),Enter(e){v[d]?(e.preventDefault(),g({space:" "})):e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||(e.preventDefault(),h())},Fallback(e){},Release(e){1!=e.key.length&&-1==["ArrowLeft","ArrowRight","Backspace"].indexOf(e.key)||a("pos",l=i.selectionStart)}};let v,b,y;return n.$set=e=>{"dialog"in e&&a("dialog",s=e.dialog)},n.$$.update=(e={pos:1,inputParts:1,dialog:1})=>{e.pos&&a("inputParts",y=l?function(e){let n="",t="";return[i.value.substring(0,e).replace(/(\S)(\S*)$/,(e,a,r)=>(n=a,t=r,"")),n,t,i.value.substring(e)]}(l):["","","",""]),e.inputParts&&a("autocompleteOptions",v=function([e,n,t,r]){a("autocompleteCategory",u=":"==n&&t.length?"emojis":"/"!=n||e.length?"@"==n&&t.length?"nicks":"#"==n||"&"==n?"dialogs":"none":"commands"),a("activeAutocompleteIndex",d=0);const o=wt(u,{dialog:s,query:n+t,user:f});return o.length&&o.unshift({val:n+t}),o}(y)||[]),e.dialog&&(()=>(o(),o=c(b,e=>{a("$connection",r=e)}),b))(a("connection",b=f.findDialog({connection_id:s.connection_id})))},{dialog:s,activeAutocompleteIndex:d,autocompleteCategory:u,inputEl:i,pos:l,add:p,selectOption:function(e){a("activeAutocompleteIndex",d=parseInt(e.target.closest("a").href.replace(/.*index:/,""),10)),g({space:" "}),i.focus()},sendMessage:h,keys:$,autocompleteOptions:v,connection:b,$connection:r,textarea_binding:function(e){Y[e?"unshift":"push"](()=>{a("inputEl",i=e)})},change_handler:e=>{a("pos",l=i.selectionStart)},keydown_handler:e=>($[e.key]||$.Fallback)(e),keyup_handler:e=>$.Release(e)}}wt.commands=function(e){for(var n=e.query,t=[],a=0;a<_t.length;a++)if(0==_t[a].cmd.indexOf(n)){var r=_t[a].alias||_t[a].cmd,o=_t[a].example.replace(/</g,"&lt;");t.push({text:o,val:r})}return t},wt.dialogs=function(e){for(var n=e.dialog,t=e.query,a=e.user.findDialog({connection_id:n.connection_id}).dialogs.toArray(),r=[],o=0;o<a.length&&!(-1!=a[o].name.toLowerCase().indexOf(t)&&(r.push({text:a[o].name,val:a[o].dialog_id}),r.length>=20));o++);return r},wt.emojis=function(e){var n=e.query,t=[];return[":","_"].map((function(e){return e+n.slice(1,2)})).forEach((function(e){for(var a=An(e,"group"),r=0;r<a.length&&(a[r].shortname.indexOf(n)>=0&&t.push({val:a[r].emoji,text:Cn(a[r].emoji)}),!(t.length>=20));r++);})),t},wt.nicks=function(e){var n=e.dialog,t=e.query,a=n.participants.values(),r=new RegExp("^"+Ve(t.slice(1)),"i"),o=[],i=!0,s=!1,c=void 0;try{for(var d,u=a[Symbol.iterator]();!(i=(d=u.next()).done);i=!0){var l=d.value;if(o.length>=20)break;l.nick.match(r)&&o.push({val:l.nick})}}catch(e){s=!0,c=e}finally{try{i||null==u.return||u.return()}finally{if(s)throw c}}return o},_t.push({cmd:"/me",example:"/me <msg>",description:"Send message as an action."}),_t.push({cmd:"/say",example:"/say <msg>",description:NaN}),_t.push({cmd:"/topic",example:"/topic or /topic <new topic>",description:"Show current topic, or set a new one."}),_t.push({cmd:"/whois",example:"/whois <nick>",description:"Show information about a user."}),_t.push({cmd:"/query",example:"/query <nick>",description:"Open up a new chat window with nick."}),_t.push({cmd:"/msg",example:"/msg <nick> <msg>",description:"Send a direct message to nick."}),_t.push({cmd:"/names",example:"/names",description:"Show participants in the channel."}),_t.push({cmd:"/join",example:"/join <#channel>",description:"Join channel and open up a chat window."}),_t.push({cmd:"/nick",example:"/nick <nick>",description:"Change your wanted nick."}),_t.push({cmd:"/part",example:"/part",description:"Leave channel, and close window."}),_t.push({cmd:"/close",example:"/close <nick>",description:"Close conversation with nick, defaults to current active."}),_t.push({cmd:"/kick",example:"/kick <nick>",description:"Kick a user from the current channel."}),_t.push({cmd:"/mode",example:"/mode +o #channel nick",description:"Change mode of yourself or a user"}),_t.push({cmd:"/reconnect",example:"/reconnect",description:"Restart the current connection."}),_t.push({cmd:"/cs",example:"/cs <msg>",description:'Short for "/msg chanserv ...".',alias:"/msg chanserv"}),_t.push({cmd:"/ns",example:"/ns <msg>",description:'Short for "/msg nickserv ...".',alias:"/msg nickserv"}),_t.push({cmd:"/hs",example:"/hs <msg>",description:'Short for "/msg hostserv ...".',alias:"/msg hostserv"}),_t.push({cmd:"/bs",example:"/bs <msg>",description:'Short for "/msg botserv ...".',alias:"/msg botserv"});class Nt extends _e{constructor(e){super(),ye(this,e,Ot,Et,s,["dialog","add"])}get add(){return this.$$.ctx.add}}function St(e){var n,t,a;const r=e.$$slots.default,o=l(r,e,null);return{c(){n=O("a"),o&&o.c(),D(n,"href",e.absoluteHref),D(n,"class",e.className),D(n,"style",e.style),D(n,"title",e.title),R(n,"has-path",e.$currentUrl==e.absoluteHref.replace(/(#|\?).*/,"")),a=C(n,"click",e.onClick)},l(e){o&&o.l(a_nodes)},m(a,r){x(a,n,r),o&&o.m(n,null),e.a_binding(n),t=!0},p(e,a){o&&o.p&&e.$$scope&&o.p(p(r,a,e,null),f(r,a,null)),t&&!e.absoluteHref||D(n,"href",a.absoluteHref),t&&!e.className||D(n,"class",a.className),t&&!e.style||D(n,"style",a.style),t&&!e.title||D(n,"title",a.title),(e.className||e.$currentUrl||e.absoluteHref)&&R(n,"has-path",a.$currentUrl==a.absoluteHref.replace(/(#|\?).*/,""))},i(e){t||(fe(o,e),t=!0)},o(e){pe(o,e),t=!1},d(t){t&&k(n),o&&o.d(t),e.a_binding(null),a()}}}function At(e,n,t){let a;u(e,ut,e=>{t("$currentUrl",a=e)});let r,{class:o=""}=n,{href:i="/",native:s=!1,replace:c=!1,style:d="",title:l=""}=n;let f,{$$slots:p={},$$scope:g}=n;return e.$set=e=>{"class"in e&&t("className",o=e.class),"href"in e&&t("href",i=e.href),"native"in e&&t("native",s=e.native),"replace"in e&&t("replace",c=e.replace),"style"in e&&t("style",d=e.style),"title"in e&&t("title",l=e.title),"$$scope"in e&&t("$$scope",g=e.$$scope)},e.$$.update=(e={href:1})=>{e.href&&t("absoluteHref",f="/"==i.slice(0,1)?ut.base+i:i)},{className:o,el:r,href:i,native:s,replace:c,style:d,title:l,focus:()=>r.focus(),onClick:function(e){s||ot(e.target.closest("a").href,{event:e,replace:c})},absoluteHref:f,$currentUrl:a,a_binding:function(e){Y[e?"unshift":"push"](()=>{t("el",r=e)})},$$slots:p,$$scope:g}}class Ct extends _e{constructor(e){super(),ye(this,e,At,St,s,["class","href","native","replace","style","title","focus"])}get focus(){return this.$$.ctx.focus}}var Mt=we((function(e){function n(e){let n=document.createElement("div");const t=[[e,n]],a=[];for(;t.length;){const[e,r]=t.shift();let o,i,s=typeof e;if(null===e||"undefined"==s?s="null":Array.isArray(e)&&(s="array"),"array"==s)(i=e=>e).len=e.length,(o=document.createElement("div")).className="json-array "+(i.len?"has-items":"is-empty");else if("object"==s){const n=Object.keys(e).sort();(i=e=>n[e]).len=n.length,(o=document.createElement("div")).className="json-object "+(i.len?"has-items":"is-empty")}else(o=document.createElement("span")).className="json-"+s,o.textContent="null"==s?"null":"boolean"!=s?e:e?"true":"false";if(i){const c=document.createElement("span");if(c.className="json-type",c.textContent=i.len?s+"["+i.len+"]":"{}",r.appendChild(c),-1!=a.indexOf(e))n.classList.add("has-recursive-items"),o.classList.add("is-seen");else{for(let n=0;n<i.len;n++){const a=i(n),r=document.createElement("div"),s=document.createElement("span");s.className="json-key",s.textContent=a,r.appendChild(s),o.appendChild(r),t.push([e[a],r])}a.push(e)}}r.className="json-item "+o.className.replace(/^json-/,"contains-"),r.appendChild(o)}return n}try{e.exports={jsonhtmlify:n}}catch(e){window.jsonhtmlify=n}})).jsonhtmlify;function Dt(e,n,t){const a=Object.create(e);return a.message=n[t],a.i=t,a}function Tt(e){var n,t,a=Tn("notifications"==e.dialog.dialog_id?"No notifications.":"No messages.")+"";return{c(){n=O("h2"),t=N(a)},m(e,a){x(e,n,a),w(n,t)},p(e,n){e.dialog&&a!==(a=Tn("notifications"==n.dialog.dialog_id?"No notifications.":"No messages.")+"")&&T(t,a)},d(e){e&&k(n)}}}function Pt(n){var t,a,r,o=Tn("New messages")+"";return{c(){t=O("div"),a=O("span"),r=N(o),D(t,"class","message-status-line for-last-read")},m(e,n){x(e,t,n),w(t,a),w(a,r)},p:e,d(e){e&&k(t)}}}function Lt(e){var n,t,a,r=e.message.ts.getHumanDate()+"";return{c(){n=O("div"),t=O("span"),a=N(r),D(n,"class","message-status-line for-day-changed")},m(e,r){x(e,n,r),w(n,t),w(t,a)},p(e,n){e.dialog&&r!==(r=n.message.ts.getHumanDate()+"")&&T(a,r)},d(e){e&&k(n)}}}function Rt(n){var t,a,r,o=Tn("Start of history")+"";return{c(){t=O("div"),a=O("span"),r=N(o),D(t,"class","message-status-line for-start-of-history")},m(e,n){x(e,t,n),w(t,a),w(a,r)},p:e,d(e){e&&k(t)}}}function jt(e){var n,t,a=Tn("%1 in %2",e.message.from,e.message.dialog_id)+"";return{c(){n=O("a"),t=N(a),D(n,"href","#see"),D(n,"class","message__from"),L(n,"color",e.message.color)},m(e,a){x(e,n,a),w(n,t)},p(e,r){e.dialog&&a!==(a=Tn("%1 in %2",r.message.from,r.message.dialog_id)+"")&&T(t,a),e.dialog&&L(n,"color",r.message.color)},d(e){e&&k(n)}}}function It(e){var n,t,a,r,o=e.message.from+"";function i(){return e.click_handler(e)}return{c(){n=O("a"),t=N(o),D(n,"href",a="#input:"+e.message.from),D(n,"class","message__from"),L(n,"color",e.message.color),r=C(n,"click",M(i))},m(e,a){x(e,n,a),w(n,t)},p(r,i){e=i,r.dialog&&o!==(o=e.message.from+"")&&T(t,o),r.dialog&&a!==(a="#input:"+e.message.from)&&D(n,"href",a),r.dialog&&L(n,"color",e.message.color)},d(e){e&&k(n),r()}}}function Ut(e){var n,t=new $t({props:{name:"exclamation-circle"}});return t.$on("click",e.toggleDetails),{c(){t.$$.fragment.c()},m(e,a){ve(t,e,a),n=!0},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){be(t,e)}}}function Bt(e){var n,t,a,r,o,i,s,c,d,u,l,f,p,g,m,h=e.message.ts.toHuman()+"",$=e.message.markdown+"",v=e.i&&e.i==e.dialog.messages.length-e.dialog.unread&&Pt();function b(e,n){return n.message.endOfHistory?Rt:n.message.dayChanged?Lt:void 0}var y=b(0,e),_=y&&y(e),E=new $t({props:{name:"pick:"+e.message.from,style:"color:"+e.message.color}});function A(e,n){return n.dialog.connection_id?It:jt}var M=A(0,e),P=M(e),L="error"==e.message.type&&Ut(e);return{c(){v&&v.c(),n=S(),_&&_.c(),t=S(),a=O("div"),E.$$.fragment.c(),r=S(),o=O("b"),i=N(h),c=S(),P.c(),d=S(),u=O("div"),L&&L.c(),l=S(),D(o,"class","message__ts"),D(o,"title",s=e.message.ts.toLocaleString()),f=new j($,null),D(u,"class","message__text"),D(a,"class",p="message is-type-"+e.message.type),D(a,"data-index",e.i),R(a,"is-not-present",!e.senderIsPresent(e.message)),R(a,"is-sent-by-you",e.message.from==e.connection.nick),R(a,"is-highlighted",e.message.highlight),R(a,"has-not-same-from",!e.message.isSameSender&&!e.message.dayChanged),R(a,"has-same-from",e.message.isSameSender&&!e.message.dayChanged),m=C(a,"click",e.gotoDialog)},m(e,s){v&&v.m(e,s),x(e,n,s),_&&_.m(e,s),x(e,t,s),x(e,a,s),ve(E,a,null),w(a,r),w(a,o),w(o,i),w(a,c),P.m(a,null),w(a,d),w(a,u),L&&L.m(u,null),w(u,l),f.m(u),g=!0},p(e,r){r.i&&r.i==r.dialog.messages.length-r.dialog.unread?v?v.p(e,r):((v=Pt()).c(),v.m(n.parentNode,n)):v&&(v.d(1),v=null),y===(y=b(0,r))&&_?_.p(e,r):(_&&_.d(1),(_=y&&y(r))&&(_.c(),_.m(t.parentNode,t)));var c={};e.dialog&&(c.name="pick:"+r.message.from),e.dialog&&(c.style="color:"+r.message.color),E.$set(c),g&&!e.dialog||h===(h=r.message.ts.toHuman()+"")||T(i,h),g&&!e.dialog||s===(s=r.message.ts.toLocaleString())||D(o,"title",s),M===(M=A(0,r))&&P?P.p(e,r):(P.d(1),(P=M(r))&&(P.c(),P.m(a,d))),"error"==r.message.type?L?fe(L,1):((L=Ut(r)).c(),fe(L,1),L.m(u,l)):L&&(ue(),pe(L,1,1,()=>{L=null}),le()),g&&!e.dialog||$===($=r.message.markdown+"")||f.p($),g&&!e.dialog||p===(p="message is-type-"+r.message.type)||D(a,"class",p),(e.dialog||e.senderIsPresent||e.dialog)&&R(a,"is-not-present",!r.senderIsPresent(r.message)),(e.dialog||e.dialog||e.connection)&&R(a,"is-sent-by-you",r.message.from==r.connection.nick),(e.dialog||e.dialog)&&(R(a,"is-highlighted",r.message.highlight),R(a,"has-not-same-from",!r.message.isSameSender&&!r.message.dayChanged),R(a,"has-same-from",r.message.isSameSender&&!r.message.dayChanged))},i(e){g||(fe(E.$$.fragment,e),fe(L),g=!0)},o(e){pe(E.$$.fragment,e),pe(L),g=!1},d(e){v&&v.d(e),e&&k(n),_&&_.d(e),e&&(k(t),k(a)),be(E),P.d(),L&&L.d(),m()}}}function Ht(e){var n,t,a,r=Ln(e.connection,e.dialog).replace(/\.$/,"")+"";return{c(){n=O("div"),t=O("span"),a=N(r),D(n,"class","message-status-line for-connection-status")},m(e,r){x(e,n,r),w(n,t),w(t,a)},p(e,n){(e.connection||e.dialog)&&r!==(r=Ln(n.connection,n.dialog).replace(/\.$/,"")+"")&&T(a,r)},d(e){e&&k(n)}}}function zt(e){var n,t,a,r,o,i,s,c=e.now.toHuman()+"",d=new $t({props:{name:"cog",style:"color:"+e.connection.color}}),u=new Ct({props:{href:"#activeMenu:settings",class:"message__from",style:"color:"+e.connection.color,$$slots:{default:[qt]},$$scope:{ctx:e}}});function l(e,n){return"unreachable"==n.connection.state?Kt:Ft}var f=l(0,e),p=f(e);return{c(){n=O("div"),d.$$.fragment.c(),t=S(),a=O("b"),r=N(c),o=S(),u.$$.fragment.c(),i=S(),p.c(),D(a,"class","message__ts"),D(a,"title",e.now.toLocaleString()),D(n,"class","message is-type-error")},m(e,c){x(e,n,c),ve(d,n,null),w(n,t),w(n,a),w(a,r),w(n,o),ve(u,n,null),w(n,i),p.m(n,null),s=!0},p(e,t){var a={};e.connection&&(a.style="color:"+t.connection.color),d.$set(a);var r={};e.connection&&(r.style="color:"+t.connection.color),e.$$scope&&(r.$$scope={changed:e,ctx:t}),u.$set(r),f===(f=l(0,t))&&p?p.p(e,t):(p.d(1),(p=f(t))&&(p.c(),p.m(n,null)))},i(e){s||(fe(d.$$.fragment,e),fe(u.$$.fragment,e),s=!0)},o(e){pe(d.$$.fragment,e),pe(u.$$.fragment,e),s=!1},d(e){e&&k(n),be(d),be(u),p.d()}}}function qt(e){var n;return{c(){n=N("Convos")},m(e,t){x(e,n,t)},d(e){e&&k(n)}}}function Ft(e){var n,t=Pn("Your connection %1 can be edited in [settings](%2).",e.connection.name,"#activeMenu:settings")+"";return{c(){D(n=O("div"),"class","message__text")},m(e,a){x(e,n,a),n.innerHTML=t},p(e,a){e.connection&&t!==(t=Pn("Your connection %1 can be edited in [settings](%2).",a.connection.name,"#activeMenu:settings")+"")&&(n.innerHTML=t)},d(e){e&&k(n)}}}function Kt(n){var t,a,r=Pn("Trying to [reconnect](#reconnect)...")+"";return{c(){D(t=O("div"),"class","message__text"),a=C(t,"click",n.ensureConnected)},m(e,n){x(e,t,n),t.innerHTML=r},p:e,d(e){e&&k(t),a()}}}function Gt(e){var n;return{c(){n=N("Convos")},m(e,t){x(e,n,t)},d(e){e&&k(n)}}}function Wt(n){var t,a,r,o=Tn("Loading...")+"";return{c(){t=O("div"),a=O("span"),r=N(o),D(t,"class","message-status-line for-loading")},m(e,n){x(e,t,n),w(t,a),w(a,r)},p:e,d(e){e&&k(t)}}}function Zt(e){var n,t,a,r,o,i,s,c=e.dialog.is("loading"),d=!e.dialog.messages.length&&Tt(e);let u=e.dialog.messages,l=[];for(let n=0;n<u.length;n+=1)l[n]=Bt(Dt(e,u,n));const f=e=>pe(l[e],1,1,()=>{l[e]=null});var p=(e.connection.frozen||e.dialog.frozen)&&Ht(e),g=e.connection.frozen&&zt(e),m=null===e.user.wantNotifications&&function(e){var n,t,a,r,o,i,s,c,d=e.now.toHuman()+"",u=Pn("Please go to [settings](/settings) to enable notifications.")+"",l=new $t({props:{name:"cog",style:"color:"+e.connection.color}}),f=new Ct({props:{href:"/settings",class:"message__from",style:"color:"+e.connection.color,$$slots:{default:[Gt]},$$scope:{ctx:e}}});return{c(){n=O("div"),l.$$.fragment.c(),t=S(),a=O("b"),r=N(d),o=S(),f.$$.fragment.c(),i=S(),s=O("div"),D(a,"class","message__ts"),D(a,"title",e.now.toLocaleString()),D(s,"class","message__text"),D(n,"class","message is-type-error")},m(e,d){x(e,n,d),ve(l,n,null),w(n,t),w(n,a),w(a,r),w(n,o),ve(f,n,null),w(n,i),w(n,s),s.innerHTML=u,c=!0},p(e,n){var t={};e.connection&&(t.style="color:"+n.connection.color),l.$set(t);var a={};e.connection&&(a.style="color:"+n.connection.color),e.$$scope&&(a.$$scope={changed:e,ctx:n}),f.$set(a)},i(e){c||(fe(l.$$.fragment,e),fe(f.$$.fragment,e),c=!0)},o(e){pe(l.$$.fragment,e),pe(f.$$.fragment,e),c=!1},d(e){e&&k(n),be(l),be(f)}}}(e),h=c&&Wt();return{c(){d&&d.c(),n=S();for(let e=0;e<l.length;e+=1)l[e].c();t=S(),p&&p.c(),a=S(),g&&g.c(),r=S(),m&&m.c(),o=S(),h&&h.c(),i=A()},m(e,c){d&&d.m(e,c),x(e,n,c);for(let n=0;n<l.length;n+=1)l[n].m(e,c);x(e,t,c),p&&p.m(e,c),x(e,a,c),g&&g.m(e,c),x(e,r,c),m&&m.m(e,c),x(e,o,c),h&&h.m(e,c),x(e,i,c),s=!0},p(e,o){if(o.dialog.messages.length?d&&(d.d(1),d=null):d?d.p(e,o):((d=Tt(o)).c(),d.m(n.parentNode,n)),e.dialog||e.senderIsPresent||e.connection||e.l){let n;for(u=o.dialog.messages,n=0;n<u.length;n+=1){const a=Dt(o,u,n);l[n]?(l[n].p(e,a),fe(l[n],1)):(l[n]=Bt(a),l[n].c(),fe(l[n],1),l[n].m(t.parentNode,t))}for(ue(),n=u.length;n<l.length;n+=1)f(n);le()}o.connection.frozen||o.dialog.frozen?p?p.p(e,o):((p=Ht(o)).c(),p.m(a.parentNode,a)):p&&(p.d(1),p=null),o.connection.frozen?g?(g.p(e,o),fe(g,1)):((g=zt(o)).c(),fe(g,1),g.m(r.parentNode,r)):g&&(ue(),pe(g,1,1,()=>{g=null}),le()),null===o.user.wantNotifications&&m.p(e,o),e.dialog&&(c=o.dialog.is("loading")),c?h?h.p(e,o):((h=Wt()).c(),h.m(i.parentNode,i)):h&&(h.d(1),h=null)},i(e){if(!s){for(let e=0;e<u.length;e+=1)fe(l[e]);fe(g),fe(m),s=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)pe(l[e]);pe(g),pe(m),s=!1},d(e){d&&d.d(e),e&&k(n),E(l,e),e&&k(t),p&&p.d(e),e&&k(a),g&&g.d(e),e&&k(r),m&&m.d(e),e&&k(o),h&&h.d(e),e&&k(i)}}}function Vt(e,n,t){let{connection:a,dialog:r,input:o}=n;const i=new vn,s=W("user");return e.$set=e=>{"connection"in e&&t("connection",a=e.connection),"dialog"in e&&t("dialog",r=e.dialog),"input"in e&&t("input",o=e.input)},{connection:a,dialog:r,input:o,now:i,user:s,ensureConnected:function(e){e.preventDefault(),s.events.ensureConnected()},gotoDialog:function(e){if(r.connection_id)return;const n=e.target.closest(".message"),t=r.messages[n.dataset.index];t&&(e.preventDefault(),ot(["","chat",t.connection_id,t.dialog_id].map(encodeURIComponent).join("/")+"#"+t.ts.toISOString()))},senderIsPresent:function(e){return r.participants.has(e.fromId)||e.fromId==a.connection_id},toggleDetails:function(e){const n=e.target.closest(".message"),t=n.dataset.index;let a=n.querySelector(".has-message-details");if(a)return Ye(a,"toggle");const o=r.messages[t],i={...o.sent||o};["bubbles","stopPropagation"].forEach(e=>delete i[e]),(a=Mt(i.sent||i)).className=["message__embed","has-message-details",a.className].join(" "),n.appendChild(a)},click_handler:({message:e})=>o.add(e.from)}}class Yt extends _e{constructor(e){super(),ye(this,e,Vt,Zt,s,["connection","dialog","input"])}}function Jt(e){var n,t,a,r,o,i=new $t({props:{animation:e.animation,name:e.icon}});const s=e.$$slots.default,c=l(s,e,null);return{c(){n=O("button"),i.$$.fragment.c(),t=S(),c&&c.c(),D(n,"class",a=e.classNames.join(" ")),n.disabled=e.disabledProp,D(n,"type",e.type),o=C(n,"click",e.click_handler)},l(e){c&&c.l(button_nodes)},m(e,a){x(e,n,a),ve(i,n,null),w(n,t),c&&c.m(n,null),r=!0},p(e,t){var o={};e.animation&&(o.animation=t.animation),e.icon&&(o.name=t.icon),i.$set(o),c&&c.p&&e.$$scope&&c.p(p(s,t,e,null),f(s,t,null)),r&&!e.classNames||a===(a=t.classNames.join(" "))||D(n,"class",a),r&&!e.disabledProp||(n.disabled=t.disabledProp),r&&!e.type||D(n,"type",t.type)},i(e){r||(fe(i.$$.fragment,e),fe(c,e),r=!0)},o(e){pe(i.$$.fragment,e),pe(c,e),r=!1},d(e){e&&k(n),be(i),c&&c.d(e),o()}}}const Qt=700;function Xt(e,n,t){let a,r="",o=[],i=!1,s=0,{disabled:c=!1,icon:d="",op:l=new tn({api:!1,id:""}),type:f=""}=n;function p(e){e&&t("t0",s=(new vn).toEpoch()),t("animation",r=e?"spin":""),t("forceDisable",i=e)}u(e,l,e=>{t("$op",a=e)});let g,{$$slots:m={},$$scope:h}=n;return e.$set=e=>{"disabled"in e&&t("disabled",c=e.disabled),"icon"in e&&t("icon",d=e.icon),"op"in e&&t("op",l=e.op),"type"in e&&t("type",f=e.type),"$$scope"in e&&t("$$scope",h=e.$$scope)},e.$$.update=(e={$op:1,t0:1,icon:1,disabled:1,forceDisable:1})=>{e.$op&&a.is("loading")&&p(!0),(e.$op||e.t0)&&(a.is("loading")||setTimeout(()=>p(!1),Qt-((new vn).toEpoch()-s))),e.icon&&t("classNames",o=["btn","for-"+(d||"default")]),(e.disabled||e.forceDisable)&&t("disabledProp",g=c||i)},{animation:r,classNames:o,disabled:c,icon:d,op:l,type:f,disabledProp:g,click_handler:function(n){Z(e,n)},$$slots:m,$$scope:h}}class ea extends _e{constructor(e){super(),ye(this,e,Xt,Jt,s,["disabled","icon","op","type"])}}const na=()=>({}),ta=()=>({});function aa(e){var n,t,a,r,i,s,c,d,u=new $t({props:{family:"regular",name:e.icon}});u.$on("click",e.click_handler);const g=e.$$slots.label,m=l(g,e,ta);return{c(){n=O("div"),t=O("input"),a=S(),u.$$.fragment.c(),r=S(),i=O("label"),m||(s=N("Label")),m&&m.c(),D(t,"type","checkbox"),D(t,"id",e.id),D(t,"name",e.name),t.__value=e.value,t.value=t.__value,t.disabled=e.disabled,D(i,"for",e.id),D(n,"class","checkbox"),R(n,"has-focus",e.hasFocus),R(n,"is-disabled",e.disabled),d=[C(t,"change",e.input_change_handler),C(t,"blur",e.blur_handler),C(t,"focus",e.focus_handler)]},l(e){m&&m.l(label_nodes)},m(o,d){x(o,n,d),w(n,t),t.checked=e.checked,e.input_binding(t),w(n,a),ve(u,n,null),w(n,r),w(n,i),m?m.m(i,null):w(i,s),c=!0},p(e,a){e.checked&&(t.checked=a.checked),c&&!e.id||D(t,"id",a.id),c&&!e.name||D(t,"name",a.name),c&&!e.value||(t.__value=a.value),t.value=t.__value,c&&!e.disabled||(t.disabled=a.disabled);var r={};e.icon&&(r.name=a.icon),u.$set(r),m&&m.p&&e.$$scope&&m.p(p(g,a,e,na),f(g,a,ta)),c&&!e.id||D(i,"for",a.id),e.hasFocus&&R(n,"has-focus",a.hasFocus),e.disabled&&R(n,"is-disabled",a.disabled)},i(e){c||(fe(u.$$.fragment,e),fe(m,e),c=!0)},o(e){pe(u.$$.fragment,e),pe(m,e),c=!1},d(t){t&&k(n),e.input_binding(null),be(u),m&&m.d(t),o(d)}}}function ra(e,n,t){let a,{checked:r=!1,disabled:o=!1,name:i="",id:s=(i?"form_"+i:en()),value:c=1}=n,d=!1,{$$slots:u={},$$scope:l}=n;let f;return e.$set=e=>{"checked"in e&&t("checked",r=e.checked),"disabled"in e&&t("disabled",o=e.disabled),"name"in e&&t("name",i=e.name),"id"in e&&t("id",s=e.id),"value"in e&&t("value",c=e.value),"$$scope"in e&&t("$$scope",l=e.$$scope)},e.$$.update=(e={inputEl:1,checked:1})=>{e.inputEl&&a&&!a.syncValue&&(t("inputEl",a.syncValue=function(){t("checked",[r,c]=[this.checked,this.value],r,t("value",c),t("inputEl",a))},a),a.syncValue()),e.checked&&t("icon",f=r?"check-square":"square")},{checked:r,disabled:o,name:i,id:s,value:c,inputEl:a,hasFocus:d,icon:f,input_change_handler:function(){r=this.checked,t("checked",r),t("inputEl",a)},input_binding:function(e){Y[e?"unshift":"push"](()=>{t("inputEl",a=e)})},blur_handler:()=>{t("hasFocus",d=!1)},focus_handler:()=>{t("hasFocus",d=!0)},click_handler:()=>{o||t("checked",r=!r)},$$slots:u,$$scope:l}}class oa extends _e{constructor(e){super(),ye(this,e,ra,aa,s,["checked","disabled","name","id","value"])}}function ia(e){var n,t,a=Tn(e.$op.error())+"";return{c(){n=O("div"),t=N(a),D(n,"class","error")},m(e,a){x(e,n,a),w(n,t)},p(e,n){e.$op&&a!==(a=Tn(n.$op.error())+"")&&T(t,a)},d(e){e&&k(n)}}}function sa(n){var t,a=n.$op.is("error"),r=a&&ia(n);return{c(){r&&r.c(),t=A()},m(e,n){r&&r.m(e,n),x(e,t,n)},p(e,n){e.$op&&(a=n.$op.is("error")),a?r?r.p(e,n):((r=ia(n)).c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null)},i:e,o:e,d(e){r&&r.d(e),e&&k(t)}}}function ca(e,n,t){let a,{op:r=new tn({})}=n;return u(e,r,e=>{t("$op",a=e)}),e.$set=e=>{"op"in e&&t("op",r=e.op)},{op:r,$op:a}}class da extends _e{constructor(e){super(),ye(this,e,ca,sa,s,["op"])}}const ua=()=>({}),la=()=>({});function fa(e){var n,t,a,r,o,i,s;const c=e.$$slots.label,d=l(c,e,la);return{c(){n=O("div"),t=O("label"),d||(a=N("Label")),d&&d.c(),r=S(),o=O("input"),D(t,"for",e.id),D(o,"type","password"),D(o,"name",e.name),D(o,"id",e.id),D(o,"placeholder",e.placeholder),D(n,"class","text-field has-password"),n.hidden=e.hidden,s=C(o,"input",e.input_input_handler)},l(e){d&&d.l(label_nodes)},m(s,c){x(s,n,c),w(n,t),d?d.m(t,null):w(t,a),w(n,r),w(n,o),P(o,e.value),i=!0},p(e,a){d&&d.p&&e.$$scope&&d.p(p(c,a,e,ua),f(c,a,la)),i&&!e.id||D(t,"for",a.id),e.value&&o.value!==a.value&&P(o,a.value),i&&!e.name||D(o,"name",a.name),i&&!e.id||D(o,"id",a.id),i&&!e.placeholder||D(o,"placeholder",a.placeholder),i&&!e.hidden||(n.hidden=a.hidden)},i(e){i||(fe(d,e),i=!0)},o(e){pe(d,e),i=!1},d(e){e&&k(n),d&&d.d(e),s()}}}function pa(e,n,t){let{hidden:a=!1,name:r="",id:o=(r?"form_"+r:en()),placeholder:i="",value:s=""}=n,{$$slots:c={},$$scope:d}=n;return e.$set=e=>{"hidden"in e&&t("hidden",a=e.hidden),"name"in e&&t("name",r=e.name),"id"in e&&t("id",o=e.id),"placeholder"in e&&t("placeholder",i=e.placeholder),"value"in e&&t("value",s=e.value),"$$scope"in e&&t("$$scope",d=e.$$scope)},{hidden:a,name:r,id:o,placeholder:i,value:s,input_input_handler:function(){s=this.value,t("value",s)},$$slots:c,$$scope:d}}class ga extends _e{constructor(e){super(),ye(this,e,pa,fa,s,["hidden","name","id","placeholder","value"])}}function ma(e){var n,t,a,r,o=Tn(e.dialog.dialog_id?"Conversation":"Connection")+"",i=new $t({props:{name:"times-circle"}});return{c(){n=O("h2"),t=N(o),a=S(),i.$$.fragment.c()},m(e,o){x(e,n,o),w(n,t),x(e,a,o),ve(i,e,o),r=!0},p(e,n){r&&!e.dialog||o===(o=Tn(n.dialog.dialog_id?"Conversation":"Connection")+"")||T(t,o)},i(e){r||(fe(i.$$.fragment,e),r=!0)},o(e){pe(i.$$.fragment,e),r=!1},d(e){e&&(k(n),k(a)),be(i,e)}}}function ha(e){var n;let t={href:e.dialog.path,class:"sidebar__header for-settings",$$slots:{default:[ma]},$$scope:{ctx:e}};var a=new Ct({props:t});return e.link_binding(a),{c(){a.$$.fragment.c()},m(e,t){ve(a,e,t),n=!0},p(e,n){var t={};e.dialog&&(t.href=n.dialog.path),(e.$$scope||e.dialog)&&(t.$$scope={changed:e,ctx:n}),a.$set(t)},i(e){n||(fe(a.$$.fragment,e),n=!0)},o(e){pe(a.$$.fragment,e),n=!1},d(n){e.link_binding(null),be(a,n)}}}function $a(e,n,t){let a,{dialog:r={}}=n;return e.$set=e=>{"dialog"in e&&t("dialog",r=e.dialog)},e.$$.update=(e={linkEl:1})=>{e.linkEl&&a&&a.focus()},{dialog:r,linkEl:a,link_binding:function(e){Y[e?"unshift":"push"](()=>{t("linkEl",a=e)})}}}class va extends _e{constructor(e){super(),ye(this,e,$a,ha,s,["dialog"])}}const ba=()=>({}),ya=()=>({});function _a(e){var n,t,a,r,o,i,s;const c=e.$$slots.label,d=l(c,e,ya);return{c(){n=O("div"),t=O("label"),d||(a=N("Label")),d&&d.c(),r=S(),o=O("textarea"),D(t,"for",e.id),D(o,"name",e.name),D(o,"placeholder",e.placeholder),D(o,"id",e.id),o.readOnly=e.readonly,D(n,"class","text-area"),n.hidden=e.hidden,s=C(o,"input",e.textarea_input_handler)},l(e){d&&d.l(label_nodes)},m(s,c){x(s,n,c),w(n,t),d?d.m(t,null):w(t,a),w(n,r),w(n,o),P(o,e.value),e.textarea_binding(o),i=!0},p(e,a){d&&d.p&&e.$$scope&&d.p(p(c,a,e,ba),f(c,a,ya)),i&&!e.id||D(t,"for",a.id),e.value&&P(o,a.value),i&&!e.name||D(o,"name",a.name),i&&!e.placeholder||D(o,"placeholder",a.placeholder),i&&!e.id||D(o,"id",a.id),i&&!e.readonly||(o.readOnly=a.readonly),i&&!e.hidden||(n.hidden=a.hidden)},i(e){i||(fe(d,e),i=!0)},o(e){pe(d,e),i=!1},d(t){t&&k(n),d&&d.d(t),e.textarea_binding(null),s()}}}function wa(e,n,t){let a,{hidden:r=!1,name:o="",id:i=(o?"form_"+o:en()),placeholder:s="",readonly:c=!1,value:d=""}=n,{$$slots:u={},$$scope:l}=n;return e.$set=e=>{"hidden"in e&&t("hidden",r=e.hidden),"name"in e&&t("name",o=e.name),"id"in e&&t("id",i=e.id),"placeholder"in e&&t("placeholder",s=e.placeholder),"readonly"in e&&t("readonly",c=e.readonly),"value"in e&&t("value",d=e.value),"$$scope"in e&&t("$$scope",l=e.$$scope)},e.$$.update=(e={inputEl:1})=>{e.inputEl&&a&&!a.syncValue&&(t("inputEl",a.syncValue=function(){t("value",d=this.value)},a),a.syncValue())},{inputEl:a,hidden:r,name:o,id:i,placeholder:s,readonly:c,value:d,textarea_input_handler:function(){d=this.value,t("value",d),t("inputEl",a)},textarea_binding:function(e){Y[e?"unshift":"push"](()=>{t("inputEl",a=e)})},$$slots:u,$$scope:l}}class xa extends _e{constructor(e){super(),ye(this,e,wa,_a,s,["hidden","name","id","placeholder","readonly","value"])}}const ka=()=>({}),Ea=()=>({});function Oa(e){var n,t,a,r,i,s,c;const d=e.$$slots.label,u=l(d,e,Ea);return{c(){n=O("div"),t=O("label"),u||(a=N("Label")),u&&u.c(),r=S(),i=O("input"),D(t,"for",e.id),D(i,"type","text"),D(i,"autocomplete",e.autocomplete),D(i,"name",e.name),D(i,"placeholder",e.placeholder),D(i,"id",e.id),i.readOnly=e.readonly,D(n,"class","text-field"),n.hidden=e.hidden,c=[C(i,"input",e.input_input_handler),C(i,"keyup",e.keyup_handler)]},l(e){u&&u.l(label_nodes)},m(o,c){x(o,n,c),w(n,t),u?u.m(t,null):w(t,a),w(n,r),w(n,i),P(i,e.value),e.input_binding(i),s=!0},p(e,a){u&&u.p&&e.$$scope&&u.p(p(d,a,e,ka),f(d,a,Ea)),s&&!e.id||D(t,"for",a.id),e.value&&i.value!==a.value&&P(i,a.value),s&&!e.autocomplete||D(i,"autocomplete",a.autocomplete),s&&!e.name||D(i,"name",a.name),s&&!e.placeholder||D(i,"placeholder",a.placeholder),s&&!e.id||D(i,"id",a.id),s&&!e.readonly||(i.readOnly=a.readonly),s&&!e.hidden||(n.hidden=a.hidden)},i(e){s||(fe(u,e),s=!0)},o(e){pe(u,e),s=!1},d(t){t&&k(n),u&&u.d(t),e.input_binding(null),o(c)}}}function Na(e,n,t){let a,{autocomplete:r=null,hidden:o=!1,name:i="",id:s=(i?"form_"+i:en()),placeholder:c="",readonly:d=!1,value:u=""}=n,{$$slots:l={},$$scope:f}=n;return e.$set=e=>{"autocomplete"in e&&t("autocomplete",r=e.autocomplete),"hidden"in e&&t("hidden",o=e.hidden),"name"in e&&t("name",i=e.name),"id"in e&&t("id",s=e.id),"placeholder"in e&&t("placeholder",c=e.placeholder),"readonly"in e&&t("readonly",d=e.readonly),"value"in e&&t("value",u=e.value),"$$scope"in e&&t("$$scope",f=e.$$scope)},e.$$.update=(e={inputEl:1})=>{e.inputEl&&a&&!a.syncValue&&(t("inputEl",a.syncValue=function(){t("value",u=this.value)},a),a.syncValue())},{inputEl:a,autocomplete:r,hidden:o,name:i,id:s,placeholder:c,readonly:d,value:u,keyup_handler:function(n){Z(e,n)},input_input_handler:function(){u=this.value,t("value",u),t("inputEl",a)},input_binding:function(e){Y[e?"unshift":"push"](()=>{t("inputEl",a=e)})},$$slots:l,$$scope:f}}class Sa extends _e{constructor(e){super(),ye(this,e,Na,Oa,s,["autocomplete","hidden","name","id","placeholder","readonly","value"])}}function Aa(e){var n,t;return{c(){D(n=O("input"),"type","hidden"),D(n,"name","connection_id"),n.value=t=e.connection.connection_id},m(e,t){x(e,n,t)},p(e,a){e.connection&&t!==(t=a.connection.connection_id)&&(n.value=t)},d(e){e&&k(n)}}}function Ca(n){var t,a,r=Tn("Host and port")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function Ma(n){return{c:e,m:e,p:e,d:e}}function Da(n){var t,a,r=Tn("Nickname")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function Ta(n){return{c:e,m:e,p:e,d:e}}function Pa(e){var n,t;function a(t){e.checkbox_checked_binding.call(null,t),n=!0,re(()=>n=!1)}let r={$$slots:{default:[Ra],label:[La]},$$scope:{ctx:e}};void 0!==e.wantToBeConnected&&(r.checked=e.wantToBeConnected);var o=new oa({props:r});return Y.push(()=>$e(o,"checked",a)),{c(){o.$$.fragment.c()},m(e,n){ve(o,e,n),t=!0},p(e,t){var a={};e.$$scope&&(a.$$scope={changed:e,ctx:t}),!n&&e.wantToBeConnected&&(a.checked=t.wantToBeConnected),o.$set(a)},i(e){t||(fe(o.$$.fragment,e),t=!0)},o(e){pe(o.$$.fragment,e),t=!1},d(e){be(o,e)}}}function La(n){var t,a,r=Tn("Want to be connected")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function Ra(n){return{c:e,m:e,p:e,d:e}}function ja(n){var t,a,r=Tn("Secure connection (TLS)")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function Ia(n){return{c:e,m:e,p:e,d:e}}function Ua(e){var n,t;function a(t){e.checkbox_checked_binding_1.call(null,t),n=!0,re(()=>n=!1)}let r={name:"tls_verify",$$slots:{default:[Ha],label:[Ba]},$$scope:{ctx:e}};void 0!==e.verifyTls&&(r.checked=e.verifyTls);var o=new oa({props:r});return Y.push(()=>$e(o,"checked",a)),{c(){o.$$.fragment.c()},m(e,n){ve(o,e,n),t=!0},p(e,t){var a={};e.$$scope&&(a.$$scope={changed:e,ctx:t}),!n&&e.verifyTls&&(a.checked=t.verifyTls),o.$set(a)},i(e){t||(fe(o.$$.fragment,e),t=!0)},o(e){pe(o.$$.fragment,e),t=!1},d(e){be(o,e)}}}function Ba(n){var t,a,r=Tn("Verify certificate (TLS)")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function Ha(n){return{c:e,m:e,p:e,d:e}}function za(n){var t,a,r=Tn("Show advanced settings")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function qa(n){return{c:e,m:e,p:e,d:e}}function Fa(n){var t,a,r=Tn("Username")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function Ka(n){return{c:e,m:e,p:e,d:e}}function Ga(n){var t,a,r=Tn("Password")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function Wa(n){return{c:e,m:e,p:e,d:e}}function Za(n){var t,a,r=Tn("On-connect commands")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function Va(n){return{c:e,m:e,p:e,d:e}}function Ya(e){var n,t=new ea({props:{icon:"save",op:e.createConnectionOp,$$slots:{default:[Qa]},$$scope:{ctx:e}}});return{c(){t.$$.fragment.c()},m(e,a){ve(t,e,a),n=!0},p(e,n){var a={};e.$$scope&&(a.$$scope={changed:e,ctx:n}),t.$set(a)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){be(t,e)}}}function Ja(e){var n,t,a=new ea({props:{icon:"save",op:e.updateConnectionOp,$$slots:{default:[Xa]},$$scope:{ctx:e}}}),r=new ea({props:{icon:"trash",type:"button",op:e.removeConnectionOp,$$slots:{default:[er]},$$scope:{ctx:e}}});return r.$on("click",e.removeConnection),{c(){a.$$.fragment.c(),n=S(),r.$$.fragment.c()},m(e,o){ve(a,e,o),x(e,n,o),ve(r,e,o),t=!0},p(e,n){var t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),a.$set(t);var o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),r.$set(o)},i(e){t||(fe(a.$$.fragment,e),fe(r.$$.fragment,e),t=!0)},o(e){pe(a.$$.fragment,e),pe(r.$$.fragment,e),t=!1},d(e){be(a,e),e&&k(n),be(r,e)}}}function Qa(n){var t,a=Tn("Create")+"";return{c(){t=N(a)},m(e,n){x(e,t,n)},p:e,d(e){e&&k(t)}}}function Xa(n){var t,a=Tn("Update")+"";return{c(){t=N(a)},m(e,n){x(e,t,n)},p:e,d(e){e&&k(t)}}}function er(n){var t,a=Tn("Delete")+"";return{c(){t=N(a)},m(e,n){x(e,t,n)},p:e,d(e){e&&k(t)}}}function nr(n){var t,a,r,o,i,s,c,d,u,l,f,p,g,m,h,$,v,b,y,_,E,N,A,T,P,L,R=n.connection.connection_id&&Aa(n),j=new Sa({props:{name:"server",placeholder:Tn("Ex: chat.freenode.net:6697"),readonly:n.settings.forced_connection,$$slots:{default:[Ma],label:[Ca]},$$scope:{ctx:n}}}),I=n.settings.forced_connection&&function(n){var t,a=Pn("Connection is locked by %1.",n.settings.contact)+"";return{c(){t=O("p")},m(e,n){x(e,t,n),t.innerHTML=a},p:e,d(e){e&&k(t)}}}(n),U=new Sa({props:{name:"nick",placeholder:Tn("Ex: your-name"),$$slots:{default:[Ta],label:[Da]},$$scope:{ctx:n}}}),B=n.connection.url&&Pa(n);function H(e){n.checkbox0_checked_binding.call(null,e),f=!0,re(()=>f=!1)}let z={name:"tls",$$slots:{default:[Ia],label:[ja]},$$scope:{ctx:n}};void 0!==n.useTls&&(z.checked=n.useTls);var q=new oa({props:z});Y.push(()=>$e(q,"checked",H));var F=n.useTls&&Ua(n);function K(e){n.checkbox1_checked_binding.call(null,e),m=!0,re(()=>m=!1)}let G={$$slots:{default:[qa],label:[za]},$$scope:{ctx:n}};void 0!==n.showAdvancedSettings&&(G.checked=n.showAdvancedSettings);var W=new oa({props:G});Y.push(()=>$e(W,"checked",K));var Z=new Sa({props:{name:"username",hidden:!n.showAdvancedSettings,$$slots:{default:[Ka],label:[Fa]},$$scope:{ctx:n}}}),V=new ga({props:{name:"password",hidden:!n.showAdvancedSettings,$$slots:{default:[Wa],label:[Ga]},$$scope:{ctx:n}}}),J=new xa({props:{name:"on_connect_commands",hidden:!n.showAdvancedSettings,$$slots:{default:[Va],label:[Za]},$$scope:{ctx:n}}}),Q=[Ja,Ya],X=[];function ee(e,n){return n.connection.url?0:1}_=ee(0,n),E=X[_]=Q[_](n);var ne=new da({props:{op:n.createConnectionOp}}),te=new da({props:{op:n.removeConnectionOp}}),ae=new da({props:{op:n.updateConnectionOp}});return{c(){t=O("form"),R&&R.c(),a=S(),r=O("input"),o=S(),i=O("input"),s=S(),j.$$.fragment.c(),c=S(),I&&I.c(),d=S(),U.$$.fragment.c(),u=S(),B&&B.c(),l=S(),q.$$.fragment.c(),p=S(),F&&F.c(),g=S(),W.$$.fragment.c(),h=S(),Z.$$.fragment.c(),$=S(),V.$$.fragment.c(),v=S(),J.$$.fragment.c(),b=S(),y=O("div"),E.c(),N=S(),ne.$$.fragment.c(),A=S(),te.$$.fragment.c(),T=S(),ae.$$.fragment.c(),D(r,"type","hidden"),D(r,"name","url"),D(i,"type","hidden"),D(i,"name","wanted_state"),D(y,"class","form-actions"),D(t,"method","post"),L=C(t,"submit",M(n.submitForm))},m(e,f){x(e,t,f),R&&R.m(t,null),w(t,a),w(t,r),w(t,o),w(t,i),w(t,s),ve(j,t,null),w(t,c),I&&I.m(t,null),w(t,d),ve(U,t,null),w(t,u),B&&B.m(t,null),w(t,l),ve(q,t,null),w(t,p),F&&F.m(t,null),w(t,g),ve(W,t,null),w(t,h),ve(Z,t,null),w(t,$),ve(V,t,null),w(t,v),ve(J,t,null),w(t,b),w(t,y),X[_].m(y,null),w(t,N),ve(ne,t,null),w(t,A),ve(te,t,null),w(t,T),ve(ae,t,null),n.form_binding(t),P=!0},p(e,n){n.connection.connection_id?R?R.p(e,n):((R=Aa(n)).c(),R.m(t,a)):R&&(R.d(1),R=null);var r={};e.$$scope&&(r.$$scope={changed:e,ctx:n}),j.$set(r),n.settings.forced_connection&&I.p(e,n);var o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),U.$set(o),n.connection.url?B?(B.p(e,n),fe(B,1)):((B=Pa(n)).c(),fe(B,1),B.m(t,l)):B&&(ue(),pe(B,1,1,()=>{B=null}),le());var i={};e.$$scope&&(i.$$scope={changed:e,ctx:n}),!f&&e.useTls&&(i.checked=n.useTls),q.$set(i),n.useTls?F?(F.p(e,n),fe(F,1)):((F=Ua(n)).c(),fe(F,1),F.m(t,g)):F&&(ue(),pe(F,1,1,()=>{F=null}),le());var s={};e.$$scope&&(s.$$scope={changed:e,ctx:n}),!m&&e.showAdvancedSettings&&(s.checked=n.showAdvancedSettings),W.$set(s);var c={};e.showAdvancedSettings&&(c.hidden=!n.showAdvancedSettings),e.$$scope&&(c.$$scope={changed:e,ctx:n}),Z.$set(c);var d={};e.showAdvancedSettings&&(d.hidden=!n.showAdvancedSettings),e.$$scope&&(d.$$scope={changed:e,ctx:n}),V.$set(d);var u={};e.showAdvancedSettings&&(u.hidden=!n.showAdvancedSettings),e.$$scope&&(u.$$scope={changed:e,ctx:n}),J.$set(u);var p=_;(_=ee(0,n))===p?X[_].p(e,n):(ue(),pe(X[p],1,1,()=>{X[p]=null}),le(),(E=X[_])||(E=X[_]=Q[_](n)).c(),fe(E,1),E.m(y,null))},i(e){P||(fe(j.$$.fragment,e),fe(U.$$.fragment,e),fe(B),fe(q.$$.fragment,e),fe(F),fe(W.$$.fragment,e),fe(Z.$$.fragment,e),fe(V.$$.fragment,e),fe(J.$$.fragment,e),fe(E),fe(ne.$$.fragment,e),fe(te.$$.fragment,e),fe(ae.$$.fragment,e),P=!0)},o(e){pe(j.$$.fragment,e),pe(U.$$.fragment,e),pe(B),pe(q.$$.fragment,e),pe(F),pe(W.$$.fragment,e),pe(Z.$$.fragment,e),pe(V.$$.fragment,e),pe(J.$$.fragment,e),pe(E),pe(ne.$$.fragment,e),pe(te.$$.fragment,e),pe(ae.$$.fragment,e),P=!1},d(e){e&&k(t),R&&R.d(),be(j),I&&I.d(),be(U),B&&B.d(),be(q),F&&F.d(),be(W),be(Z),be(V),be(J),X[_].d(),be(ne),be(te),be(ae),n.form_binding(null),L()}}}function tr(e,n,t){let{dialog:a={}}=n;const r=W("settings"),o=W("user"),i=o.api.operation("createConnection"),s=o.api.operation("removeConnection"),c=o.api.operation("updateConnection");[i,c].forEach(e=>{e.on("start",e=>{e.body.on_connect_commands=e.body.on_connect_commands.split("\n").map(e=>e.trim())})});let d,u={},l=!1,f=!1,p=!1,g=!1;function m(){u.url&&(t("formEl",d.server.value=u.url.host,d),t("formEl",d.nick.value=u.url.searchParams.get("nick")||"",d),t("formEl",d.on_connect_commands.value=u.on_connect_commands.join("\n"),d),t("formEl",d.password.value=u.url.password,d),t("formEl",d.username.value=u.url.username,d),t("formEl",d.url.value=u.url.toString(),d),t("useTls",f="1"==u.url.searchParams.get("tls")),t("verifyTls",p="1"==u.url.searchParams.get("tls_verify")),t("wantToBeConnected",g="connected"==u.wanted_state))}return K(async()=>{if(await o.load(),d)return t("connection",u=o.findDialog({connection_id:a.connection_id})||{}),u.url?m():function(){r.forced_connection&&t("formEl",d.server.value=r.default_connection,d);t("formEl",d.nick.value=o.email.replace(/@.*/,"").replace(/\W/g,"_"),d),t("useTls",f=!0),t("wantToBeConnected",g=!0),st(d)}()}),e.$set=e=>{"dialog"in e&&t("dialog",a=e.dialog)},e.$$.update=(e={formEl:1,wantToBeConnected:1})=>{(e.formEl||e.wantToBeConnected)&&d&&t("formEl",d.wanted_state.value=g?"connected":"disconnected",d)},{dialog:a,settings:r,createConnectionOp:i,removeConnectionOp:s,updateConnectionOp:c,connection:u,formEl:d,showAdvancedSettings:l,useTls:f,verifyTls:p,wantToBeConnected:g,removeConnection:async function(e){await s.perform(u),o.removeDialog(u),ot("/chat")},submitForm:async function(e){if(d.server.value)if(t("formEl",d.url.value=new ln("irc://localhost:6667").fromForm(e.target).toString(),d),u.connection_id)await c.perform(e.target),o.ensureDialog(c.res.body),m();else{await i.perform(e.target),ot(o.ensureDialog(i.res.body).path)}},checkbox_checked_binding:function(e){t("wantToBeConnected",g=e)},checkbox0_checked_binding:function(e){t("useTls",f=e)},checkbox_checked_binding_1:function(e){t("verifyTls",p=e)},checkbox1_checked_binding:function(e){t("showAdvancedSettings",l=e)},form_binding:function(e){Y[e?"unshift":"push"](()=>{t("formEl",d=e)})}}}class ar extends _e{constructor(e){super(),ye(this,e,tr,nr,s,["dialog"])}}function rr(e){var n,t,a=Tn("Currently connecting to %1.",e.connectionHost)+"";return{c(){n=O("p"),t=N(a)},m(e,a){x(e,n,a),w(n,t)},p(e,n){e.connectionHost&&a!==(a=Tn("Currently connecting to %1.",n.connectionHost)+"")&&T(t,a)},d(e){e&&k(n)}}}function or(e){var n,t,a=Tn("Currently connected to %1.",e.connectionHost)+"";return{c(){n=O("p"),t=N(a)},m(e,a){x(e,n,a),w(n,t)},p(e,n){e.connectionHost&&a!==(a=Tn("Currently connected to %1.",n.connectionHost)+"")&&T(t,a)},d(e){e&&k(n)}}}function ir(e){var n,t,a=Tn("Currently disconnected from %1.",e.connectionHost)+"";return{c(){n=O("p"),t=N(a)},m(e,a){x(e,n,a),w(n,t)},p(e,n){e.connectionHost&&a!==(a=Tn("Currently disconnected from %1.",n.connectionHost)+"")&&T(t,a)},d(e){e&&k(n)}}}function sr(n){var t,a,r=Tn("Connection not found.")+"";return{c(){t=O("p"),a=N(r)},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function cr(e){var n,t,a,r,o,i=new va({props:{dialog:e.dialog}});function s(e,n){return n.connection.url?"disconnected"==n.connection.state?ir:"connected"==n.connection.state?or:rr:sr}var c=s(0,e),d=c(e),u=new ar({props:{dialog:e.dialog}});return{c(){n=O("div"),i.$$.fragment.c(),t=S(),d.c(),a=S(),u.$$.fragment.c(),D(n,"class","sidebar-left")},m(e,r){x(e,n,r),ve(i,n,null),w(n,t),d.m(n,null),w(n,a),ve(u,n,null),o=!0},p(e,t){var r={};e.dialog&&(r.dialog=t.dialog),i.$set(r),c===(c=s(0,t))&&d?d.p(e,t):(d.d(1),(d=c(t))&&(d.c(),d.m(n,a)));var o={};e.dialog&&(o.dialog=t.dialog),u.$set(o)},i(t){o||(fe(i.$$.fragment,t),fe(u.$$.fragment,t),ae(()=>{r||(r=me(n,gt,e.flyTransitionParameters,!0)),r.run(1)}),o=!0)},o(t){pe(i.$$.fragment,t),pe(u.$$.fragment,t),r||(r=me(n,gt,e.flyTransitionParameters,!1)),r.run(0),o=!1},d(e){e&&k(n),be(i),d.d(),be(u),e&&r&&r.end()}}}function dr(e,n,t){let a;u(e,dt,e=>{t("$container",a=e)});let{dialog:r={}}=n;const o=W("user");let i,s,c={};return K(async()=>{await o.load(),t("connection",c=o.findDialog({connection_id:r.connection_id})||{})}),e.$set=e=>{"dialog"in e&&t("dialog",r=e.dialog)},e.$$.update=(e={connection:1,$container:1})=>{e.connection&&t("connectionHost",i=c.url&&c.url.host),e.$container&&t("flyTransitionParameters",s={duration:250,x:a.small?a.width:0})},{dialog:r,connection:c,connectionHost:i,flyTransitionParameters:s}}class ur extends _e{constructor(e){super(),ye(this,e,dr,cr,s,["dialog"])}}function lr(e,n,t){const a=Object.create(e);return a.participant=n[t],a}function fr(e){var n,t=Tn("You are not a channel operator in %1.",e.dialog.name)+"";return{c(){n=N(t)},m(e,t){x(e,n,t)},p(e,a){e.dialog&&t!==(t=Tn("You are not a channel operator in %1.",a.dialog.name)+"")&&T(n,t)},d(e){e&&k(n)}}}function pr(e){var n,t=Tn("You are a channel operator in %1.",e.dialog.name)+"";return{c(){n=N(t)},m(e,t){x(e,n,t)},p(e,a){e.dialog&&t!==(t=Tn("You are a channel operator in %1.",a.dialog.name)+"")&&T(n,t)},d(e){e&&k(n)}}}function gr(e){var n,t=Tn("Private conversation with %1.",e.dialog.name)+"";return{c(){n=N(t)},m(e,t){x(e,n,t)},p(e,a){e.dialog&&t!==(t=Tn("Private conversation with %1.",a.dialog.name)+"")&&T(n,t)},d(e){e&&k(n)}}}function mr(e){var n,t,a,r,o,i,s,c=new xa({props:{name:"topic",placeholder:Tn("No topic is set."),readonly:!e.isOperator,$$slots:{default:[$r],label:[hr]},$$scope:{ctx:e}}});return{c(){n=O("input"),a=S(),r=O("input"),i=S(),c.$$.fragment.c(),D(n,"type","hidden"),D(n,"name","connection_id"),n.value=t=e.dialog.connection_id,D(r,"type","hidden"),D(r,"name","dialog_id"),r.value=o=e.dialog.dialog_id},m(e,t){x(e,n,t),x(e,a,t),x(e,r,t),x(e,i,t),ve(c,e,t),s=!0},p(e,a){s&&!e.dialog||t===(t=a.dialog.connection_id)||(n.value=t),s&&!e.dialog||o===(o=a.dialog.dialog_id)||(r.value=o);var i={};e.isOperator&&(i.readonly=!a.isOperator),e.$$scope&&(i.$$scope={changed:e,ctx:a}),c.$set(i)},i(e){s||(fe(c.$$.fragment,e),s=!0)},o(e){pe(c.$$.fragment,e),s=!1},d(e){e&&(k(n),k(a),k(r),k(i)),be(c,e)}}}function hr(n){var t,a,r=Tn("Topic")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function $r(n){return{c:e,m:e,p:e,d:e}}function vr(e){var n,t=new ea({props:{icon:"save",disabled:!e.isOperator,$$slots:{default:[br]},$$scope:{ctx:e}}});return{c(){t.$$.fragment.c()},m(e,a){ve(t,e,a),n=!0},p(e,n){var a={};e.isOperator&&(a.disabled=!n.isOperator),e.$$scope&&(a.$$scope={changed:e,ctx:n}),t.$set(a)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){be(t,e)}}}function br(n){var t,a=Tn("Update")+"";return{c(){t=N(a)},m(e,n){x(e,t,n)},p:e,d(e){e&&k(t)}}}function yr(n){var t,a=Tn("Part")+"";return{c(){t=N(a)},m(e,n){x(e,t,n)},p:e,d(e){e&&k(t)}}}function _r(e){var n,t,a,r=e.participant.nick+"";return{c(){n=O("span"),t=N(r),a=S()},m(e,r){x(e,n,r),w(n,t),x(e,a,r)},p(e,n){e.dialog&&r!==(r=n.participant.nick+"")&&T(t,r)},d(e){e&&(k(n),k(a))}}}function wr(e){var n,t=new Ct({props:{href:"/chat/"+e.dialog.connection_id+"/"+e.participant.id,class:"participant "+qe(e.participant.mode),$$slots:{default:[_r]},$$scope:{ctx:e}}});return{c(){t.$$.fragment.c()},m(e,a){ve(t,e,a),n=!0},p(e,n){var a={};e.dialog&&(a.href="/chat/"+n.dialog.connection_id+"/"+n.participant.id),e.dialog&&(a.class="participant "+qe(n.participant.mode)),(e.$$scope||e.dialog)&&(a.$$scope={changed:e,ctx:n}),t.$set(a)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){be(t,e)}}}function xr(e){var n,t,a,r,o,i,s,c,d,u,l,f,p,g,m,h,$,v=!e.dialog.is("private"),b=!e.dialog.is("private"),y=Tn("Participants (%1)",e.dialog.participants.size)+"",_=new va({props:{dialog:e.dialog}});function A(e,n){return(null==r||e.dialog)&&(r=!!n.dialog.is("private")),r?gr:n.isOperator?pr:fr}var P=A(null,e),L=P(e),R=v&&mr(e),j=b&&vr(e),I=new ea({props:{type:"button",icon:"sign-out-alt",$$slots:{default:[yr]},$$scope:{ctx:e}}});I.$on("click",e.partDialog);let U=e.dialog.participants.toArray(),B=[];for(let n=0;n<U.length;n+=1)B[n]=wr(lr(e,U,n));const H=e=>pe(B[e],1,1,()=>{B[e]=null});return{c(){n=O("div"),_.$$.fragment.c(),t=S(),a=O("p"),L.c(),o=S(),i=O("form"),R&&R.c(),s=S(),c=O("div"),j&&j.c(),d=S(),I.$$.fragment.c(),u=S(),l=O("nav"),f=O("h3"),p=N(y),g=S();for(let e=0;e<B.length;e+=1)B[e].c();D(c,"class","form-actions"),D(i,"method","post"),D(l,"class","sidebar-left__nav"),D(n,"class","sidebar-left"),$=C(i,"submit",M(e.updateDialogFromForm))},m(r,m){x(r,n,m),ve(_,n,null),w(n,t),w(n,a),L.m(a,null),w(n,o),w(n,i),R&&R.m(i,null),w(i,s),w(i,c),j&&j.m(c,null),w(c,d),ve(I,c,null),e.form_binding(i),w(n,u),w(n,l),w(l,f),w(f,p),w(l,g);for(let e=0;e<B.length;e+=1)B[e].m(l,null);h=!0},p(e,n){var t={};e.dialog&&(t.dialog=n.dialog),_.$set(t),P===(P=A(e,n))&&L?L.p(e,n):(L.d(1),(L=P(n))&&(L.c(),L.m(a,null))),e.dialog&&(v=!n.dialog.is("private")),v?R?(R.p(e,n),fe(R,1)):((R=mr(n)).c(),fe(R,1),R.m(i,s)):R&&(ue(),pe(R,1,1,()=>{R=null}),le()),e.dialog&&(b=!n.dialog.is("private")),b?j?(j.p(e,n),fe(j,1)):((j=vr(n)).c(),fe(j,1),j.m(c,d)):j&&(ue(),pe(j,1,1,()=>{j=null}),le());var r={};if(e.$$scope&&(r.$$scope={changed:e,ctx:n}),I.$set(r),h&&!e.dialog||y===(y=Tn("Participants (%1)",n.dialog.participants.size)+"")||T(p,y),e.dialog||e.modeClassNames){let t;for(U=n.dialog.participants.toArray(),t=0;t<U.length;t+=1){const a=lr(n,U,t);B[t]?(B[t].p(e,a),fe(B[t],1)):(B[t]=wr(a),B[t].c(),fe(B[t],1),B[t].m(l,null))}for(ue(),t=U.length;t<B.length;t+=1)H(t);le()}},i(t){if(!h){fe(_.$$.fragment,t),fe(R),fe(j),fe(I.$$.fragment,t);for(let e=0;e<U.length;e+=1)fe(B[e]);ae(()=>{m||(m=me(n,gt,e.flyTransitionParameters,!0)),m.run(1)}),h=!0}},o(t){pe(_.$$.fragment,t),pe(R),pe(j),pe(I.$$.fragment,t),B=B.filter(Boolean);for(let e=0;e<B.length;e+=1)pe(B[e]);m||(m=me(n,gt,e.flyTransitionParameters,!1)),m.run(0),h=!1},d(t){t&&k(n),be(_),L.d(),R&&R.d(),j&&j.d(),be(I),e.form_binding(null),E(B,t),t&&m&&m.end(),$()}}}function kr(e,n,t){let a;u(e,dt,e=>{t("$container",a=e)});let{dialog:r={}}=n;const o=W("user");let i,s,c;return e.$set=e=>{"dialog"in e&&t("dialog",r=e.dialog)},e.$$.update=(e={dialog:1,$container:1,formEl:1})=>{e.dialog&&t("isOperator",s=function(e){const n=o.findDialog({connection_id:e.connection_id}),t=(n&&n.nick||"").toLowerCase(),a=e.participants.get(t);return a&&-1!=a.mode.indexOf("o")}(r)),e.$container&&t("flyTransitionParameters",c={duration:250,x:a.small?a.width:0}),(e.formEl||e.dialog)&&i&&i.topic&&t("formEl",i.topic.value=r.topic||"",i)},{dialog:r,formEl:i,partDialog:function(e){o.send({message:"/part",dialog:r})},updateDialogFromForm:function(e){o.send({message:"/topic "+i.topic.value,dialog:r})},isOperator:s,flyTransitionParameters:c,form_binding:function(e){Y[e?"unshift":"push"](()=>{t("formEl",i=e)})}}}class Er extends _e{constructor(e){super(),ye(this,e,kr,xr,s,["dialog"])}}function Or(e,n,t){const a=Object.create(e);return a.dialog=n[t],a}function Nr(e,n,t){const a=Object.create(e);return a.connection=n[t],a}function Sr(e){var n,t,a,r,i,s,c,d,u,l,f,p,g,m,h,$,v,b,y,_,A,M,L,j=Tn("Conversations")+"",I=e.$user.email||Tn("Account")+"",U=new $t({props:{name:"search"}});let B=e.$user.connections.toArray(),H=[];for(let n=0;n<B.length;n+=1)H[n]=Dr(Nr(e,B,n));const z=e=>pe(H[e],1,1,()=>{H[e]=null});var q=new Ct({props:{href:"/chat",$$slots:{default:[Tr]},$$scope:{ctx:e}}}),F=new Ct({props:{href:"/add/conversation",$$slots:{default:[Pr]},$$scope:{ctx:e}}}),K=new Ct({props:{href:"/add/connection",$$slots:{default:[Lr]},$$scope:{ctx:e}}}),G=new Ct({props:{href:"/settings",$$slots:{default:[Rr]},$$scope:{ctx:e}}}),W=new Ct({props:{href:"/help",$$slots:{default:[jr]},$$scope:{ctx:e}}}),Z=new Ct({props:{href:"/api/user/logout.html",native:!0,$$slots:{default:[Ir]},$$scope:{ctx:e}}});return{c(){n=O("div"),t=O("form"),a=O("input"),i=S(),s=O("label"),U.$$.fragment.c(),c=S(),d=O("nav"),u=O("h3"),l=N(j),f=S();for(let e=0;e<H.length;e+=1)H[e].c();p=S(),g=O("h3"),m=N(I),h=S(),q.$$.fragment.c(),$=S(),F.$$.fragment.c(),v=S(),K.$$.fragment.c(),b=S(),G.$$.fragment.c(),y=S(),W.$$.fragment.c(),_=S(),Z.$$.fragment.c(),D(a,"type","text"),D(a,"id","sidebar_left_search_input"),D(a,"placeholder",r=e.searchHasFocus?Tn("Search..."):Tn("Convos")),D(s,"for","sidebar_left_search_input"),D(t,"class","sidebar__header"),D(d,"class","sidebar-left__nav"),R(d,"is-filtering",e.filter.length>0),D(n,"class","sidebar-left"),L=[C(a,"input",e.input_input_handler),C(a,"blur",e.clearFilter),C(a,"focus",e.filterNav),C(a,"keydown",e.onSearchKeydown),C(t,"submit",zr),C(d,"click",e.onNavItemClicked)]},m(r,o){x(r,n,o),w(n,t),w(t,a),P(a,e.filter),w(t,i),w(t,s),ve(U,s,null),w(n,c),w(n,d),w(d,u),w(u,l),w(d,f);for(let e=0;e<H.length;e+=1)H[e].m(d,null);w(d,p),w(d,g),w(g,m),w(d,h),ve(q,d,null),w(d,$),ve(F,d,null),w(d,v),ve(K,d,null),w(d,b),ve(G,d,null),w(d,y),ve(W,d,null),w(d,_),ve(Z,d,null),e.nav_binding(d),M=!0},p(e,n){if(e.filter&&a.value!==n.filter&&P(a,n.filter),M&&!e.searchHasFocus||r===(r=n.searchHasFocus?Tn("Search..."):Tn("Convos"))||D(a,"placeholder",r),e.$user||e.dialogClassNames||e.topicOrStatus||e.renderUnread){let t;for(B=n.$user.connections.toArray(),t=0;t<B.length;t+=1){const a=Nr(n,B,t);H[t]?(H[t].p(e,a),fe(H[t],1)):(H[t]=Dr(a),H[t].c(),fe(H[t],1),H[t].m(d,p))}for(ue(),t=B.length;t<H.length;t+=1)z(t);le()}M&&!e.$user||I===(I=n.$user.email||Tn("Account")+"")||T(m,I);var t={};(e.$$scope||e.$notifications)&&(t.$$scope={changed:e,ctx:n}),q.$set(t);var o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),F.$set(o);var i={};e.$$scope&&(i.$$scope={changed:e,ctx:n}),K.$set(i);var s={};e.$$scope&&(s.$$scope={changed:e,ctx:n}),G.$set(s);var c={};e.$$scope&&(c.$$scope={changed:e,ctx:n}),W.$set(c);var u={};e.$$scope&&(u.$$scope={changed:e,ctx:n}),Z.$set(u),e.filter&&R(d,"is-filtering",n.filter.length>0)},i(t){if(!M){fe(U.$$.fragment,t);for(let e=0;e<B.length;e+=1)fe(H[e]);fe(q.$$.fragment,t),fe(F.$$.fragment,t),fe(K.$$.fragment,t),fe(G.$$.fragment,t),fe(W.$$.fragment,t),fe(Z.$$.fragment,t),ae(()=>{A||(A=me(n,gt,e.flyTransitionParameters,!0)),A.run(1)}),M=!0}},o(t){pe(U.$$.fragment,t),H=H.filter(Boolean);for(let e=0;e<H.length;e+=1)pe(H[e]);pe(q.$$.fragment,t),pe(F.$$.fragment,t),pe(K.$$.fragment,t),pe(G.$$.fragment,t),pe(W.$$.fragment,t),pe(Z.$$.fragment,t),A||(A=me(n,gt,e.flyTransitionParameters,!1)),A.run(0),M=!1},d(t){t&&k(n),be(U),E(H,t),be(q),be(F),be(K),be(G),be(W),be(Z),e.nav_binding(null),t&&A&&A.end(),o(L)}}}function Ar(e){var n,t,a,r,o,i,s,c,d=e.connection.connection_id+"",u=Hr(e.connection)+"",l=new $t({props:{name:"network-wired"}});return{c(){l.$$.fragment.c(),n=S(),t=O("span"),a=N(d),r=S(),o=O("b"),i=N(u),D(o,"class","unread"),o.hidden=s=!e.connection.unread},m(e,s){ve(l,e,s),x(e,n,s),x(e,t,s),w(t,a),x(e,r,s),x(e,o,s),w(o,i),c=!0},p(e,n){c&&!e.$user||d===(d=n.connection.connection_id+"")||T(a,d),c&&!e.$user||u===(u=Hr(n.connection)+"")||T(i,u),c&&!e.$user||s===(s=!n.connection.unread)||(o.hidden=s)},i(e){c||(fe(l.$$.fragment,e),c=!0)},o(e){pe(l.$$.fragment,e),c=!1},d(e){be(l,e),e&&(k(n),k(t),k(r),k(o))}}}function Cr(e){var n,t,a,r,o,i,s,c,d=e.dialog.name+"",u=Hr(e.dialog)+"",l=new $t({props:{name:e.dialog.is_private?"user":"user-friends"}});return{c(){l.$$.fragment.c(),n=S(),t=O("span"),a=N(d),r=S(),o=O("b"),i=N(u),D(o,"class","unread"),o.hidden=s=!e.dialog.unread},m(e,s){ve(l,e,s),x(e,n,s),x(e,t,s),w(t,a),x(e,r,s),x(e,o,s),w(o,i),c=!0},p(e,n){var t={};e.$user&&(t.name=n.dialog.is_private?"user":"user-friends"),l.$set(t),c&&!e.$user||d===(d=n.dialog.name+"")||T(a,d),c&&!e.$user||u===(u=Hr(n.dialog)+"")||T(i,u),c&&!e.$user||s===(s=!n.dialog.unread)||(o.hidden=s)},i(e){c||(fe(l.$$.fragment,e),c=!0)},o(e){pe(l.$$.fragment,e),c=!1},d(e){be(l,e),e&&(k(n),k(t),k(r),k(o))}}}function Mr(e){var n,t=new Ct({props:{href:e.dialog.path,class:Br(e.connection,e.dialog),title:Ln(e.connection,e.dialog),$$slots:{default:[Cr]},$$scope:{ctx:e}}});return{c(){t.$$.fragment.c()},m(e,a){ve(t,e,a),n=!0},p(e,n){var a={};e.$user&&(a.href=n.dialog.path),e.$user&&(a.class=Br(n.connection,n.dialog)),e.$user&&(a.title=Ln(n.connection,n.dialog)),(e.$$scope||e.$user)&&(a.$$scope={changed:e,ctx:n}),t.$set(a)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){be(t,e)}}}function Dr(e){var n,t,a,r=new Ct({props:{href:e.connection.path,class:Br(e.connection,e.connection),title:Ln(e.connection,e.connection),$$slots:{default:[Ar]},$$scope:{ctx:e}}});let o=e.connection.dialogs.toArray(),i=[];for(let n=0;n<o.length;n+=1)i[n]=Mr(Or(e,o,n));const s=e=>pe(i[e],1,1,()=>{i[e]=null});return{c(){r.$$.fragment.c(),n=S();for(let e=0;e<i.length;e+=1)i[e].c();t=A()},m(e,o){ve(r,e,o),x(e,n,o);for(let n=0;n<i.length;n+=1)i[n].m(e,o);x(e,t,o),a=!0},p(e,n){var a={};if(e.$user&&(a.href=n.connection.path),e.$user&&(a.class=Br(n.connection,n.connection)),e.$user&&(a.title=Ln(n.connection,n.connection)),(e.$$scope||e.$user)&&(a.$$scope={changed:e,ctx:n}),r.$set(a),e.$user||e.dialogClassNames||e.topicOrStatus||e.renderUnread){let a;for(o=n.connection.dialogs.toArray(),a=0;a<o.length;a+=1){const r=Or(n,o,a);i[a]?(i[a].p(e,r),fe(i[a],1)):(i[a]=Mr(r),i[a].c(),fe(i[a],1),i[a].m(t.parentNode,t))}for(ue(),a=o.length;a<i.length;a+=1)s(a);le()}},i(e){if(!a){fe(r.$$.fragment,e);for(let e=0;e<o.length;e+=1)fe(i[e]);a=!0}},o(e){pe(r.$$.fragment,e),i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)pe(i[e]);a=!1},d(e){be(r,e),e&&k(n),E(i,e),e&&k(t)}}}function Tr(e){var n,t,a,r,o,i,s,c,d=Tn("Notifications")+"",u=Hr(e.$notifications)+"",l=new $t({props:{name:e.$notifications.unread?"bell":"bell-slash"}});return{c(){l.$$.fragment.c(),n=S(),t=O("span"),a=N(d),r=S(),o=O("b"),i=N(u),D(o,"class","unread"),o.hidden=s=!e.$notifications.unread},m(e,s){ve(l,e,s),x(e,n,s),x(e,t,s),w(t,a),x(e,r,s),x(e,o,s),w(o,i),c=!0},p(e,n){var t={};e.$notifications&&(t.name=n.$notifications.unread?"bell":"bell-slash"),l.$set(t),c&&!e.$notifications||u===(u=Hr(n.$notifications)+"")||T(i,u),c&&!e.$notifications||s===(s=!n.$notifications.unread)||(o.hidden=s)},i(e){c||(fe(l.$$.fragment,e),c=!0)},o(e){pe(l.$$.fragment,e),c=!1},d(e){be(l,e),e&&(k(n),k(t),k(r),k(o))}}}function Pr(n){var t,a,r,o,i=Tn("Add conversation")+"",s=new $t({props:{name:"comment"}});return{c(){s.$$.fragment.c(),t=S(),a=O("span"),r=N(i)},m(e,n){ve(s,e,n),x(e,t,n),x(e,a,n),w(a,r),o=!0},p:e,i(e){o||(fe(s.$$.fragment,e),o=!0)},o(e){pe(s.$$.fragment,e),o=!1},d(e){be(s,e),e&&(k(t),k(a))}}}function Lr(n){var t,a,r,o,i=Tn("Add connection")+"",s=new $t({props:{name:"network-wired"}});return{c(){s.$$.fragment.c(),t=S(),a=O("span"),r=N(i)},m(e,n){ve(s,e,n),x(e,t,n),x(e,a,n),w(a,r),o=!0},p:e,i(e){o||(fe(s.$$.fragment,e),o=!0)},o(e){pe(s.$$.fragment,e),o=!1},d(e){be(s,e),e&&(k(t),k(a))}}}function Rr(n){var t,a,r,o,i=Tn("Settings")+"",s=new $t({props:{name:"cog"}});return{c(){s.$$.fragment.c(),t=S(),a=O("span"),r=N(i)},m(e,n){ve(s,e,n),x(e,t,n),x(e,a,n),w(a,r),o=!0},p:e,i(e){o||(fe(s.$$.fragment,e),o=!0)},o(e){pe(s.$$.fragment,e),o=!1},d(e){be(s,e),e&&(k(t),k(a))}}}function jr(n){var t,a,r,o,i=Tn("Help")+"",s=new $t({props:{name:"question-circle"}});return{c(){s.$$.fragment.c(),t=S(),a=O("span"),r=N(i)},m(e,n){ve(s,e,n),x(e,t,n),x(e,a,n),w(a,r),o=!0},p:e,i(e){o||(fe(s.$$.fragment,e),o=!0)},o(e){pe(s.$$.fragment,e),o=!1},d(e){be(s,e),e&&(k(t),k(a))}}}function Ir(n){var t,a,r,o,i=Tn("Log out")+"",s=new $t({props:{name:"power-off"}});return{c(){s.$$.fragment.c(),t=S(),a=O("span"),r=N(i)},m(e,n){ve(s,e,n),x(e,t,n),x(e,a,n),w(a,r),o=!0},p:e,i(e){o||(fe(s.$$.fragment,e),o=!0)},o(e){pe(s.$$.fragment,e),o=!1},d(e){be(s,e),e&&(k(t),k(a))}}}function Ur(e){var n,t,a=("nav"==e.$activeMenu||!e.$container.small)&&Sr(e);return{c(){a&&a.c(),n=A()},m(e,r){a&&a.m(e,r),x(e,n,r),t=!0},p(e,t){"nav"!=t.$activeMenu&&t.$container.small?a&&(ue(),pe(a,1,1,()=>{a=null}),le()):a?(a.p(e,t),fe(a,1)):((a=Sr(t)).c(),fe(a,1),a.m(n.parentNode,n))},i(e){t||(fe(a),t=!0)},o(e){pe(a),t=!1},d(e){a&&a.d(e),e&&k(n)}}}function Br(e,n){const t=[n.dialog_id?"for-dialog":"for-connection"];return(n.frozen||"connected"!=e.state)&&t.push("is-frozen"),n.errors&&t.push("has-errors"),t.join(" ")}function Hr(e){return e.unread>60?"60+":e.unread||0}const zr=e=>e.preventDefault();function qr(e,n,t){let a,r,o,i;u(e,dt,e=>{t("$container",r=e)}),u(e,ct,e=>{t("$activeMenu",o=e)});const s=W("user");u(e,s,e=>{t("$user",a=e)});const c=a.notifications;u(e,c,e=>{t("$notifications",i=e)});let d,l,f=0,p="",m=!1,h=[];function $(){t("searchHasFocus",m=!1),setTimeout(()=>{t("filter",p="")},100)}function v(){if(!d)return;const e=p.match(/^\W+/)?"":"\\b\\W*",n=new RegExp(e+Ve(p),"i"),a={};t("activeLinkIndex",f=0),t("searchHasFocus",m=!0),t("visibleLinks",h=[]),Ze(d,"a",(e,r)=>{const o=e.classList;!p.length&&o.contains("has-path")&&t("activeLinkIndex",f=r),o.remove("has-focus");const i=!p.length||!a[e.href]&&e.textContent.match(n);i&&h.push(e),Ye(e,i),a[e.href]=!0}),Ze(d,".for-connection",e=>{let n=e;for(;(n=n.nextElementSibling)&&n.classList.contains("for-dialog");)if(Ye(n,"is-visible"))return Ye(e,!0)}),Ze(d,"h3",e=>{let n=e;for(;(n=n.nextElementSibling)&&!Qe(n,"h3");)if(Ye(n,"is-visible"))return Ye(e,!0);Ye(e,!1)})}return e.$$.update=(e={$container:1,filter:1,visibleLinks:1,activeLinkIndex:1})=>{e.$container&&t("flyTransitionParameters",l={duration:r.small?250:0,x:r.width}),e.filter&&v(),(e.visibleLinks||e.activeLinkIndex)&&h[f]&&h[f].classList.add("has-focus")},{user:s,notifications:c,filter:p,navEl:d,searchHasFocus:m,clearFilter:$,filterNav:v,onNavItemClicked:function(e){(e.target.className||"").match(/network|user/)&&setTimeout(()=>{g(ct,o="settings")},50)},onSearchKeydown:function(e){if(13==e.keyCode)return e.preventDefault(),$(),void(h[f]&&ot(h[f].href));const n=38==e.keyCode?-1:40==e.keyCode?1:0;n&&(e.preventDefault(),h[f]&&h[f].classList.remove("has-focus"),t("activeLinkIndex",f+=e.ctrlKey?4*n:n)),f<0&&t("activeLinkIndex",f=h.length-1),f>=h.length&&t("activeLinkIndex",f=0)},$user:a,flyTransitionParameters:l,$container:r,$activeMenu:o,$notifications:i,input_input_handler:function(){p=this.value,t("filter",p)},nav_binding:function(e){Y[e?"unshift":"push"](()=>{t("navEl",d=e)})}}}class Fr extends _e{constructor(e){super(),ye(this,e,qr,Ur,s,[])}}function Kr(e,n,t){const a=Object.create(e);return a.participant=n[t],a}function Gr(e){var n,t,a=e.settingsComponent;function r(e){return{props:{dialog:e.dialog}}}if(a)var o=new a(r(e));return{c(){o&&o.$$.fragment.c(),n=A()},m(e,a){o&&ve(o,e,a),x(e,n,a),t=!0},p(e,t){var i={};if(e.dialog&&(i.dialog=t.dialog),a!==(a=t.settingsComponent)){if(o){ue();const e=o;pe(e.$$.fragment,1,0,()=>{be(e,1)}),le()}a?((o=new a(r(t))).$$.fragment.c(),fe(o.$$.fragment,1),ve(o,n.parentNode,n)):o=null}else a&&o.$set(i)},i(e){t||(o&&fe(o.$$.fragment,e),t=!0)},o(e){o&&pe(o.$$.fragment,e),t=!1},d(e){e&&k(n),o&&be(o,e)}}}function Wr(e){var n,t,a,r,o,i,s,c,d,u=e.pathParts[2]||e.pathParts[1]||Tn("Notifications")+"",l=Ln(e.connection,e.dialog)+"",f=new $t({props:{name:e.dialog.connection_id?"sliders-h":"bell"}});return{c(){n=O("h1"),t=O("a"),f.$$.fragment.c(),a=O("span"),r=N(u),i=S(),s=O("small"),c=N(l),D(t,"href",o="#activeMenu:"+(e.dialog.connection_id?"settings":""))},m(e,o){x(e,n,o),w(n,t),ve(f,t,null),w(t,a),w(a,r),x(e,i,o),x(e,s,o),w(s,c),d=!0},p(e,n){var a={};e.dialog&&(a.name=n.dialog.connection_id?"sliders-h":"bell"),f.$set(a),d&&!e.pathParts||u===(u=n.pathParts[2]||n.pathParts[1]||Tn("Notifications")+"")||T(r,u),d&&!e.dialog||o===(o="#activeMenu:"+(n.dialog.connection_id?"settings":""))||D(t,"href",o),d&&!e.connection&&!e.dialog||l===(l=Ln(n.connection,n.dialog)+"")||T(c,l)},i(e){d||(fe(f.$$.fragment,e),d=!0)},o(e){pe(f.$$.fragment,e),d=!1},d(e){e&&k(n),be(f),e&&(k(i),k(s))}}}function Zr(e){var n,t=new Yt({props:{connection:e.connection,dialog:e.dialog,input:e.chatInput}});return{c(){t.$$.fragment.c()},m(e,a){ve(t,e,a),n=!0},p(e,n){var a={};e.connection&&(a.connection=n.connection),e.dialog&&(a.dialog=n.dialog),e.chatInput&&(a.input=n.chatInput),t.$set(a)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){be(t,e)}}}function Vr(e){var n,t,a,r,o,i,s,c,d,u,l,f,p,g=Tn("You are not part of this conversation.")+"",m=Tn('Do you want to chat with "%1"?',e.pathParts[2])+"",h=Tn("Yes")+"",$=new Ct({props:{href:"/chat",class:"btn",$$slots:{default:[Qr]},$$scope:{ctx:e}}});return{c(){n=O("h2"),t=N(g),a=S(),r=O("p"),o=N(m),i=S(),s=O("p"),c=O("a"),d=N(h),l=S(),$.$$.fragment.c(),D(c,"href",u="#add:"+e.pathParts[2]),D(c,"class","btn"),p=C(c,"click",M(e.addDialog))},m(e,u){x(e,n,u),w(n,t),x(e,a,u),x(e,r,u),w(r,o),x(e,i,u),x(e,s,u),w(s,c),w(c,d),w(s,l),ve($,s,null),f=!0},p(e,n){f&&!e.pathParts||m===(m=Tn('Do you want to chat with "%1"?',n.pathParts[2])+"")||T(o,m),f&&!e.pathParts||u===(u="#add:"+n.pathParts[2])||D(c,"href",u);var t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),$.$set(t)},i(e){f||(fe($.$$.fragment,e),f=!0)},o(e){pe($.$$.fragment,e),f=!1},d(e){e&&(k(n),k(a),k(r),k(i),k(s)),be($),p()}}}function Yr(e){var n,t,a,r,o,i,s,c,d,u=Tn("Connection does not exist.")+"",l=Tn('Do you want to create the connection "%1"?',e.pathParts[1])+"",f=new Ct({props:{href:"/add/connection?server="+encodeURIComponent(e.pathParts[1])+"&dialog="+encodeURIComponent(e.pathParts[2]),class:"btn",$$slots:{default:[Xr]},$$scope:{ctx:e}}}),p=new Ct({props:{href:"/chat",class:"btn",$$slots:{default:[eo]},$$scope:{ctx:e}}});return{c(){n=O("h2"),t=N(u),a=S(),r=O("p"),o=N(l),i=S(),s=O("p"),f.$$.fragment.c(),c=S(),p.$$.fragment.c()},m(e,u){x(e,n,u),w(n,t),x(e,a,u),x(e,r,u),w(r,o),x(e,i,u),x(e,s,u),ve(f,s,null),w(s,c),ve(p,s,null),d=!0},p(e,n){d&&!e.pathParts||l===(l=Tn('Do you want to create the connection "%1"?',n.pathParts[1])+"")||T(o,l);var t={};e.pathParts&&(t.href="/add/connection?server="+encodeURIComponent(n.pathParts[1])+"&dialog="+encodeURIComponent(n.pathParts[2])),e.$$scope&&(t.$$scope={changed:e,ctx:n}),f.$set(t);var a={};e.$$scope&&(a.$$scope={changed:e,ctx:n}),p.$set(a)},i(e){d||(fe(f.$$.fragment,e),fe(p.$$.fragment,e),d=!0)},o(e){pe(f.$$.fragment,e),pe(p.$$.fragment,e),d=!1},d(e){e&&(k(n),k(a),k(r),k(i),k(s)),be(f),be(p)}}}function Jr(n){var t,a,r=Tn("Loading...")+"";return{c(){t=O("h2"),a=N(r)},m(e,n){x(e,t,n),w(t,a)},p:e,i:e,o:e,d(e){e&&k(t)}}}function Qr(n){var t,a=Tn("No")+"";return{c(){t=N(a)},m(e,n){x(e,t,n)},p:e,d(e){e&&k(t)}}}function Xr(n){var t,a=Tn("Yes")+"";return{c(){t=N(a)},m(e,n){x(e,t,n)},p:e,d(e){e&&k(t)}}}function eo(n){var t,a=Tn("No")+"";return{c(){t=N(a)},m(e,n){x(e,t,n)},p:e,d(e){e&&k(t)}}}function no(e){var n;let t={dialog:e.dialog};var a=new Nt({props:t});return e.chatinput_binding(a),{c(){a.$$.fragment.c()},m(e,t){ve(a,e,t),n=!0},p(e,n){var t={};e.dialog&&(t.dialog=n.dialog),a.$set(t)},i(e){n||(fe(a.$$.fragment,e),n=!0)},o(e){pe(a.$$.fragment,e),n=!1},d(n){e.chatinput_binding(null),be(a,n)}}}function to(e){var n,t,a,r,o,i,s,c,d=Tn("Participants (%1)",e.dialog.participants.size)+"";let u=e.dialog.participants.toArray(),l=[];for(let n=0;n<u.length;n+=1)l[n]=ro(Kr(e,u,n));const f=e=>pe(l[e],1,1,()=>{l[e]=null});return{c(){n=O("div"),t=O("nav"),a=O("h3"),r=N(d),o=S();for(let e=0;e<l.length;e+=1)l[e].c();i=S(),s=O("nav"),D(t,"class","sidebar-right__nav"),D(n,"class","sidebar-right")},m(e,d){x(e,n,d),w(n,t),w(t,a),w(a,r),w(t,o);for(let e=0;e<l.length;e+=1)l[e].m(t,null);w(t,i),w(t,s),c=!0},p(e,n){if(c&&!e.dialog||d===(d=Tn("Participants (%1)",n.dialog.participants.size)+"")||T(r,d),e.dialog||e.modeClassNames){let a;for(u=n.dialog.participants.toArray(),a=0;a<u.length;a+=1){const r=Kr(n,u,a);l[a]?(l[a].p(e,r),fe(l[a],1)):(l[a]=ro(r),l[a].c(),fe(l[a],1),l[a].m(t,i))}for(ue(),a=u.length;a<l.length;a+=1)f(a);le()}},i(e){if(!c){for(let e=0;e<u.length;e+=1)fe(l[e]);c=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)pe(l[e]);c=!1},d(e){e&&k(n),E(l,e)}}}function ao(e){var n,t,a,r,o=e.participant.nick+"",i=new $t({props:{name:"pick:"+e.participant.id,family:"solid",style:"color:"+e.participant.color}});return{c(){i.$$.fragment.c(),n=S(),t=O("span"),a=N(o)},m(e,o){ve(i,e,o),x(e,n,o),x(e,t,o),w(t,a),r=!0},p(e,n){var t={};e.dialog&&(t.name="pick:"+n.participant.id),e.dialog&&(t.style="color:"+n.participant.color),i.$set(t),r&&!e.dialog||o===(o=n.participant.nick+"")||T(a,o)},i(e){r||(fe(i.$$.fragment,e),r=!0)},o(e){pe(i.$$.fragment,e),r=!1},d(e){be(i,e),e&&(k(n),k(t))}}}function ro(e){var n,t=new Ct({props:{href:"/chat/"+e.dialog.connection_id+"/"+e.participant.id,class:"participant "+qe(e.participant.mode),$$slots:{default:[ao]},$$scope:{ctx:e}}});return{c(){t.$$.fragment.c()},m(e,a){ve(t,e,a),n=!0},p(e,n){var a={};e.dialog&&(a.href="/chat/"+n.dialog.connection_id+"/"+n.participant.id),e.dialog&&(a.class="participant "+qe(n.participant.mode)),(e.$$scope||e.dialog)&&(a.$$scope={changed:e,ctx:n}),t.$set(a)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){be(t,e)}}}function oo(e){var n,t,a,r,i,s,c,d,u,l,f,p,g,m;ae(e.onwindowresize);var h=new Fr({}),$="settings"==e.$activeMenu&&Gr(e),v=new yt({props:{$$slots:{default:[Wr]},$$scope:{ctx:e}}}),b=[Jr,Yr,Vr,Zr],y=[];function _(e,n){return(null==s||e.$user||e.dialog)&&(s=!!(n.$user.is("loading")||n.dialog.is("loading")&&!n.dialog.messages.length)),s?0:n.pathParts[1]&&!n.connection.connection_id?1:n.pathParts[2]&&!n.dialog.connection_id?2:3}c=_(null,e),d=y[c]=b[c](e);var E=e.dialog.connection_id&&no(e),N=e.dialog.participants.size&&to(e);return{c(){h.$$.fragment.c(),n=S(),$&&$.c(),t=S(),v.$$.fragment.c(),a=S(),r=O("main"),i=O("div"),d.c(),l=S(),E&&E.c(),f=S(),N&&N.c(),p=A(),ae(()=>e.div_resize_handler.call(i)),D(i,"class","messages-container"),R(i,"has-notifications",1==e.pathParts.length),D(r,"class","main"),m=[C(window,"resize",e.onwindowresize),C(r,"scroll",e.onScroll)]},m(o,s){ve(h,o,s),x(o,n,s),$&&$.m(o,s),x(o,t,s),ve(v,o,s),x(o,a,s),x(o,r,s),w(r,i),y[c].m(i,null),u=function(e,n){"static"===getComputedStyle(e).position&&(e.style.position="relative");const t=document.createElement("object");let a;return t.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;"),t.type="text/html",t.tabIndex=-1,t.onload=()=>{(a=t.contentDocument.defaultView).addEventListener("resize",n)},/Trident/.test(navigator.userAgent)?(e.appendChild(t),t.data="about:blank"):(t.data="about:blank",e.appendChild(t)),{cancel:()=>{a&&a.removeEventListener&&a.removeEventListener("resize",n),e.removeChild(t)}}}(i,e.div_resize_handler.bind(i)),e.main_binding(r),x(o,l,s),E&&E.m(o,s),x(o,f,s),N&&N.m(o,s),x(o,p,s),g=!0},p(e,n){"settings"==n.$activeMenu?$?($.p(e,n),fe($,1)):(($=Gr(n)).c(),fe($,1),$.m(t.parentNode,t)):$&&(ue(),pe($,1,1,()=>{$=null}),le());var a={};(e.$$scope||e.connection||e.dialog||e.pathParts)&&(a.$$scope={changed:e,ctx:n}),v.$set(a);var r=c;(c=_(e,n))===r?y[c].p(e,n):(ue(),pe(y[r],1,1,()=>{y[r]=null}),le(),(d=y[c])||(d=y[c]=b[c](n)).c(),fe(d,1),d.m(i,null)),e.pathParts&&R(i,"has-notifications",1==n.pathParts.length),n.dialog.connection_id?E?(E.p(e,n),fe(E,1)):((E=no(n)).c(),fe(E,1),E.m(f.parentNode,f)):E&&(ue(),pe(E,1,1,()=>{E=null}),le()),n.dialog.participants.size?N?(N.p(e,n),fe(N,1)):((N=to(n)).c(),fe(N,1),N.m(p.parentNode,p)):N&&(ue(),pe(N,1,1,()=>{N=null}),le())},i(e){g||(fe(h.$$.fragment,e),fe($),fe(v.$$.fragment,e),fe(d),fe(E),fe(N),g=!0)},o(e){pe(h.$$.fragment,e),pe($),pe(v.$$.fragment,e),pe(d),pe(E),pe(N),g=!1},d(i){be(h,i),i&&k(n),$&&$.d(i),i&&k(t),be(v,i),i&&(k(a),k(r)),y[c].d(),u.cancel(),e.main_binding(null),i&&k(l),E&&E.d(i),i&&k(f),N&&N.d(i),i&&k(p),o(m)}}}function io(e,n,t){let a,r,o;u(e,ut,e=>{t("$currentUrl",a=e)}),u(e,ct,e=>{t("$activeMenu",o=e)});const i=W("user");let s,c;u(e,i,e=>{t("$user",r=e)});let d,l=null,f=0,p=0,g=0,m="bottom",h={},$=i.notifications,v="",b=a.pathParts,y=[];var _;function w(e,n){e.forEach(({isIntersecting:e,target:n})=>{e&&i.embedMaker.render(($.messages[n.dataset.index]||{}).embeds||[],n)})}_=()=>{d=d||new IntersectionObserver(w,{rootMargin:"0px"}),Ze(document,".message",e=>d.observe(e)),"bottom"==m?t("messagesEl",c.scrollTop=p,c):g&&g<p&&(t("messagesEl",c.scrollTop=p-g,c),g=0)},F().$$.after_update.push(_),function(e){F().$$.on_destroy.push(e)}(()=>{y.forEach(e=>e())});const x=ze(e=>{if(!c||!$.dialog_id)return;const n=c.offsetHeight,t=c.scrollTop;"top"!=(m=n>p||t+20>p-n?"bottom":t<100?"top":"middle")||$.is("loading")||($.messages.length&&!$.messages[0].endOfHistory&&$.loadHistoric(),g=p)},20);return e.$$.update=(e={$user:1,$currentUrl:1})=>{(e.$user||e.$currentUrl)&&function(e,n){t("pathParts",b=n.pathParts);const a=e.findDialog({connection_id:b[1]})||{};a!=h&&t("connection",h=a);const r=1==b.length?e.notifications:e.findDialog({connection_id:b[1],dialog_id:b[2]});if(!r)return t("dialog",$=e.notifications);r==$&&v||(y&&y.forEach(e=>e()),v&&$.setLastRead&&$.setLastRead(),Ze(document,".message__embed",e=>e.remove()),t("dialog",$=r),v=n.path,y=[],h.subscribe&&y.push(h.subscribe(e=>{t("connection",h=e)})),$!=h&&y.push($.subscribe(e=>{t("dialog",$=e)})),$.load(),t("settingsComponent",l=$.connection_id?$.dialog_id?Er:ur:null))}(r,a)},{user:i,chatInput:s,messagesEl:c,settingsComponent:l,containerHeight:f,messagesHeight:p,connection:h,dialog:$,pathParts:b,addDialog:function(e){h.connection_id&&h.addDialog(e.target.closest("a").href.replace(/.*#add:/,""))},onScroll:x,$user:r,$activeMenu:o,onwindowresize:function(){f=window.innerHeight,t("containerHeight",f)},div_resize_handler:function(){p=this.offsetHeight,t("messagesHeight",p)},main_binding:function(e){Y[e?"unshift":"push"](()=>{t("messagesEl",c=e)})},chatinput_binding:function(e){Y[e?"unshift":"push"](()=>{t("chatInput",s=e)})}}}class so extends _e{constructor(e){super(),ye(this,e,io,oo,s,[])}}function co(n){var t,a,r=Tn("Add connection")+"";return{c(){t=O("h1"),a=N(r)},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function uo(e){var n,t,a,r,o=new Fr({}),i=new yt({props:{$$slots:{default:[co]},$$scope:{ctx:e}}}),s=new ar({});return{c(){o.$$.fragment.c(),n=S(),i.$$.fragment.c(),t=S(),a=O("main"),s.$$.fragment.c(),D(a,"class","main")},m(e,c){ve(o,e,c),x(e,n,c),ve(i,e,c),x(e,t,c),x(e,a,c),ve(s,a,null),r=!0},p(e,n){var t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),i.$set(t)},i(e){r||(fe(o.$$.fragment,e),fe(i.$$.fragment,e),fe(s.$$.fragment,e),r=!0)},o(e){pe(o.$$.fragment,e),pe(i.$$.fragment,e),pe(s.$$.fragment,e),r=!1},d(e){be(o,e),e&&k(n),be(i,e),e&&(k(t),k(a)),be(s)}}}class lo extends _e{constructor(e){super(),ye(this,e,null,uo,s,[])}}function fo(e,n,t){const a=Object.create(e);return a.opt=n[t],a.i=t,a}const po=()=>({}),go=()=>({});function mo(e){var n,t,a,r,i=e.opt.length>1?e.opt[1]:e.opt[0]+"";function s(){return e.mouseover_handler(e)}return{c(){n=O("a"),t=N(i),D(n,"href",a="#"+e.i+":"+e.opt[0]),D(n,"tabindex","-1"),R(n,"is-active",e.i==e.activeIndex),r=[C(n,"click",e.selectOption),C(n,"mouseover",s)]},m(e,a){x(e,n,a),w(n,t)},p(r,o){e=o,r.visibleOptions&&i!==(i=e.opt.length>1?e.opt[1]:e.opt[0]+"")&&T(t,i),r.visibleOptions&&a!==(a="#"+e.i+":"+e.opt[0])&&D(n,"href",a),r.activeIndex&&R(n,"is-active",e.i==e.activeIndex)},d(e){e&&k(n),o(r)}}}function ho(e){var n,t,a,r,i,s,c,d,u,g,m;const h=e.$$slots.label,$=l(h,e,go);let v=e.visibleOptions,b=[];for(let n=0;n<v.length;n+=1)b[n]=mo(fo(e,v,n));return{c(){n=O("div"),t=O("label"),$||(a=N("Label")),$&&$.c(),r=S(),i=O("input"),s=S(),c=O("input"),d=S(),u=O("div");for(let e=0;e<b.length;e+=1)b[e].c();D(t,"for",e.id),D(i,"type","hidden"),D(i,"name",e.name),D(c,"type","text"),D(c,"placeholder",e.placeholder),D(c,"id",e.id),c.readOnly=e.readonly,D(c,"autocomplete","off"),D(u,"class","select-field__options"),D(n,"class","select-field text-field"),n.hidden=e.hidden,R(n,"is-open",e.open),m=[C(i,"input",e.input0_input_handler),C(i,"keydown",e.keydown),C(c,"keydown",e.keydown),C(c,"keyup",e.keyup),C(n,"click",M(e.toggle))]},l(e){$&&$.l(label_nodes)},m(o,l){x(o,n,l),w(n,t),$?$.m(t,null):w(t,a),w(n,r),w(n,i),P(i,e.value),e.input0_binding(i),w(n,s),w(n,c),e.input1_binding(c),w(n,d),w(n,u);for(let e=0;e<b.length;e+=1)b[e].m(u,null);e.div1_binding(n),g=!0},p(e,a){if($&&$.p&&e.$$scope&&$.p(p(h,a,e,po),f(h,a,go)),g&&!e.id||D(t,"for",a.id),e.value&&P(i,a.value),g&&!e.name||D(i,"name",a.name),g&&!e.placeholder||D(c,"placeholder",a.placeholder),g&&!e.id||D(c,"id",a.id),g&&!e.readonly||(c.readOnly=a.readonly),e.visibleOptions||e.activeIndex){let n;for(v=a.visibleOptions,n=0;n<v.length;n+=1){const t=fo(a,v,n);b[n]?b[n].p(e,t):(b[n]=mo(t),b[n].c(),b[n].m(u,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=v.length}g&&!e.hidden||(n.hidden=a.hidden),e.open&&R(n,"is-open",a.open)},i(e){g||(fe($,e),g=!0)},o(e){pe($,e),g=!1},d(t){t&&k(n),$&&$.d(t),e.input0_binding(null),e.input1_binding(null),E(b,t),e.div1_binding(null),o(m)}}}function $o(e,n,t){const a=["ArrowDown","ArrowUp","Enter"];let r,o,i,s=0,c=!1,d="",{hidden:u=!1,name:l="",id:f=(l?"form_"+l:en()),options:p=[],placeholder:g="",readonly:m=!1,value:h=""}=n;async function $(e){let n;if("keydown"==e.type)n=y.length?y[s]:[];else{const t=e.target.href.replace(/^.*?#\d+:/,"");n=y.filter(e=>e[0]==t)[0]||[]}n.length||(n=[""]),t("value",h=n[0]),t("humanEl",o.value=n.length>1?n[1]:n[0],o),await(te(),X),o.setSelectionRange(0,9999),t("open",c=!1)}K(()=>{o.addEventListener("blur",()=>setTimeout(()=>{t("open",c=!1)},100)),t("value",h=r.value)});let{$$slots:v={},$$scope:b}=n;let y;return e.$set=e=>{"hidden"in e&&t("hidden",u=e.hidden),"name"in e&&t("name",l=e.name),"id"in e&&t("id",f=e.id),"options"in e&&t("options",p=e.options),"placeholder"in e&&t("placeholder",g=e.placeholder),"readonly"in e&&t("readonly",m=e.readonly),"value"in e&&t("value",h=e.value),"$$scope"in e&&t("$$scope",b=e.$$scope)},e.$$.update=(e={open:1,options:1,typed:1,hiddenEl:1,humanEl:1})=>{if(e.open&&0==c&&t("typed",d=""),(e.options||e.typed)&&t("visibleOptions",y=function(e,n){let t=new RegExp("(?:^|\\s|-)"+Ve(n),"i"),a=[];return a.length||(a=e.filter(e=>e[0]==n)),a.length||(a=e.filter(e=>e[0].match(t))),a.concat(e.filter(e=>e.length>1&&-1!=a.indexOf(e)&&e[1].match(t)))}(p,d)),e.open&&1==c&&t("activeIndex",s=0),e.hiddenEl&&r&&!r.syncValue&&(t("hiddenEl",r.syncValue=function(){t("value",h=this.value)},r),r.syncValue()),(e.humanEl||e.options||e.hiddenEl)&&o&&!o.value&&o!=document.activeElement){const e=p.find(e=>e[0]==r.value);e&&t("humanEl",o.value=e[1]||e[0],o)}},{activeIndex:s,hiddenEl:r,humanEl:o,open:c,wrapperEl:i,hidden:u,name:l,id:f,options:p,placeholder:g,readonly:m,value:h,keydown:function(e){-1!=a.indexOf(e.key)&&e.preventDefault(),"Tab"!=e.key?c?("ArrowDown"==e.key&&t("activeIndex",s++,s),"ArrowUp"==e.key&&t("activeIndex",s--,s),"Enter"==e.key&&$(e),s>=p.length&&t("activeIndex",s=0),s<0&&t("activeIndex",s=p.length-1)):t("open",c=!0):c&&$(e)},keyup:function(e){1!=e.key.length&&"Backspace"!=e.key||t("typed",d=o.value)},selectOption:$,toggle:function(){t("open",c=!c)},visibleOptions:y,input0_input_handler:function(){h=this.value,t("value",h),t("hiddenEl",r)},input0_binding:function(e){Y[e?"unshift":"push"](()=>{t("hiddenEl",r=e)})},input1_binding:function(e){Y[e?"unshift":"push"](()=>{t("humanEl",o=e)})},mouseover_handler:({i:e})=>{t("activeIndex",s=e)},div1_binding:function(e){Y[e?"unshift":"push"](()=>{t("wrapperEl",i=e)})},$$slots:v,$$scope:b}}class vo extends _e{constructor(e){super(),ye(this,e,$o,ho,s,["hidden","name","id","options","placeholder","readonly","value"])}}function bo(e,n,t){const a=Object.create(e);return a.dialog=n[t],a}function yo(n){var t,a,r=Tn("Add conversation")+"";return{c(){t=O("h1"),a=N(r)},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function _o(n){var t,a,r=Tn("Connection")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function wo(n){return{c:e,m:e,p:e,d:e}}function xo(e){var n,t=Tn(e.availableDialogs.dialogs.length?"Refresh":"Load")+"";return{c(){n=N(t)},m(e,t){x(e,n,t)},p(e,a){e.availableDialogs&&t!==(t=Tn(a.availableDialogs.dialogs.length?"Refresh":"Load")+"")&&T(n,t)},d(e){e&&k(n)}}}function ko(n){var t,a,r=Tn("Conversation name")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function Eo(n){return{c:e,m:e,p:e,d:e}}function Oo(n){var t,a=Tn("Add")+"";return{c(){t=N(a)},m(e,n){x(e,t,n)},p:e,d(e){e&&k(t)}}}function No(e){var n,t,a,r,o=e.availableDialogs.error+"";return{c(){n=O("p"),t=N(e.connectionId),a=N(": "),r=N(o),D(n,"class","error")},m(e,o){x(e,n,o),w(n,t),w(n,a),w(n,r)},p(e,n){e.connectionId&&T(t,n.connectionId),e.availableDialogs&&o!==(o=n.availableDialogs.error+"")&&T(r,o)},d(e){e&&k(n)}}}function So(e){var n,t,a;function r(e,n){return n.availableDialogs.done?Co:Ao}var o=r(0,e),i=o(e);let s=e.availableDialogs.dialogs,c=[];for(let n=0;n<s.length;n+=1)c[n]=Mo(bo(e,s,n));return{c(){n=O("p"),i.c(),t=S(),a=O("div");for(let e=0;e<c.length;e+=1)c[e].c();D(a,"class","dialog-add-list")},m(e,r){x(e,n,r),i.m(n,null),x(e,t,r),x(e,a,r);for(let e=0;e<c.length;e+=1)c[e].m(a,null)},p(e,t){if(o===(o=r(0,t))&&i?i.p(e,t):(i.d(1),(i=o(t))&&(i.c(),i.m(n,null))),e.availableDialogs){let n;for(s=t.availableDialogs.dialogs,n=0;n<s.length;n+=1){const r=bo(t,s,n);c[n]?c[n].p(e,r):(c[n]=Mo(r),c[n].c(),c[n].m(a,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=s.length}},d(e){e&&k(n),i.d(),e&&(k(t),k(a)),E(c,e)}}}function Ao(e){var n,t=Tn("Showing %1 of %2 conversations, but the list is still loading.",e.availableDialogs.dialogs.length,e.availableDialogs.n_dialogs)+"";return{c(){n=N(t)},m(e,t){x(e,n,t)},p(e,a){e.availableDialogs&&t!==(t=Tn("Showing %1 of %2 conversations, but the list is still loading.",a.availableDialogs.dialogs.length,a.availableDialogs.n_dialogs)+"")&&T(n,t)},d(e){e&&k(n)}}}function Co(e){var n,t=Tn("Showing %1 of %2 conversations.",e.availableDialogs.dialogs.length,e.availableDialogs.n_dialogs)+"";return{c(){n=N(t)},m(e,t){x(e,n,t)},p(e,a){e.availableDialogs&&t!==(t=Tn("Showing %1 of %2 conversations.",a.availableDialogs.dialogs.length,a.availableDialogs.n_dialogs)+"")&&T(n,t)},d(e){e&&k(n)}}}function Mo(e){var n,t,a,r,o,i,s,c,d,u,l,f,p=e.dialog.n_users+"",g=e.dialog.name+"",m=e.dialog.topic||"No topic.";return{c(){n=O("a"),t=O("span"),a=N(p),r=S(),o=O("b"),i=N(g),s=S(),c=O("i"),d=N(m),u=S(),D(t,"class","dialog-add-list__n-users"),D(o,"class","dialog-add-list__name"),D(c,"class","dialog-add-list__title"),D(n,"href",l="#add:"+e.dialog.name),f=C(n,"click",M(e.addDialog))},m(e,l){x(e,n,l),w(n,t),w(t,a),w(n,r),w(n,o),w(o,i),w(n,s),w(n,c),w(c,d),w(n,u)},p(e,t){e.availableDialogs&&p!==(p=t.dialog.n_users+"")&&T(a,p),e.availableDialogs&&g!==(g=t.dialog.name+"")&&T(i,g),e.availableDialogs&&m!==(m=t.dialog.topic||"No topic.")&&T(d,m),e.availableDialogs&&l!==(l="#add:"+t.dialog.name)&&D(n,"href",l)},d(e){e&&k(n),f()}}}function Do(e){var n,t,a,r,o,i,s,c,d,u,l,f,p,g,m,h,$,v,b,y,_=Tn("Enter the name of an exising conversation, or create a new conversation.")+"",E=Tn("It is also possible to load in all existing conversations for a given connection.")+"",A=new Fr({}),T=new yt({props:{$$slots:{default:[yo]},$$scope:{ctx:e}}});function P(n){e.selectfield_value_binding.call(null,n),l=!0,re(()=>l=!1)}let L={name:"connection_id",options:e.connectionOptions,placeholder:Tn("Select..."),$$slots:{default:[wo],label:[_o]},$$scope:{ctx:e}};void 0!==e.connectionId&&(L.value=e.connectionId);var R=new vo({props:L});Y.push(()=>$e(R,"value",P));var j=new ea({props:{type:"button",icon:"sync-alt",disabled:!e.connectionId||!1===e.availableDialogs.done,$$slots:{default:[xo]},$$scope:{ctx:e}}});function I(n){e.textfield_value_binding.call(null,n),m=!0,re(()=>m=!1)}j.$on("click",e.loadConversations);let U={name:"dialog_id",placeholder:Tn("#room or nick"),autocomplete:"off",$$slots:{default:[Eo],label:[ko]},$$scope:{ctx:e}};void 0!==e.dialogId&&(U.value=e.dialogId);var B=new Sa({props:U});Y.push(()=>$e(B,"value",I)),B.$on("keyup",e.debouncedLoadConversations);var H=new ea({props:{icon:"comment",disabled:!e.connectionId||!e.dialogId,$$slots:{default:[Oo]},$$scope:{ctx:e}}}),z=e.availableDialogs.error&&No(e),q=null!==e.availableDialogs.done&&So(e);return{c(){A.$$.fragment.c(),n=S(),T.$$.fragment.c(),t=S(),a=O("main"),r=O("p"),o=N(_),i=S(),s=N(E),c=S(),d=O("form"),u=O("div"),R.$$.fragment.c(),f=S(),j.$$.fragment.c(),p=S(),g=O("div"),B.$$.fragment.c(),h=S(),H.$$.fragment.c(),$=S(),z&&z.c(),v=S(),q&&q.c(),D(u,"class","inputs-side-by-side"),D(g,"class","inputs-side-by-side"),D(d,"method","post"),D(a,"class","main"),y=C(d,"submit",M(e.addDialog))},m(l,m){ve(A,l,m),x(l,n,m),ve(T,l,m),x(l,t,m),x(l,a,m),w(a,r),w(r,o),w(r,i),w(r,s),w(a,c),w(a,d),w(d,u),ve(R,u,null),w(u,f),ve(j,u,null),w(d,p),w(d,g),ve(B,g,null),w(g,h),ve(H,g,null),w(d,$),z&&z.m(d,null),w(d,v),q&&q.m(d,null),e.form_binding(d),b=!0},p(e,n){var t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),T.$set(t);var a={};e.connectionOptions&&(a.options=n.connectionOptions),e.$$scope&&(a.$$scope={changed:e,ctx:n}),!l&&e.connectionId&&(a.value=n.connectionId),R.$set(a);var r={};(e.connectionId||e.availableDialogs)&&(r.disabled=!n.connectionId||!1===n.availableDialogs.done),(e.$$scope||e.availableDialogs)&&(r.$$scope={changed:e,ctx:n}),j.$set(r);var o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),!m&&e.dialogId&&(o.value=n.dialogId),B.$set(o);var i={};(e.connectionId||e.dialogId)&&(i.disabled=!n.connectionId||!n.dialogId),e.$$scope&&(i.$$scope={changed:e,ctx:n}),H.$set(i),n.availableDialogs.error?z?z.p(e,n):((z=No(n)).c(),z.m(d,v)):z&&(z.d(1),z=null),null!==n.availableDialogs.done?q?q.p(e,n):((q=So(n)).c(),q.m(d,null)):q&&(q.d(1),q=null)},i(e){b||(fe(A.$$.fragment,e),fe(T.$$.fragment,e),fe(R.$$.fragment,e),fe(j.$$.fragment,e),fe(B.$$.fragment,e),fe(H.$$.fragment,e),b=!0)},o(e){pe(A.$$.fragment,e),pe(T.$$.fragment,e),pe(R.$$.fragment,e),pe(j.$$.fragment,e),pe(B.$$.fragment,e),pe(H.$$.fragment,e),b=!1},d(r){be(A,r),r&&k(n),be(T,r),r&&(k(t),k(a)),be(R),be(j),be(B),be(H),z&&z.d(),q&&q.d(),e.form_binding(null),y()}}}function To(e,n,t){let a;const r=W("user");u(e,r,e=>{t("$user",a=e)});let o,i,s={dialogs:[],done:null,n_dialogs:0},c="",d="";function l(e){let n="/list"+(d.length?" /"+d+"/":"");"click"==e.type&&s.done&&(n+=" refresh"),i&&clearTimeout(i),r.send({connection_id:c,message:n},n=>{const a=Ge(n);t("availableDialogs",s=a?{dialogs:[],done:!0,n_dialogs:0,error:a}:n);let r=e.interval?e.interval+500:500;r>2e3&&(r=2e3),a||n.done||(i=setTimeout(()=>l({interval:r}),r))})}K(()=>st(o));const f=ze(l,250);let p;return e.$$.update=(e={$user:1,connectionId:1,connectionOptions:1})=>{e.$user&&t("connectionOptions",p=Array.from(a.connections.keys()).map(e=>[e])),(e.connectionId||e.connectionOptions)&&(c||t("connectionId",c=p[0]?p[0][0]:""))},{user:r,availableDialogs:s,connectionId:c,dialogId:d,formEl:o,addDialog:function(e){const n=e&&e.target&&e.target.closest("a");n&&n.href&&t("dialogId",d=n.href.replace(/.*#add:/,"")),c&&d&&r.findDialog({connection_id:c}).addDialog(d)},loadConversations:l,debouncedLoadConversations:f,connectionOptions:p,selectfield_value_binding:function(e){t("connectionId",c=e),t("connectionOptions",p),t("$user",a)},textfield_value_binding:function(e){t("dialogId",d=e)},form_binding:function(e){Y[e?"unshift":"push"](()=>{t("formEl",o=e)})}}}class Po extends _e{constructor(e){super(),ye(this,e,To,Do,s,[])}}function Lo(e,n,t){const a=Object.create(e);return a.command=n[t],a}function Ro(n){var t,a,r,o,i,s=Tn("Help")+"",c=n.settings.version+"";return{c(){t=O("h1"),a=N(s),r=O("small"),o=N("v"),i=N(c)},m(e,n){x(e,t,n),w(t,a),x(e,r,n),w(r,o),w(r,i)},p:e,d(e){e&&(k(t),k(r))}}}function jo(n){var t,a,r,o,i=n.command.example+"",s=Tn(n.command.description)+"";return{c(){t=O("dt"),a=N(i),r=O("dd"),o=N(s)},m(e,n){x(e,t,n),w(t,a),x(e,r,n),w(r,o)},p:e,d(e){e&&(k(t),k(r))}}}function Io(e){var n,t,a,r,o,i,s,c,d,u,l,f,p,g,m,h,$,v,b,y,_,A,C,M,T,P,L,R,I,U,B,H,z,q,F,K,G,W,Z,V,Y,J,Q,X,ee,ne,te,ae,re,oe,ie,se,ce,de,ue,le,ge,me,he,$e,ye,_e,we,xe,ke,Ee,Oe,Ne,Se,Ae,Ce,Me,De,Te,Pe,Le,Re,je,Ie,Ue,Be,He,ze,qe=Pn('Got any questions? Come and talk to us in the "#convos" channel on http://freenode.net.')+"",Fe=Pn("More information can also be found on http://convos.by.")+"",Ke=Tn("Shortcuts")+"",Ge=Tn("shift+enter")+"",We=Tn("Shift focus between chat input and search in sidebar.")+"",Ze=Tn("Autocomplete")+"",Ve=Tn("The following rules apply when typing a message:")+"",Ye=Tn('"@" followed by a character will show matching nicks in the current conversation.')+"",Je=Tn('":" followed by a character will show matching emojis.')+"",Qe=Tn('"/" will show the available commands.')+"",Xe=Tn('"#" will show the matching conversation names.')+"",en=Tn("Text formatting")+"",nn=Tn("Convos supports some special way of formatting text:")+"",tn=Object.keys(On).sort().map(e.func).join(", ")+"",an=Tn("Will be automatically converted into emojis.")+"",rn=Tn("> some text")+"",on=Tn('A line starting with ">" will be converted into a quote.')+"",sn=Tn("_some text_, __some text__, ___some text___")+"",cn=Pn('Using "_" around some text, will convert it into _italic_, __bold__ or ___italic bold___.')+"",dn=Tn("`some fragment`")+"",un=Pn("Using backticks around some text, will format it as a `code fragment`.")+"",ln=Tn("URLs will be converted to links, and might be embedded in the chat.")+"",fn=Tn("Available commands")+"",pn=Tn("Resources")+"",gn=Tn("Project homepage")+"",mn=Tn("Bug/issue tracker")+"",hn=Tn("Source code")+"",$n=new Fr({}),vn=new yt({props:{$$slots:{default:[Ro]},$$scope:{ctx:e}}});let bn=_t,yn=[];for(let n=0;n<bn.length;n+=1)yn[n]=jo(Lo(e,bn,n));return{c(){$n.$$.fragment.c(),n=S(),vn.$$.fragment.c(),t=S(),a=O("main"),r=O("p"),i=S(),c=S(),d=O("h2"),u=N(Ke),l=S(),f=O("dl"),p=O("dt"),g=N(Ge),m=O("dd"),h=N(We),$=S(),v=O("h2"),b=N(Ze),y=S(),_=O("p"),A=N(Ve),C=S(),M=O("dl"),(T=O("dt")).textContent="@nick",P=O("dd"),L=N(Ye),(R=O("dt")).textContent=":emoji_name",I=O("dd"),U=N(Je),(B=O("dt")).textContent="/command",H=O("dd"),z=N(Qe),(q=O("dt")).textContent="#conversation",F=O("dd"),K=N(Xe),G=S(),W=O("h2"),Z=N(en),V=S(),Y=O("p"),J=N(nn),Q=S(),X=O("dl"),ee=O("dt"),ne=N(tn),te=O("dd"),ae=N(an),re=O("dt"),oe=N(rn),ie=O("dd"),se=N(on),ce=O("dt"),de=N(sn),ue=O("dd"),le=O("dt"),ge=N(dn),me=O("dd"),(he=O("dt")).textContent="https://...",$e=O("dd"),ye=N(ln),_e=S(),we=O("h2"),xe=N(fn),ke=S(),Ee=O("dl");for(let e=0;e<yn.length;e+=1)yn[e].c();Oe=S(),Ne=O("h2"),Se=N(pn),Ae=S(),Ce=O("ul"),Me=O("li"),De=O("a"),Te=N(gn),Pe=S(),Le=O("li"),Re=O("a"),je=N(mn),Ie=S(),Ue=O("li"),Be=O("a"),He=N(hn),o=new j(qe,i),s=new j(Fe,null),D(De,"href","http://convos.by"),D(De,"target","_blank"),D(Re,"href","https://github.com/Nordaaker/convos/issues"),D(Re,"target","_blank"),D(Be,"href","https://github.com/Nordaaker/convos"),D(Be,"target","_blank"),D(a,"class","main")},m(e,k){ve($n,e,k),x(e,n,k),ve(vn,e,k),x(e,t,k),x(e,a,k),w(a,r),o.m(r),w(r,i),s.m(r),w(a,c),w(a,d),w(d,u),w(a,l),w(a,f),w(f,p),w(p,g),w(f,m),w(m,h),w(a,$),w(a,v),w(v,b),w(a,y),w(a,_),w(_,A),w(a,C),w(a,M),w(M,T),w(M,P),w(P,L),w(M,R),w(M,I),w(I,U),w(M,B),w(M,H),w(H,z),w(M,q),w(M,F),w(F,K),w(a,G),w(a,W),w(W,Z),w(a,V),w(a,Y),w(Y,J),w(a,Q),w(a,X),w(X,ee),w(ee,ne),w(X,te),w(te,ae),w(X,re),w(re,oe),w(X,ie),w(ie,se),w(X,ce),w(ce,de),w(X,ue),ue.innerHTML=cn,w(X,le),w(le,ge),w(X,me),me.innerHTML=un,w(X,he),w(X,$e),w($e,ye),w(a,_e),w(a,we),w(we,xe),w(a,ke),w(a,Ee);for(let e=0;e<yn.length;e+=1)yn[e].m(Ee,null);w(a,Oe),w(a,Ne),w(Ne,Se),w(a,Ae),w(a,Ce),w(Ce,Me),w(Me,De),w(De,Te),w(Ce,Pe),w(Ce,Le),w(Le,Re),w(Re,je),w(Ce,Ie),w(Ce,Ue),w(Ue,Be),w(Be,He),ze=!0},p(e,n){var t={};if(e.$$scope&&(t.$$scope={changed:e,ctx:n}),vn.$set(t),e.l||e.commands){let t;for(bn=_t,t=0;t<bn.length;t+=1){const a=Lo(n,bn,t);yn[t]?yn[t].p(e,a):(yn[t]=jo(a),yn[t].c(),yn[t].m(Ee,null))}for(;t<yn.length;t+=1)yn[t].d(1);yn.length=bn.length}},i(e){ze||(fe($n.$$.fragment,e),fe(vn.$$.fragment,e),ze=!0)},o(e){pe($n.$$.fragment,e),pe(vn.$$.fragment,e),ze=!1},d(e){be($n,e),e&&k(n),be(vn,e),e&&(k(t),k(a)),E(yn,e)}}}function Uo(e){return{settings:W("settings"),func:e=>On[e]}}class Bo extends _e{constructor(e){super(),ye(this,e,Uo,Io,s,[])}}function Ho(n){var t,a,r=Tn("Convos")+"";return{c(){t=O("span"),a=N(r)},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function zo(n){var t,a=Tn("Login")+"";return{c(){t=N(a)},m(e,n){x(e,t,n)},p:e,d(e){e&&k(t)}}}function qo(n){var t,a=Tn("Create account")+"";return{c(){t=N(a)},m(e,n){x(e,t,n)},p:e,d(e){e&&k(t)}}}function Fo(n){var t,a=Tn("Documentation")+"";return{c(){t=N(a)},m(e,n){x(e,t,n)},p:e,d(e){e&&k(t)}}}function Ko(n){var t,a=Tn("GitHub")+"";return{c(){t=N(a)},m(e,n){x(e,t,n)},p:e,d(e){e&&k(t)}}}function Go(e){var n,t,a,r,o,i,s,c,d,u,l,f=Tn("A multiuser chat application.")+"",p=new Ct({props:{href:"/",$$slots:{default:[Ho]},$$scope:{ctx:e}}}),g=new Ct({props:{href:"/login",$$slots:{default:[zo]},$$scope:{ctx:e}}}),m=new Ct({props:{href:"/register",$$slots:{default:[qo]},$$scope:{ctx:e}}}),h=new Ct({props:{href:"https://convos.by/doc",$$slots:{default:[Fo]},$$scope:{ctx:e}}}),$=new Ct({props:{href:"https://github.com/Nordaaker/convos",$$slots:{default:[Ko]},$$scope:{ctx:e}}});return{c(){n=O("div"),t=O("h1"),p.$$.fragment.c(),a=S(),r=O("p"),o=N(f),i=S(),s=O("nav"),g.$$.fragment.c(),c=S(),m.$$.fragment.c(),d=S(),h.$$.fragment.c(),u=S(),$.$$.fragment.c(),D(s,"class","sidebar-left__nav"),D(n,"class","sidebar-left")},m(e,f){x(e,n,f),w(n,t),ve(p,t,null),w(n,a),w(n,r),w(r,o),w(n,i),w(n,s),ve(g,s,null),w(s,c),ve(m,s,null),w(s,d),ve(h,s,null),w(s,u),ve($,s,null),l=!0},p(e,n){var t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),p.$set(t);var a={};e.$$scope&&(a.$$scope={changed:e,ctx:n}),g.$set(a);var r={};e.$$scope&&(r.$$scope={changed:e,ctx:n}),m.$set(r);var o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),h.$set(o);var i={};e.$$scope&&(i.$$scope={changed:e,ctx:n}),$.$set(i)},i(e){l||(fe(p.$$.fragment,e),fe(g.$$.fragment,e),fe(m.$$.fragment,e),fe(h.$$.fragment,e),fe($.$$.fragment,e),l=!0)},o(e){pe(p.$$.fragment,e),pe(g.$$.fragment,e),pe(m.$$.fragment,e),pe(h.$$.fragment,e),pe($.$$.fragment,e),l=!1},d(e){e&&k(n),be(p),be(g),be(m),be(h),be($)}}}class Wo extends _e{constructor(e){super(),ye(this,e,null,Go,s,[])}}function Zo(n){var t,a,r=Tn("E-mail")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function Vo(n){return{c:e,m:e,p:e,d:e}}function Yo(n){var t,a,r=Tn("Password")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function Jo(n){return{c:e,m:e,p:e,d:e}}function Qo(e){var n,t,a,r,o,i,s,c,d,u,l,f,p,g,m,h,$,v,b=Tn("Log in")+"",y=Tn("Log in")+"",_=Tn("Convos is the simplest way to use IRC and it keeps you always online.")+"",E=new Wo({}),A=new Sa({props:{name:"email",placeholder:Tn("Ex: john@doe.com"),$$slots:{default:[Vo],label:[Zo]},$$scope:{ctx:e}}}),T=new ga({props:{name:"password",$$slots:{default:[Jo],label:[Yo]},$$scope:{ctx:e}}}),P=new da({props:{op:e.loginOp}});return{c(){E.$$.fragment.c(),n=S(),t=O("main"),a=O("h1"),r=N(b),o=S(),i=O("form"),A.$$.fragment.c(),s=S(),T.$$.fragment.c(),c=S(),d=O("div"),u=O("button"),l=N(y),f=S(),P.$$.fragment.c(),p=S(),g=O("article"),m=O("p"),h=N(_),D(u,"class","btn"),D(u,"op",e.loginOp),D(d,"class","form-actions"),D(i,"method","post"),D(t,"class","main align-content-middle"),v=C(i,"submit",M(e.submit_handler))},m(e,v){ve(E,e,v),x(e,n,v),x(e,t,v),w(t,a),w(a,r),w(t,o),w(t,i),ve(A,i,null),w(i,s),ve(T,i,null),w(i,c),w(i,d),w(d,u),w(u,l),w(i,f),ve(P,i,null),w(t,p),w(t,g),w(g,m),w(m,h),$=!0},p(e,n){var t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),A.$set(t);var a={};e.$$scope&&(a.$$scope={changed:e,ctx:n}),T.$set(a)},i(e){$||(fe(E.$$.fragment,e),fe(A.$$.fragment,e),fe(T.$$.fragment,e),fe(P.$$.fragment,e),$=!0)},o(e){pe(E.$$.fragment,e),pe(A.$$.fragment,e),pe(T.$$.fragment,e),pe(P.$$.fragment,e),$=!1},d(e){be(E,e),e&&(k(n),k(t)),be(A),be(T),be(P),v()}}}function Xo(e,n,t){let a;const r=W("user"),o=r.api.operation("loginUser");u(e,o,e=>{t("$loginOp",a=e)});return e.$$.update=(e={$loginOp:1})=>{e.$loginOp&&a.is("success")&&(document.cookie=o.res.headers["Set-Cookie"],o.reset(),r.load())},{loginOp:o,submit_handler:e=>o.perform(e.target)}}class ei extends _e{constructor(e){super(),ye(this,e,Xo,Qo,s,[])}}function ni(n){var t,a,r=Tn("E-mail")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function ti(n){return{c:e,m:e,p:e,d:e}}function ai(n){var t,a,r=Tn("Password")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function ri(n){return{c:e,m:e,p:e,d:e}}function oi(n){var t,a,r=Tn("Invite code")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function ii(n){return{c:e,m:e,p:e,d:e}}function si(e){var n,t,a,r,o,i,s,c,d,u,l,f,p,g,m,h,$,v,b,y,_,E=Tn("Create account")+"",A=Tn("Your email will be used if you forget your password.")+"",T=Tn("Hint: Use a phrase from a book.")+"",P=Tn("Register")+"",L=new Wo({}),R=new Sa({props:{name:"email",placeholder:Tn("Ex: john@doe.com"),$$slots:{default:[ti],label:[ni]},$$scope:{ctx:e}}}),j=new ga({props:{name:"password",$$slots:{default:[ri],label:[ai]},$$scope:{ctx:e}}}),I=e.settings.invite_code&&function(e){var n,t,a,r=Pn("Ask %1 for an invite code.",e.settings.contact)+"",o=new Sa({props:{name:"invite_code",$$slots:{default:[ii],label:[oi]},$$scope:{ctx:e}}});return{c(){o.$$.fragment.c(),n=S(),D(t=O("p"),"class","help")},m(e,i){ve(o,e,i),x(e,n,i),x(e,t,i),t.innerHTML=r,a=!0},p(e,n){var t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),o.$set(t)},i(e){a||(fe(o.$$.fragment,e),a=!0)},o(e){pe(o.$$.fragment,e),a=!1},d(e){be(o,e),e&&(k(n),k(t))}}}(e),U=new da({props:{op:e.registerOp}});return{c(){L.$$.fragment.c(),n=S(),t=O("main"),a=O("h1"),r=N(E),o=S(),i=O("form"),R.$$.fragment.c(),s=S(),c=O("p"),d=N(A),u=S(),j.$$.fragment.c(),l=S(),f=O("p"),p=N(T),g=S(),I&&I.c(),m=S(),h=O("div"),$=O("button"),v=N(P),b=S(),U.$$.fragment.c(),D(c,"class","help"),D(f,"class","help"),D($,"class","btn"),D($,"op",e.registerOp),D(h,"class","form-actions"),D(i,"method","post"),D(t,"class","main align-content-middle"),_=C(i,"submit",M(e.submit_handler))},m(e,_){ve(L,e,_),x(e,n,_),x(e,t,_),w(t,a),w(a,r),w(t,o),w(t,i),ve(R,i,null),w(i,s),w(i,c),w(c,d),w(i,u),ve(j,i,null),w(i,l),w(i,f),w(f,p),w(i,g),I&&I.m(i,null),w(i,m),w(i,h),w(h,$),w($,v),w(i,b),ve(U,i,null),y=!0},p(e,n){var t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),R.$set(t);var a={};e.$$scope&&(a.$$scope={changed:e,ctx:n}),j.$set(a),n.settings.invite_code&&I.p(e,n)},i(e){y||(fe(L.$$.fragment,e),fe(R.$$.fragment,e),fe(j.$$.fragment,e),fe(I),fe(U.$$.fragment,e),y=!0)},o(e){pe(L.$$.fragment,e),pe(R.$$.fragment,e),pe(j.$$.fragment,e),pe(I),pe(U.$$.fragment,e),y=!1},d(e){be(L,e),e&&(k(n),k(t)),be(R),be(j),I&&I.d(),be(U),_()}}}function ci(e,n,t){let a;const r=W("settings"),o=W("user"),i=o.api.operation("registerUser");u(e,i,e=>{t("$registerOp",a=e)});return e.$$.update=(e={$registerOp:1})=>{e.$registerOp&&a.is("success")&&(document.cookie=i.res.headers["Set-Cookie"],i.reset(),o.load())},{settings:r,registerOp:i,submit_handler:e=>i.perform(e.target)}}class di extends _e{constructor(e){super(),ye(this,e,ci,si,s,[])}}function ui(n){var t,a,r=Tn("Settings")+"";return{c(){t=O("h1"),a=N(r)},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function li(n){var t,a,r=Tn("Email")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function fi(n){return{c:e,m:e,p:e,d:e}}function pi(n){var t,a,r=Tn("Notification keywords")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function gi(n){return{c:e,m:e,p:e,d:e}}function mi(n){var t,a,r=Tn("Enable notifications")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function hi(n){return{c:e,m:e,p:e,d:e}}function $i(n){var t,a,r=Tn("You cannot receive notifications, because it is denied by your browser.")+"";return{c(){t=O("p"),a=N(r),D(t,"class","error")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function vi(n){var t,a,r=Tn("Expand URL to media")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function bi(n){return{c:e,m:e,p:e,d:e}}function yi(n){var t,a,r=Tn("Password")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function _i(n){return{c:e,m:e,p:e,d:e}}function wi(n){var t,a,r=Tn("Repeat password")+"";return{c(){t=O("span"),a=N(r),D(t,"slot","label")},m(e,n){x(e,t,n),w(t,a)},p:e,d(e){e&&k(t)}}}function xi(n){return{c:e,m:e,p:e,d:e}}function ki(n){var t,a=Tn("Save settings")+"";return{c(){t=N(a)},m(e,n){x(e,t,n)},p:e,d(e){e&&k(t)}}}function Ei(e){var n,t,a,r,o,i,s,c,d,u,l,f,p,g,m,h,$,v,b,y,_=Tn("Leave the password fields empty to keep the current password.")+"",E=new Fr({}),A=new yt({props:{$$slots:{default:[ui]},$$scope:{ctx:e}}}),T=new Sa({props:{name:"email",value:e.$user.email,readonly:!0,$$slots:{default:[fi],label:[li]},$$scope:{ctx:e}}}),P=new Sa({props:{name:"highlight_keywords",placeholder:Tn("whatever, keywords"),$$slots:{default:[gi],label:[pi]},$$scope:{ctx:e}}});function L(n){e.checkbox0_checked_binding.call(null,n),s=!0,re(()=>s=!1)}let R={name:"notifications",$$slots:{default:[hi],label:[mi]},$$scope:{ctx:e}};void 0!==e.wantNotifications&&(R.checked=e.wantNotifications);var j=new oa({props:R});Y.push(()=>$e(j,"checked",L));var I=e.notificationsDisabled&&$i();function U(n){e.checkbox1_checked_binding.call(null,n),u=!0,re(()=>u=!1)}let B={name:"expand_url",$$slots:{default:[bi],label:[vi]},$$scope:{ctx:e}};void 0!==e.expandUrlToMedia&&(B.checked=e.expandUrlToMedia);var H=new oa({props:B});Y.push(()=>$e(H,"checked",U));var z=new ga({props:{name:"password",$$slots:{default:[_i],label:[yi]},$$scope:{ctx:e}}}),q=new ga({props:{name:"password_again",$$slots:{default:[xi],label:[wi]},$$scope:{ctx:e}}}),F=new ea({props:{icon:"save",op:e.updateUserOp,$$slots:{default:[ki]},$$scope:{ctx:e}}}),K=new da({props:{op:e.updateUserOp}});return{c(){E.$$.fragment.c(),n=S(),A.$$.fragment.c(),t=S(),a=O("main"),r=O("form"),T.$$.fragment.c(),o=S(),P.$$.fragment.c(),i=S(),j.$$.fragment.c(),c=S(),I&&I.c(),d=S(),H.$$.fragment.c(),l=S(),z.$$.fragment.c(),f=S(),q.$$.fragment.c(),p=S(),g=O("p"),m=N(_),h=S(),$=O("div"),F.$$.fragment.c(),v=S(),K.$$.fragment.c(),D($,"class","form-actions"),D(r,"method","post"),D(a,"class","main"),y=C(r,"submit",M(e.updateUserFromForm))},m(s,u){ve(E,s,u),x(s,n,u),ve(A,s,u),x(s,t,u),x(s,a,u),w(a,r),ve(T,r,null),w(r,o),ve(P,r,null),w(r,i),ve(j,r,null),w(r,c),I&&I.m(r,null),w(r,d),ve(H,r,null),w(r,l),ve(z,r,null),w(r,f),ve(q,r,null),w(r,p),w(r,g),w(g,m),w(r,h),w(r,$),ve(F,$,null),w(r,v),ve(K,r,null),e.form_binding(r),b=!0},p(e,n){var t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),A.$set(t);var a={};e.$user&&(a.value=n.$user.email),e.$$scope&&(a.$$scope={changed:e,ctx:n}),T.$set(a);var o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),P.$set(o);var i={};e.$$scope&&(i.$$scope={changed:e,ctx:n}),!s&&e.wantNotifications&&(i.checked=n.wantNotifications),j.$set(i),n.notificationsDisabled?I?I.p(e,n):((I=$i()).c(),I.m(r,d)):I&&(I.d(1),I=null);var c={};e.$$scope&&(c.$$scope={changed:e,ctx:n}),!u&&e.expandUrlToMedia&&(c.checked=n.expandUrlToMedia),H.$set(c);var l={};e.$$scope&&(l.$$scope={changed:e,ctx:n}),z.$set(l);var f={};e.$$scope&&(f.$$scope={changed:e,ctx:n}),q.$set(f);var p={};e.$$scope&&(p.$$scope={changed:e,ctx:n}),F.$set(p)},i(e){b||(fe(E.$$.fragment,e),fe(A.$$.fragment,e),fe(T.$$.fragment,e),fe(P.$$.fragment,e),fe(j.$$.fragment,e),fe(H.$$.fragment,e),fe(z.$$.fragment,e),fe(q.$$.fragment,e),fe(F.$$.fragment,e),fe(K.$$.fragment,e),b=!0)},o(e){pe(E.$$.fragment,e),pe(A.$$.fragment,e),pe(T.$$.fragment,e),pe(P.$$.fragment,e),pe(j.$$.fragment,e),pe(H.$$.fragment,e),pe(z.$$.fragment,e),pe(q.$$.fragment,e),pe(F.$$.fragment,e),pe(K.$$.fragment,e),b=!1},d(r){be(E,r),r&&k(n),be(A,r),r&&(k(t),k(a)),be(T),be(P),be(j),I&&I.d(),be(H),be(z),be(q),be(F),be(K),e.form_binding(null),y()}}}function Oi(e,n,t){let a;const r=window.Notification||{permission:"denied"},o=W("user");u(e,o,e=>{t("$user",a=e)});const i=o.api.operation("updateUser");let s,c="denied"==r.permission,d=o.events.wantNotifications,l=o.expandUrlToMedia;return{user:o,updateUserOp:i,formEl:s,notificationsDisabled:c,wantNotifications:d,expandUrlToMedia:l,updateUserFromForm:function(e){const n=e.target,a=[n.password.value,n.password_again.value];if(d&&window.Notification&&"granted"!=r.permission&&r.requestPermission(e=>{"denied"==e&&(t("wantNotifications",d=!1),t("notificationsDisabled",c=!0))}),a.join("").length&&a[0]!=a[1])return i.error("Passwords does not match.");o.update({expandUrlToMedia:l,wantNotifications:d}),i.perform(e.target)},$user:a,checkbox0_checked_binding:function(e){t("wantNotifications",d=e)},checkbox1_checked_binding:function(e){t("expandUrlToMedia",l=e)},form_binding:function(e){Y[e?"unshift":"push"](()=>{t("formEl",s=e)})}}}class Ni extends _e{constructor(e){super(),ye(this,e,Oi,Ei,s,[])}}const{window:Si}=he;function Ai(e){var n,t,a;return{c(){(n=O("div")).textContent="",D(n,"class","overlay")},m(e,t){x(e,n,t),a=!0},i(e){a||(ae(()=>{t||(t=me(n,pt,{duration:200},!0)),t.run(1)}),a=!0)},o(e){t||(t=me(n,pt,{duration:200},!1)),t.run(0),a=!1},d(e){e&&(k(n),t&&t.end())}}}function Ci(e){var n,t,a,r;ae(e.onwindowresize);var i=e.pageComponent;if(i)var s=new i({});var c=e.$activeMenu&&e.$container.small&&Ai();return{c(){s&&s.$$.fragment.c(),n=S(),c&&c.c(),t=A(),r=[C(Si,"click",Mi),C(Si,"focus",e.onWindowFocus),C(Si,"keydown",Di),C(Si,"resize",e.onwindowresize)]},m(e,r){s&&ve(s,e,r),x(e,n,r),c&&c.m(e,r),x(e,t,r),a=!0},p(e,a){if(i!==(i=a.pageComponent)){if(s){ue();const e=s;pe(e.$$.fragment,1,0,()=>{be(e,1)}),le()}i?((s=new i({})).$$.fragment.c(),fe(s.$$.fragment,1),ve(s,n.parentNode,n)):s=null}a.$activeMenu&&a.$container.small?c?fe(c,1):((c=Ai()).c(),fe(c,1),c.m(t.parentNode,t)):c&&(ue(),pe(c,1,1,()=>{c=null}),le())},i(e){a||(s&&fe(s.$$.fragment,e),fe(c),a=!0)},o(e){s&&pe(s.$$.fragment,e),pe(c),a=!1},d(e){s&&be(s,e),e&&k(n),c&&c.d(e),e&&k(t),o(r)}}}function Mi(e){}function Di(e){if(!e.shiftKey||13!=e.keyCode)return;e.preventDefault();const n=document.getElementById("sidebar_left_search_input"),t=document.activeElement;if(t!=n&&!Qe(t,"body"))return n.focus();const a=["#chat_input_textarea",'.main input[type="text"]',".main a","#sidebar_left_search_input"];for(let e=0;e<a.length;e++){const n=document.querySelector(a[e]);if(n)return n.focus()}}function Ti(e,n){const t=document.querySelector("body");t.className=t.className.replace(e,(e,t)=>t+n)}function Pi(e,n,t){let a,r,o,i,s,c;u(e,ut,e=>{t("$currentUrl",a=e)}),u(e,lt,e=>{t("$docTitle",i=e)}),u(e,ct,e=>{t("$activeMenu",s=e)}),u(e,dt,e=>{t("$container",c=e)}),window.hljs=rn;const d={"add/connection":lo,"add/conversation":Po,chat:so,help:Bo,settings:Ni},l={login:ei,register:di},f=[window.__convos,delete window.__convos][0],p=new an(f.apiUrl,{debug:!0}),m=new et({api:p,wsUrl:f.wsUrl}),h=m.getUserOp;u(e,h,e=>{t("$getUserOp",r=e)});const $=m.notifications;u(e,$,e=>{t("$notifications",o=e)});let v=0,b=null;function y(e){let n=["","chat"];if(e.connection_id&&n.push(e.connection_id),g(ct,s=""),"part"==e.type){const e=document.querySelector('.sidebar-left [href$="'+n.map(encodeURIComponent).join("/")+'"]');ot(e?e.href:"/chat")}else e.dialog_id&&n.push(e.dialog_id),ot(n.map(encodeURIComponent).join("/"))}function _(e){const n=Fe(e.target,"a");if(Fe(e.target,".sidebar-left")&&!n)return;const t=n&&n.href.match(/#(activeMenu):(\w*)/)||["","",""];(t[1]||s)&&e.preventDefault(),g(ct,s=t[2]==s?"":t[2])}return ut.base=f.baseUrl,G("settings",f),G("user",m),K(async()=>{if(!f.chatMode)return;const e=m.on("dialogEvent",y),n=function(){var e=function(){return ut.set(it(location.href))};return window.addEventListener("popstate",e),function(){return window.removeEventListener("popstate",e)}}();return m.load(),document.addEventListener("click",_),m.showGrid&&document.querySelector("body").classList.add("with-grid"),()=>{document.removeEventListener("click",_),e(),n()}}),e.$$.update=(e={containerWidth:1,$currentUrl:1,$getUserOp:1,$notifications:1,$docTitle:1})=>{e.containerWidth&&dt.set({small:v<800,width:v}),(e.$currentUrl||e.$getUserOp)&&function(e,n){"chat"==e.pathParts[0]&&m.update({lastUrl:e.toString()});const a=n.is("success"),r=a?d:l,o=r[e.path]?e.path:e.pathParts[0]||"",i=r[o];if(a&&We(ut.base+"/images/emojis.js"),i)i!=b&&t("pageComponent",b=i),Ti(/(is-logged-)\S+/,a?"in":"out"),Ti(/(page-)\S+/,o.replace(/\W+/g,"_")||"loading");else if(a){ot(m.lastUrl||(m.connections.size?"/chat":"/add/connection"),{replace:!0})}else n.is("error")&&ot("/login",{replace:!0});const s=document.querySelectorAll(".js-remove");for(let e=0;e<s.length;e++)s[e].remove()}(a,r),(e.$notifications||e.$docTitle)&&document&&(document.title=o.unread?"("+o.unread+") "+i:i)},{getUserOp:h,notifications:$,containerWidth:v,pageComponent:b,onWindowFocus:function(){f.chatMode&&m.events.ensureConnected()},$activeMenu:s,$container:c,onwindowresize:function(){v=Si.innerWidth,t("containerWidth",v)}}}console.log("[Convos] Initializing application.");var Li=document.querySelector("body");new class extends _e{constructor(e){super(),ye(this,e,Pi,Ci,s,[])}}({target:document.body});Li.classList=Li.className.replace(/no-js/,"has-js"),"serviceWorker"in navigator&&window.addEventListener("load",(function(e){navigator.serviceWorker.register("/sw.js").then((function(e){return window.updateServiceWorker&&e.update()}),(function(e){return console.log("[Convos] ServiceWorker registration failed:",e)}))}))}();
//# sourceMappingURL=convos.5db3ca63.js.map
