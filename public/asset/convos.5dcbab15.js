!function(){"use strict";function e(){}const n=e=>e;function t(e,n){for(const t in n)e[t]=n[t];return e}function o(e){return e()}function a(){return Object.create(null)}function i(e){e.forEach(o)}function r(e){return"function"==typeof e}function s(e,n){return e!=e?n==n:e!==n||e&&"object"==typeof e||"function"==typeof e}function c(e,n){const t=e.subscribe(n);return t.unsubscribe?()=>t.unsubscribe():t}function d(e){let n;return c(e,e=>n=e)(),n}function u(e,n,t){e.$$.on_destroy.push(c(n,t))}function l(e,n,t){if(e){const o=f(e,n,t);return e[0](o)}}function f(e,n,o){return e[1]?t({},t(n.$$scope.ctx,e[1](o?o(n):{}))):n.$$scope.ctx}function p(e,n,o,a){return e[1]?t({},t(n.$$scope.changed||{},e[1](a?a(o):{}))):n.$$scope.changed||{}}function g(e,n,t=n){return e.set(t),n}const m=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),h="undefined"!=typeof window;let $=h?()=>window.performance.now():()=>Date.now(),b=h?e=>requestAnimationFrame(e):e;const v=new Set;let y,_=!1;function w(){v.forEach(e=>{e[0]($())||(v.delete(e),e[1]())}),(_=v.size>0)&&b(w)}function x(e,n){e.appendChild(n)}function k(e,n,t){e.insertBefore(n,t||null)}function E(e){e.parentNode.removeChild(e)}function O(e,n){for(let t=0;t<e.length;t+=1)e[t]&&e[t].d(n)}function N(e){return document.createElement(e)}function C(e){return document.createTextNode(e)}function S(){return C(" ")}function D(){return C("")}function P(e,n,t,o){return e.addEventListener(n,t,o),()=>e.removeEventListener(n,t,o)}function M(e){return function(n){return n.preventDefault(),e.call(this,n)}}function A(e,n,t){null==t?e.removeAttribute(n):e.getAttribute(n)!==t&&e.setAttribute(n,t)}function R(e,n){n=""+n,e.data!==n&&(e.data=n)}function T(e,n){(null!=n||e.value)&&(e.value=n)}function L(e,n,t,o){e.style.setProperty(n,t,o?"important":"")}function j(e,n,t){e.classList[t?"add":"remove"](n)}class I{constructor(e,n=null){this.e=N("div"),this.a=n,this.u(e)}m(e,n=null){for(let t=0;t<this.n.length;t+=1)k(e,this.n[t],n);this.t=e}u(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}p(e){this.d(),this.u(e),this.m(this.t,this.a)}d(){this.n.forEach(E)}}let U,z=0,B={};function H(e,n,t,o,a,i,r,s=0){const c=16.666/o;let d="{\n";for(let e=0;e<=1;e+=c){const o=n+(t-n)*i(e);d+=100*e+`%{${r(o,1-o)}}\n`}const u=d+`100% {${r(t,1-t)}}\n}`,l=`__svelte_${function(e){let n=5381,t=e.length;for(;t--;)n=(n<<5)-n^e.charCodeAt(t);return n>>>0}(u)}_${s}`;if(!B[l]){if(!y){const e=N("style");document.head.appendChild(e),y=e.sheet}B[l]=!0,y.insertRule(`@keyframes ${l} ${u}`,y.cssRules.length)}const f=e.style.animation||"";return e.style.animation=`${f?`${f}, `:""}${l} ${o}ms linear ${a}ms 1 both`,z+=1,l}function q(e,n){e.style.animation=(e.style.animation||"").split(", ").filter(n?e=>e.indexOf(n)<0:e=>-1===e.indexOf("__svelte")).join(", "),n&&!--z&&b(()=>{if(z)return;let e=y.cssRules.length;for(;e--;)y.deleteRule(e);B={}})}function F(e){U=e}function K(){if(!U)throw new Error("Function called outside component initialization");return U}function G(e){K().$$.on_mount.push(e)}function W(e,n){K().$$.context.set(e,n)}function V(e){return K().$$.context.get(e)}function Z(e,n){const t=e.$$.callbacks[n.type];t&&t.slice().forEach(e=>e(n))}const Y=[],J=[],Q=[],X=[],ee=Promise.resolve();let ne,te=!1;function oe(){te||(te=!0,ee.then(re))}function ae(e){Q.push(e)}function ie(e){X.push(e)}function re(){const e=new Set;do{for(;Y.length;){const e=Y.shift();F(e),se(e.$$)}for(;J.length;)J.pop()();for(let n=0;n<Q.length;n+=1){const t=Q[n];e.has(t)||(t(),e.add(t))}Q.length=0}while(Y.length);for(;X.length;)X.pop()();te=!1}function se(e){null!==e.fragment&&(e.update(e.dirty),i(e.before_update),e.fragment&&e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_update.forEach(ae))}function ce(e,n,t){e.dispatchEvent(function(e,n){const t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!1,!1,n),t}(`${n?"intro":"outro"}${t}`))}const de=new Set;let ue;function le(){ue={r:0,c:[],p:ue}}function fe(){ue.r||i(ue.c),ue=ue.p}function pe(e,n){e&&e.i&&(de.delete(e),e.i(n))}function ge(e,n,t,o){if(e&&e.o){if(de.has(e))return;de.add(e),ue.c.push(()=>{de.delete(e),o&&(t&&e.d(1),o())}),e.o(n)}}const me={duration:0};function he(t,o,a,s){let c=o(t,a),d=s?0:1,u=null,l=null,f=null;function p(){f&&q(t,f)}function g(e,n){const t=e.b-d;return n*=Math.abs(t),{a:d,b:e.b,d:t,duration:n,start:e.start,end:e.start+n,group:e.group}}function m(o){const{delay:a=0,duration:r=300,easing:s=n,tick:m=e,css:h}=c||me,y={start:$()+a,b:o};o||(y.group=ue,ue.r+=1),u?l=y:(h&&(p(),f=H(t,d,o,r,a,s,h)),o&&m(0,1),u=g(y,r),ae(()=>ce(t,o,"start")),function(e){let n;_||(_=!0,b(w)),new Promise(t=>{v.add(n=[e,t])})}(e=>{if(l&&e>l.start&&(u=g(l,r),l=null,ce(t,u.b,"start"),h&&(p(),f=H(t,d,u.b,u.duration,0,s,c.css))),u)if(e>=u.end)m(d=u.b,1-d),ce(t,u.b,"end"),l||(u.b?p():--u.group.r||i(u.group.c)),u=null;else if(e>=u.start){const n=e-u.start;d=u.a+u.d*s(n/u.duration),m(d,1-d)}return!(!u&&!l)}))}return{run(e){r(c)?(ne||(ne=Promise.resolve()).then(()=>{ne=null}),ne).then(()=>{c=c(),m(e)}):m(e)},end(){p(),u=l=null}}}const $e="undefined"!=typeof window?window:global;function be(e,n,t){m(e.$$.props,n)&&(n=e.$$.props[n]||n,e.$$.bound[n]=t,t(e.$$.ctx[n]))}function ve(e){e&&e.c()}function ye(e,n,t){const{fragment:a,on_mount:s,on_destroy:c,after_update:d}=e.$$;a&&a.m(n,t),ae(()=>{const n=s.map(o).filter(r);c?c.push(...n):i(n),e.$$.on_mount=[]}),d.forEach(ae)}function _e(e,n){const t=e.$$;null!==t.fragment&&(i(t.on_destroy),t.fragment&&t.fragment.d(n),t.on_destroy=t.fragment=null,t.ctx={})}function we(n,t,o,r,s,c){const d=U;F(n);const u=t.props||{},l=n.$$={fragment:null,ctx:null,props:c,update:e,not_equal:s,bound:a(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:a(),dirty:null};let f=!1;l.ctx=o?o(n,u,(e,t,o=t)=>(l.ctx&&s(l.ctx[e],l.ctx[e]=o)&&(l.bound[e]&&l.bound[e](o),f&&function(e,n){e.$$.dirty||(Y.push(e),oe(),e.$$.dirty=a()),e.$$.dirty[n]=!0}(n,e)),t)):u,l.update(),f=!0,i(l.before_update),l.fragment=!!r&&r(l.ctx),t.target&&(t.hydrate?l.fragment&&l.fragment.l(function(e){return Array.from(e.childNodes)}(t.target)):l.fragment&&l.fragment.c(),t.intro&&pe(n.$$.fragment),ye(n,t.target,t.anchor),re()),F(d)}class xe{$destroy(){_e(this,1),this.$destroy=e}$on(e,n){const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const e=t.indexOf(n);-1!==e&&t.splice(e,1)}}$set(){}}function ke(e,n){return e(n={exports:{}},n.exports),n.exports}var Ee=ke((function(e){var n=function(e){var n,t=Object.prototype,o=t.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",r=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function c(e,n,t,o){var a=n&&n.prototype instanceof m?n:m,i=Object.create(a.prototype),r=new N(o||[]);return i._invoke=function(e,n,t){var o=u;return function(a,i){if(o===f)throw new Error("Generator is already running");if(o===p){if("throw"===a)throw i;return S()}for(t.method=a,t.arg=i;;){var r=t.delegate;if(r){var s=k(r,t);if(s){if(s===g)continue;return s}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(o===u)throw o=p,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);o=f;var c=d(e,n,t);if("normal"===c.type){if(o=t.done?p:l,c.arg===g)continue;return{value:c.arg,done:t.done}}"throw"===c.type&&(o=p,t.method="throw",t.arg=c.arg)}}}(e,t,r),i}function d(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var u="suspendedStart",l="suspendedYield",f="executing",p="completed",g={};function m(){}function h(){}function $(){}var b={};b[i]=function(){return this};var v=Object.getPrototypeOf,y=v&&v(v(C([])));y&&y!==t&&o.call(y,i)&&(b=y);var _=$.prototype=m.prototype=Object.create(b);function w(e){["next","throw","return"].forEach((function(n){e[n]=function(e){return this._invoke(n,e)}}))}function x(e){var n;this._invoke=function(t,a){function i(){return new Promise((function(n,i){!function n(t,a,i,r){var s=d(e[t],e,a);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==typeof u&&o.call(u,"__await")?Promise.resolve(u.__await).then((function(e){n("next",e,i,r)}),(function(e){n("throw",e,i,r)})):Promise.resolve(u).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,r)}))}r(s.arg)}(t,a,n,i)}))}return n=n?n.then(i,i):i()}}function k(e,t){var o=e.iterator[t.method];if(o===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,k(e,t),"throw"===t.method))return g;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var a=d(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,g;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,g):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function E(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function O(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,r=function t(){for(;++a<e.length;)if(o.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=n,t.done=!0,t};return r.next=r}}return{next:S}}function S(){return{value:n,done:!0}}return h.prototype=_.constructor=$,$.constructor=h,$[s]=h.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===h||"GeneratorFunction"===(n.displayName||n.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,$):(e.__proto__=$,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},w(x.prototype),x.prototype[r]=function(){return this},e.AsyncIterator=x,e.async=function(n,t,o,a){var i=new x(c(n,t,o,a));return e.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(_),_[s]="Generator",_[i]=function(){return this},_.toString=function(){return"[object Generator]"},e.keys=function(e){var n=[];for(var t in e)n.push(t);return n.reverse(),function t(){for(;n.length;){var o=n.pop();if(o in e)return t.value=o,t.done=!1,t}return t.done=!0,t}},e.values=C,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(o,a){return s.type="throw",s.arg=e,t.next=o,a&&(t.method="next",t.arg=n),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return a("end");if(r.tryLoc<=this.prev){var c=o.call(r,"catchLoc"),d=o.call(r,"finallyLoc");if(c&&d){if(this.prev<r.catchLoc)return a(r.catchLoc,!0);if(this.prev<r.finallyLoc)return a(r.finallyLoc)}else if(c){if(this.prev<r.catchLoc)return a(r.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return a(r.finallyLoc)}}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var r=i?i.completion:{};return r.type=e,r.arg=n,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(r)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),g},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),O(t),g}},catch:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===e){var o=t.completion;if("throw"===o.type){var a=o.arg;O(t)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:C(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=n),g}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}}));var Oe=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")};function Ne(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var Ce=function(e,n,t){return n&&Ne(e.prototype,n),t&&Ne(e,t),e},Se=ke((function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t(o){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=t=function(e){return n(e)}:e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},t(o)}e.exports=t}));var De=function(e){if(Array.isArray(e))return e};var Pe=function(e,n){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var t=[],o=!0,a=!1,i=void 0;try{for(var r,s=e[Symbol.iterator]();!(o=(r=s.next()).done)&&(t.push(r.value),!n||t.length!==n);o=!0);}catch(e){a=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw i}}return t}};var Me=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")};var Ae=function(e,n){return De(e)||Pe(e,n)||Me()};var Re=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e};var Te=function(e,n){return!n||"object"!==Se(n)&&"function"!=typeof n?Re(e):n},Le=ke((function(e){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n})),je=ke((function(e){function n(t,o){return e.exports=n=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},n(t,o)}e.exports=n}));var Ie=function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&je(e,n)};var Ue=function(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e},ze=function(){function e(){Oe(this,e),this._on={},this._proxyTo={},this._reactiveProp={},this._syncWithLocalStorage={}}return Ce(e,[{key:"emit",value:function(e,n){var t=this._on[e];if(!t)return this;for(var o=0;o<t.length;o++)t[o][0](n);return this}},{key:"on",value:function(e,n){var t=n?null:new Promise((function(e){n=e})),o=this._on[e]||(this._on[e]=[]),a=[n];o.push(a);var i=function(){var e=o.indexOf(a);-1!=e&&o.splice(e,1)};return t?t.finally(i):i}},{key:"prop",value:function(e,n,t){switch(e){case"persist":return this._localStorageProp(n,t);case"proxy":return this._proxyProp(n,t);case"ro":return this._readOnlyProp(n,t);case"rw":return this._updateableProp(n,t)}throw'Unknown prop type "'+e+'" for prop "'+n+'".'}},{key:"subscribe",value:function(e){return e(this),this.on("update",e)}},{key:"update",value:function(e){for(var n=this,t=Object.keys(e),o=t.length,a=0;a<t.length;a++){var i=t[a];this._proxyTo[i]?this[this._proxyTo[i]].update(Ue({},i,e[i])):this._reactiveProp.hasOwnProperty(i)&&(this._reactiveProp[i]===e[i]&&o--,this._reactiveProp[i]=e[i]),this._syncWithLocalStorage[i]&&this._localStorage(i,this._reactiveProp[i])}return o&&!this._updatedTid&&(this._updatedTid=setTimeout((function(){delete n._updatedTid,n.emit("update",n)}),1)),this}},{key:"_localStorage",value:function(e,n){return e="convos:"+e,2==arguments.length?localStorage.setItem(e,JSON.stringify(n)):localStorage.hasOwnProperty(e)?JSON.parse(localStorage.getItem(e)):void 0}},{key:"_localStorageProp",value:function(e,n){var t=this._localStorage(e);this._updateableProp(e,void 0===t?n:t),this._syncWithLocalStorage[e]=!0,void 0===t&&this._localStorage(e,n)}},{key:"_proxyProp",value:function(e,n){var t=this;this._proxyTo[e]=n,Object.defineProperty(this,e,{get:function(){return t[n]._reactiveProp[e]}})}},{key:"_readOnlyProp",value:function(e,n){if(void 0===n)throw'Read-only attribute "'+e+'" cannot be undefined for '+this.constructor.name;var t="function"==typeof n?{get:n}:{value:n,writable:!1};Object.defineProperty(this,e,t)}},{key:"_updateableProp",value:function(e,n){var t=this;this._reactiveProp[e]=n,Object.defineProperty(this,e,{get:function(){return t._reactiveProp[e]}})}}]),e}(),Be=.618033988749;function He(e,n){for(;e;){if(n.tagName?e==n:e.matches&&e.matches(n))return e;e=e.parentNode}return null}function qe(e,n){var t;return function(){for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];var r=this;t&&clearTimeout(t),t=setTimeout((function(){e.apply(r,a)}),n)}}function Fe(e,n,t){var o=e&&e.querySelector("."+n.split(" ").join("."));return o||((o=document.createElement("div")).className=n,e&&e.appendChild(o),t&&t(o),o)}function Ke(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"message",t=e.errors||e;return t&&t[0]?t[0][n]||"Unknown error.":""}function Ge(e){var n=document,t=e.replace(/\W/g,"_");if(!n.getElementById(t)){var o=n.createElement("script"),a=[t,e];o.id=a[0],o.src=a[1],n.getElementsByTagName("head")[0].appendChild(o)}}function We(e){return Object.keys(e).filter((function(n){return e[n]})).map((function(e){return"has-mode-"+e})).join(" ")}function Ve(e,n,t){var o=e.querySelectorAll(n);if(!t)return[].slice.call(o,0);for(var a=[],i=0;i<o.length;i++)a.push(t(o[i],i));return a}function Ze(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function Ye(e,n,t){var o=document.querySelector(e);o.className=o.className.replace(n,(function(e,n){return n+t}))}function Je(e,n){return"is-visible"===n?!e.hasAttribute("hidden"):("toggle"===n&&(n=e.hasAttribute("hidden")),n?e.removeAttribute("hidden"):e.setAttribute("hidden",""))}function Qe(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;if(0==e.length)return"#000";for(var t=0,o=0;o<e.length;o++)t=e.charCodeAt(o)+((t<<5)-t),t&=t;return"#"+function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.95,o=Math.floor(6*e),a=6*e-o,i=t*(1-n),r=t*(1-a*n),s=t*(1-(1-a)*n),c=255,d=255,u=255;switch(o){case 0:c=t,d=s,u=i;break;case 1:c=r,d=t,u=i;break;case 2:c=i,d=t,u=s;break;case 3:c=i,d=r,u=t;break;case 4:c=s,d=i,u=t;break;case 5:c=t,d=i,u=r}return[Math.floor(255*c),Math.floor(255*d),Math.floor(255*u)]}(((t=Math.abs(t%n/n))+Be)%1,.4,.7).map((function(e){return e.toString(16)})).join("")}function Xe(e,n){return e&&e.tagName&&e.tagName.toLowerCase()===n}function en(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)}))}var nn=["error","loading","pending","success"],tn=function(e){function n(e){var t;return Oe(this,n),(t=Te(this,Le(n).call(this))).prop("ro","api",e.api),t.prop("ro","defaultParams",e.defaultParams||{}),t.prop("ro","id",e.id),t.prop("ro","req",{body:null,headers:{}}),t.prop("ro","res",{body:{},headers:{}}),t.prop("rw","err",null),t.prop("rw","status","pending"),t}return Ie(n,e),Ce(n,[{key:"error",value:function(e,n){if(e)return this.update({err:Array.isArray(e)?e:[{message:e,source:n}],status:"error"});if(!this.err||!this.err.length)return"";var t=this.err[0],o=t.path&&t.path.match(/\w$/)&&t.path.split("/").pop();return o?o+": "+t.message:t.message}},{key:"perform",value:function(e){var n=this;return this._promise||(this._promise=new Promise((function(t){n.api.spec(n.id).then((function(o){if(!o)return t(n.error('Invalid operationId "'+n.id+'".',"spec"));n.update({status:"loading"});var a=n._paramsToRequest(o,e||n.defaultParams),i=Ae(a,2),r=i[0],s=i[1];return n.emit("start",s),"object"==Se(s.body)&&(s.body=JSON.stringify(s.body)),fetch(r,s)})).then((function(e){return Promise.all([e,e.json()])})).then((function(e){var o=Ae(e,2),a=o[0],i=o[1];delete n._promise,t(n.parse(a,i))})).catch((function(e){delete n._promise,t(n.error('Failed fetching operationId "'+n.id+'": '+e,"fetch"))}))})))}},{key:"is",value:function(e){if(-1==nn.indexOf(e))throw"Invalid status: "+e;return this.status==e}},{key:"parse",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.body;this.res.body=n||e,this.res.status=e.status||"201",e.headers&&(this.res.headers=e.headers);var t=null;return String(this.res.status).match(/^[23]/)||(t=n&&n.errors?n.errors:[{message:e.statusText||"Unknown error."}]),this.update({err:t,status:t?"error":"success"})}},{key:"reset",value:function(){return this.res.body={},this.res.headers={},this.res.status=0,this.update({err:null,status:"pending"})}},{key:"_extractValue",value:function(e,n){if(n.schema&&"form"==(e.tagName||"").toLowerCase()){var t={};return Object.keys(n.schema.properties).forEach((function(n){t[n]=e[n]&&e[n].value})),t}if(e[n.name]&&e[n.name].tagName)return e[n.name].value;if(n.schema){var o={};return Object.keys(n.schema.properties).forEach((function(n){o[n]=e[n]})),o}return e[n.name]}},{key:"_hasProperty",value:function(e,n){return"body"==n.in||("form"==(e.tagName||"").toLowerCase()?!!e[n.name]:e.hasOwnProperty(n.name))}},{key:"_paramsToRequest",value:function(e,n){var t=this,o={headers:this.req.headers,method:e.method},a=new URL(e.url);return(e.parameters||[]).forEach((function(e){if(t._hasProperty(n,e)||e.required)if("path"==e.in){var i=new RegExp("(%7B|\\{)"+Ze(e.name)+"(%7D|\\})","i");a.pathname=a.pathname.replace(i,encodeURIComponent(t._extractValue(n,e)))}else if("query"==e.in)a.searchParams.set(e.name,t._extractValue(n,e));else if("body"==e.in)o.body=t._extractValue(n,e);else{if("header"!=e.in)throw"[Api] Parameter in:"+e.in+" is not supported.";o.header[e.name]=t._extractValue(n,e.name)}})),[a,o]}}]),n}(ze),on=function(){function e(n){Oe(this,e),this.protocol=location.protocol,this.url=n}return Ce(e,[{key:"operation",value:function(e,n){var t=new tn({api:this,id:e,defaultParams:n});return t.req.headers={"Content-Type":"application/json"},t}},{key:"spec",value:function(e){var n,t,o=this;return Ee.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!this._ops||!e){a.next=2;break}return a.abrupt("return",this._ops[e]);case 2:if(!this._spec){a.next=4;break}return a.abrupt("return",this._spec);case 4:return a.next=6,Ee.awrap(fetch(this.url));case 6:return n=a.sent,a.next=9,Ee.awrap(n.json());case 9:if(t=a.sent,this._ops={},this._spec=t,Object.keys(t.paths).forEach((function(e){Object.keys(t.paths[e]).forEach((function(n){var a=t.paths[e][n],i=a.operationId;i&&(a.method=n.toUpperCase(),a.url=o.protocol+"//"+t.host+t.basePath+e+".json",a.parameters=(a.parameters||[]).map((function(e){if(!e.$ref)return e;for(var n=e.$ref.replace(/^#\//,"").split("/"),o=t;n.length;)o=o[n.shift()];return o})),o._ops[i]=a)}))})),!this._ops||!e){a.next=15;break}return a.abrupt("return",this._ops[e]);case 15:if(!this._spec){a.next=17;break}return a.abrupt("return",this._spec);case 17:case"end":return a.stop()}}),null,this)}}]),e}(),an=ke((function(e,n){var t,o;t=function(e){var n=[],t=Object.keys,o={},a={},i=/^(no-?highlight|plain|text)$/i,r=/\blang(?:uage)?-([\w-]+)\b/i,s=/((^(<[^>]+>|\t|)+|(?:\n)))/gm,c="</span>",d={classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:void 0},u="of and for in not or if then".split(" ");function l(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function f(e){return e.nodeName.toLowerCase()}function p(e){return i.test(e)}function g(e){var n,t={},o=Array.prototype.slice.call(arguments,1);for(n in e)t[n]=e[n];return o.forEach((function(e){for(n in e)t[n]=e[n]})),t}function m(e){var n=[];return function e(t,o){for(var a=t.firstChild;a;a=a.nextSibling)3===a.nodeType?o+=a.nodeValue.length:1===a.nodeType&&(n.push({event:"start",offset:o,node:a}),o=e(a,o),f(a).match(/br|hr|img|input/)||n.push({event:"stop",offset:o,node:a}));return o}(e,0),n}function h(e){return e.variants&&!e.cached_variants&&(e.cached_variants=e.variants.map((function(n){return g(e,{variants:null},n)}))),e.cached_variants?e.cached_variants:function e(n){return!!n&&(n.endsWithParent||e(n.starts))}(e)?[g(e,{starts:e.starts?g(e.starts):null})]:[e]}function $(e,n){return n?Number(n):(t=e,-1!=u.indexOf(t.toLowerCase())?0:1);var t}function b(e){function n(e){return e&&e.source||e}function o(t,o){return new RegExp(n(t),"m"+(e.case_insensitive?"i":"")+(o?"g":""))}function a(e){var t,a,i={},r=[],s={},c=1;function d(e,n){i[c]=e,r.push([e,n]),c+=function(e){return new RegExp(e.toString()+"|").exec("").length-1}(n)+1}for(var u=0;u<e.contains.length;u++)d(a=e.contains[u],a.beginKeywords?"\\.?(?:"+a.begin+")\\.?":a.begin);e.terminator_end&&d("end",e.terminator_end),e.illegal&&d("illegal",e.illegal);var l=r.map((function(e){return e[1]}));return t=o(function(e,t){for(var o=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./,a=0,i="",r=0;r<e.length;r++){var s=a+=1,c=n(e[r]);for(r>0&&(i+=t),i+="(";c.length>0;){var d=o.exec(c);if(null==d){i+=c;break}i+=c.substring(0,d.index),c=c.substring(d.index+d[0].length),"\\"==d[0][0]&&d[1]?i+="\\"+String(Number(d[1])+s):(i+=d[0],"("==d[0]&&a++)}i+=")"}return i}(l,"|"),!0),s.lastIndex=0,s.exec=function(n){var o;if(0===r.length)return null;t.lastIndex=s.lastIndex;var a=t.exec(n);if(!a)return null;for(var c=0;c<a.length;c++)if(null!=a[c]&&null!=i[""+c]){o=i[""+c];break}return"string"==typeof o?(a.type=o,a.extra=[e.illegal,e.terminator_end]):(a.type="begin",a.rule=o),a},s}!function i(r,s){r.compiled||(r.compiled=!0,r.keywords=r.keywords||r.beginKeywords,r.keywords&&(r.keywords=function(e,n){var o={};return"string"==typeof e?a("keyword",e):t(e).forEach((function(n){a(n,e[n])})),o;function a(e,t){n&&(t=t.toLowerCase()),t.split(" ").forEach((function(n){var t=n.split("|");o[t[0]]=[e,$(t[0],t[1])]}))}}(r.keywords,e.case_insensitive)),r.lexemesRe=o(r.lexemes||/\w+/,!0),s&&(r.beginKeywords&&(r.begin="\\b("+r.beginKeywords.split(" ").join("|")+")\\b"),r.begin||(r.begin=/\B|\b/),r.beginRe=o(r.begin),r.endSameAsBegin&&(r.end=r.begin),r.end||r.endsWithParent||(r.end=/\B|\b/),r.end&&(r.endRe=o(r.end)),r.terminator_end=n(r.end)||"",r.endsWithParent&&s.terminator_end&&(r.terminator_end+=(r.end?"|":"")+s.terminator_end)),r.illegal&&(r.illegalRe=o(r.illegal)),null==r.relevance&&(r.relevance=1),r.contains||(r.contains=[]),r.contains=Array.prototype.concat.apply([],r.contains.map((function(e){return h("self"===e?r:e)}))),r.contains.forEach((function(e){i(e,r)})),r.starts&&i(r.starts,s),r.terminators=a(r))}(e)}function v(e,n,t,a){function i(e,n){var t=h.case_insensitive?n[0].toLowerCase():n[0];return e.keywords.hasOwnProperty(t)&&e.keywords[t]}function r(e,n,t,o){if(!t&&""===n)return"";if(!e)return n;var a='<span class="'+(o?"":d.classPrefix);return(a+=e+'">')+n+(t?"":c)}function s(){x+=null!=_.subLanguage?function(){var e="string"==typeof _.subLanguage;if(e&&!o[_.subLanguage])return l(E);var n=e?v(_.subLanguage,E,!0,w[_.subLanguage]):y(E,_.subLanguage.length?_.subLanguage:void 0);return _.relevance>0&&(O+=n.relevance),e&&(w[_.subLanguage]=n.top),r(n.language,n.value,!1,!0)}():function(){var e,n,t,o;if(!_.keywords)return l(E);for(o="",n=0,_.lexemesRe.lastIndex=0,t=_.lexemesRe.exec(E);t;)o+=l(E.substring(n,t.index)),(e=i(_,t))?(O+=e[1],o+=r(e[0],l(t[0]))):o+=l(t[0]),n=_.lexemesRe.lastIndex,t=_.lexemesRe.exec(E);return o+l(E.substr(n))}(),E=""}function u(e){x+=e.className?r(e.className,"",!0):"",_=Object.create(e,{parent:{value:_}})}function f(e){var n=e[0],t=e.rule;return t&&t.endSameAsBegin&&(t.endRe=function(e){return new RegExp(e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"m")}(n)),t.skip?E+=n:(t.excludeBegin&&(E+=n),s(),t.returnBegin||t.excludeBegin||(E=n)),u(t),t.returnBegin?0:n.length}function p(e){var n=e[0],t=function e(n,t){if(function(e,n){var t=e&&e.exec(n);return t&&0===t.index}(n.endRe,t)){for(;n.endsParent&&n.parent;)n=n.parent;return n}if(n.endsWithParent)return e(n.parent,t)}(_,n);if(t){var o=_;o.skip?E+=n:(o.returnEnd||o.excludeEnd||(E+=n),s(),o.excludeEnd&&(E=n));do{_.className&&(x+=c),_.skip||_.subLanguage||(O+=_.relevance),_=_.parent}while(_!==t.parent);return t.starts&&(t.endSameAsBegin&&(t.starts.endRe=t.endRe),u(t.starts)),o.returnEnd?0:n.length}}var g={};function m(e,o){var a=o&&o[0];if(E+=e,null==a)return s(),0;if("begin"==g.type&&"end"==o.type&&g.index==o.index&&""===a)return E+=n.slice(o.index,o.index+1),1;if(g=o,"begin"===o.type)return f(o);if("illegal"===o.type&&!t)throw new Error('Illegal lexeme "'+a+'" for mode "'+(_.className||"<unnamed>")+'"');if("end"===o.type){var i=p(o);if(null!=i)return i}return E+=a,a.length}var h=k(e);if(!h)throw new Error('Unknown language: "'+e+'"');b(h);var $,_=a||h,w={},x="";for($=_;$!==h;$=$.parent)$.className&&(x=r($.className,"",!0)+x);var E="",O=0;try{for(var N,C,S=0;_.terminators.lastIndex=S,N=_.terminators.exec(n);)C=m(n.substring(S,N.index),N),S=N.index+C;for(m(n.substr(S)),$=_;$.parent;$=$.parent)$.className&&(x+=c);return{relevance:O,value:x,illegal:!1,language:e,top:_}}catch(e){if(e.message&&-1!==e.message.indexOf("Illegal"))return{illegal:!0,relevance:0,value:l(n)};throw e}}function y(e,n){n=n||d.languages||t(o);var a={relevance:0,value:l(e)},i=a;return n.filter(k).filter(E).forEach((function(n){var t=v(n,e,!1);t.language=n,t.relevance>i.relevance&&(i=t),t.relevance>a.relevance&&(i=a,a=t)})),i.language&&(a.second_best=i),a}function _(e){return d.tabReplace||d.useBR?e.replace(s,(function(e,n){return d.useBR&&"\n"===e?"<br>":d.tabReplace?n.replace(/\t/g,d.tabReplace):""})):e}function w(e){var t,o,i,s,c,u=function(e){var n,t,o,a,i=e.className+" ";if(i+=e.parentNode?e.parentNode.className:"",t=r.exec(i))return k(t[1])?t[1]:"no-highlight";for(n=0,o=(i=i.split(/\s+/)).length;n<o;n++)if(p(a=i[n])||k(a))return a}(e);p(u)||(d.useBR?(t=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=e.innerHTML.replace(/\n/g,"").replace(/<br[ \/]*>/g,"\n"):t=e,c=t.textContent,i=u?v(u,c,!0):y(c),(o=m(t)).length&&((s=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=i.value,i.value=function(e,t,o){var a=0,i="",r=[];function s(){return e.length&&t.length?e[0].offset!==t[0].offset?e[0].offset<t[0].offset?e:t:"start"===t[0].event?e:t:e.length?e:t}function c(e){i+="<"+f(e)+n.map.call(e.attributes,(function(e){return" "+e.nodeName+'="'+l(e.value).replace('"',"&quot;")+'"'})).join("")+">"}function d(e){i+="</"+f(e)+">"}function u(e){("start"===e.event?c:d)(e.node)}for(;e.length||t.length;){var p=s();if(i+=l(o.substring(a,p[0].offset)),a=p[0].offset,p===e){r.reverse().forEach(d);do{u(p.splice(0,1)[0]),p=s()}while(p===e&&p.length&&p[0].offset===a);r.reverse().forEach(c)}else"start"===p[0].event?r.push(p[0].node):r.pop(),u(p.splice(0,1)[0])}return i+l(o.substr(a))}(o,m(s),c)),i.value=_(i.value),e.innerHTML=i.value,e.className=function(e,n,t){var o=n?a[n]:t,i=[e.trim()];return e.match(/\bhljs\b/)||i.push("hljs"),-1===e.indexOf(o)&&i.push(o),i.join(" ").trim()}(e.className,u,i.language),e.result={language:i.language,re:i.relevance},i.second_best&&(e.second_best={language:i.second_best.language,re:i.second_best.relevance}))}function x(){if(!x.called){x.called=!0;var e=document.querySelectorAll("pre code");n.forEach.call(e,w)}}function k(e){return e=(e||"").toLowerCase(),o[e]||o[a[e]]}function E(e){var n=k(e);return n&&!n.disableAutodetect}return e.highlight=v,e.highlightAuto=y,e.fixMarkup=_,e.highlightBlock=w,e.configure=function(e){d=g(d,e)},e.initHighlighting=x,e.initHighlightingOnLoad=function(){addEventListener("DOMContentLoaded",x,!1),addEventListener("load",x,!1)},e.registerLanguage=function(n,t){var i=o[n]=t(e);i.rawDefinition=t.bind(null,e),i.aliases&&i.aliases.forEach((function(e){a[e]=n}))},e.listLanguages=function(){return t(o)},e.getLanguage=k,e.autoDetection=E,e.inherit=g,e.IDENT_RE="[a-zA-Z]\\w*",e.UNDERSCORE_IDENT_RE="[a-zA-Z_]\\w*",e.NUMBER_RE="\\b\\d+(\\.\\d+)?",e.C_NUMBER_RE="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",e.BINARY_NUMBER_RE="\\b(0b[01]+)",e.RE_STARTERS_RE="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",e.BACKSLASH_ESCAPE={begin:"\\\\[\\s\\S]",relevance:0},e.APOS_STRING_MODE={className:"string",begin:"'",end:"'",illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},e.QUOTE_STRING_MODE={className:"string",begin:'"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},e.PHRASAL_WORDS_MODE={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},e.COMMENT=function(n,t,o){var a=e.inherit({className:"comment",begin:n,end:t,contains:[]},o||{});return a.contains.push(e.PHRASAL_WORDS_MODE),a.contains.push({className:"doctag",begin:"(?:TODO|FIXME|NOTE|BUG|XXX):",relevance:0}),a},e.C_LINE_COMMENT_MODE=e.COMMENT("//","$"),e.C_BLOCK_COMMENT_MODE=e.COMMENT("/\\*","\\*/"),e.HASH_COMMENT_MODE=e.COMMENT("#","$"),e.NUMBER_MODE={className:"number",begin:e.NUMBER_RE,relevance:0},e.C_NUMBER_MODE={className:"number",begin:e.C_NUMBER_RE,relevance:0},e.BINARY_NUMBER_MODE={className:"number",begin:e.BINARY_NUMBER_RE,relevance:0},e.CSS_NUMBER_MODE={className:"number",begin:e.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},e.REGEXP_MODE={className:"regexp",begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[e.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[e.BACKSLASH_ESCAPE]}]},e.TITLE_MODE={className:"title",begin:e.IDENT_RE,relevance:0},e.UNDERSCORE_TITLE_MODE={className:"title",begin:e.UNDERSCORE_IDENT_RE,relevance:0},e.METHOD_GUARD={begin:"\\.\\s*"+e.UNDERSCORE_IDENT_RE,relevance:0},e},o="object"==typeof window&&window||"object"==typeof self&&self,n.nodeType?o&&(o.hljs=t({})):t(n)}));function rn(n){let t,o,a,i,r;return{c(){A(t=N("i"),"class",o=n.calculateClassName(n.name,n.family)),A(t,"style",a=n.calculateStyle(n.name,n.family,n.color)),A(t,"title",n.title),t.hidden=i=!n.name,r=P(t,"click",n.click_handler)},m(e,n){k(e,t,n)},p(e,n){(e.name||e.family)&&o!==(o=n.calculateClassName(n.name,n.family))&&A(t,"class",o),(e.name||e.family||e.color)&&a!==(a=n.calculateStyle(n.name,n.family,n.color))&&A(t,"style",a),e.title&&A(t,"title",n.title),e.name&&i!==(i=!n.name)&&(t.hidden=i)},i:e,o:e,d(e){e&&E(t),r()}}}function sn(e,n,t){const o={regular:"far",solid:"fas"},a={batman:"https://www.gravatar.com/avatar/ab1839667863f31e359d98364cfdef61",marcusr:"https://www.gravatar.com/avatar/6c056546d802b1a9ac186ab63f9fb632"},i=["fas fa-anchor","fas fa-atom","fas fa-award","fas fa-balance-scale","fas fa-baseball-ball","fas fa-basketball-ball","fas fa-bicycle","fas fa-bolt","fas fa-book-reader","fas fa-candy-cane","fas fa-carrot","fas fa-cat","fas fa-chess-knight","fas fa-child","fas fa-coffee","fas fa-cookie-bite","fas fa-crow","fas fa-dice","fas fa-dog","fas fa-dove","fas fa-feather","fas fa-fish","fas fa-gem","fas fa-ghost","fas fa-hard-hat","fas fa-hat-cowboy","fas fa-hat-wizard","fas fa-hiking","fas fa-horse-head","fas fa-horse","fas fa-id-badge","fas fa-igloo","fas fa-mask","fas fa-meteor","fas fa-paint-brush","fas fa-paw","fas fa-pepper-hot","fas fa-pizza-slice","fas fa-portrait","fas fa-puzzle-piece","fas fa-rainbow","fas fa-robot","fas fa-rocket","fas fa-running","fas fa-seedling","fas fa-skating","fas fa-skiing","fas fa-smile","fas fa-snowboarding","fas fa-snowflake","fas fa-snowman","fas fa-swimmer","fas fa-umbrella","fas fa-user-astronaut","fas fa-user-graduate","fas fa-user-ninja","fas fa-user-secret","fas fa-walking","fas fa-yin-yang"];let{class:r=""}=n,{animation:s=""}=n,{color:c=""}=n,{family:d=""}=n,{name:u}=n,{title:l=""}=n;return e.$set=e=>{"class"in e&&t("className",r=e.class),"animation"in e&&t("animation",s=e.animation),"color"in e&&t("color",c=e.color),"family"in e&&t("family",d=e.family),"name"in e&&t("name",u=e.name),"title"in e&&t("title",l=e.title)},{className:r,animation:s,color:c,family:d,name:u,title:l,calculateClassName:function(e,n){const t=[],c=e.match(/^pick:(.+)$/);if(c){if(a[c[1]])return"fas fa-contributor";t.push(function(e){e.match(/^\d+$/)&&console.log(i[e]);if(e.match(/^\d+$/))return i[e];let n=0;for(let t=0;t<e.length;t++)n=e.charCodeAt(t)+((n<<5)-n),n&=n;return n=Math.abs(n),i[n%i.length]}(c[1]))}else t.push(o[n]||"fas"),t.push("fa-"+e);return s&&t.push(s.split(" ").map(e=>"fa-"+e)),r&&t.push(r.split(" ")),t.join(" ")},calculateStyle:function(e,n,t){const o=[];let i="color:";const r=e.match(/^pick:(.+)$/);return r&&a[r[1]]&&(i="background-color:",o.push('background-image:url("'+a[r[1]]+'")')),t&&o.push(i+t),o.join(";")},click_handler:function(n){Z(e,n)}}}an.registerLanguage("css",(function(e){var n={begin:/(?:[A-Z\_\.\-]+|--[a-zA-Z0-9_-]+)\s*:/,returnBegin:!0,end:";",endsWithParent:!0,contains:[{className:"attribute",begin:/\S/,end:":",excludeEnd:!0,starts:{endsWithParent:!0,excludeEnd:!0,contains:[{begin:/[\w-]+\(/,returnBegin:!0,contains:[{className:"built_in",begin:/[\w-]+/},{begin:/\(/,end:/\)/,contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]}]},e.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,e.C_BLOCK_COMMENT_MODE,{className:"number",begin:"#[0-9A-Fa-f]+"},{className:"meta",begin:"!important"}]}}]};return{case_insensitive:!0,illegal:/[=\/|'\$]/,contains:[e.C_BLOCK_COMMENT_MODE,{className:"selector-id",begin:/#[A-Za-z0-9_-]+/},{className:"selector-class",begin:/\.[A-Za-z0-9_-]+/},{className:"selector-attr",begin:/\[/,end:/\]/,illegal:"$"},{className:"selector-pseudo",begin:/:(:)?[a-zA-Z0-9\_\-\+\(\)"'.]+/},{begin:"@(font-face|page)",lexemes:"[a-z-]+",keywords:"font-face page"},{begin:"@",end:"[{;]",illegal:/:/,contains:[{className:"keyword",begin:/\w+/},{begin:/\s/,endsWithParent:!0,excludeEnd:!0,relevance:0,contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,e.CSS_NUMBER_MODE]}]},{className:"selector-tag",begin:"[a-zA-Z-][a-zA-Z0-9_-]*",relevance:0},{begin:"{",end:"}",illegal:/\S/,contains:[e.C_BLOCK_COMMENT_MODE,n]}]}})),an.registerLanguage("diff",(function(e){return{aliases:["patch"],contains:[{className:"meta",relevance:10,variants:[{begin:/^@@ +\-\d+,\d+ +\+\d+,\d+ +@@$/},{begin:/^\*\*\* +\d+,\d+ +\*\*\*\*$/},{begin:/^\-\-\- +\d+,\d+ +\-\-\-\-$/}]},{className:"comment",variants:[{begin:/Index: /,end:/$/},{begin:/={3,}/,end:/$/},{begin:/^\-{3}/,end:/$/},{begin:/^\*{3} /,end:/$/},{begin:/^\+{3}/,end:/$/},{begin:/^\*{15}$/}]},{className:"addition",begin:"^\\+",end:"$"},{className:"deletion",begin:"^\\-",end:"$"},{className:"addition",begin:"^\\!",end:"$"}]}})),an.registerLanguage("dockerfile",(function(e){return{aliases:["docker"],case_insensitive:!0,keywords:"from maintainer expose env arg user onbuild stopsignal",contains:[e.HASH_COMMENT_MODE,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,e.NUMBER_MODE,{beginKeywords:"run cmd entrypoint volume add copy workdir label healthcheck shell",starts:{end:/[^\\]$/,subLanguage:"bash"}}],illegal:"</"}})),an.registerLanguage("go",(function(e){var n={keyword:"break default func interface select case map struct chan else goto package switch const fallthrough if range type continue for import return var go defer bool byte complex64 complex128 float32 float64 int8 int16 int32 int64 string uint8 uint16 uint32 uint64 int uint uintptr rune",literal:"true false iota nil",built_in:"append cap close complex copy imag len make new panic print println real recover delete"};return{aliases:["golang"],keywords:n,illegal:"</",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{className:"string",variants:[e.QUOTE_STRING_MODE,{begin:"'",end:"[^\\\\]'"},{begin:"`",end:"`"}]},{className:"number",variants:[{begin:e.C_NUMBER_RE+"[i]",relevance:1},e.C_NUMBER_MODE]},{begin:/:=/},{className:"function",beginKeywords:"func",end:"\\s*(\\{|$)",excludeEnd:!0,contains:[e.TITLE_MODE,{className:"params",begin:/\(/,end:/\)/,keywords:n,illegal:/["']/}]}]}})),an.registerLanguage("http",(function(e){var n="HTTP/[0-9\\.]+";return{aliases:["https"],illegal:"\\S",contains:[{begin:"^"+n,end:"$",contains:[{className:"number",begin:"\\b\\d{3}\\b"}]},{begin:"^[A-Z]+ (.*?) "+n+"$",returnBegin:!0,end:"$",contains:[{className:"string",begin:" ",end:" ",excludeBegin:!0,excludeEnd:!0},{begin:n},{className:"keyword",begin:"[A-Z]+"}]},{className:"attribute",begin:"^\\w",end:": ",excludeEnd:!0,illegal:"\\n|\\s|=",starts:{end:"$",relevance:0}},{begin:"\\n\\n",starts:{subLanguage:[],endsWithParent:!0}}]}})),an.registerLanguage("javascript",(function(e){var n="[A-Za-z$_][0-9A-Za-z$_]*",t={keyword:"in of if for while finally var new function do return void else break catch instanceof with throw case default try this switch continue typeof delete let yield const export super debugger as async await static import from as",literal:"true false null undefined NaN Infinity",built_in:"eval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Error EvalError InternalError RangeError ReferenceError StopIteration SyntaxError TypeError URIError Number Math Date String RegExp Array Float32Array Float64Array Int16Array Int32Array Int8Array Uint16Array Uint32Array Uint8Array Uint8ClampedArray ArrayBuffer DataView JSON Intl arguments require module console window document Symbol Set Map WeakSet WeakMap Proxy Reflect Promise"},o={className:"number",variants:[{begin:"\\b(0[bB][01]+)n?"},{begin:"\\b(0[oO][0-7]+)n?"},{begin:e.C_NUMBER_RE+"n?"}],relevance:0},a={className:"subst",begin:"\\$\\{",end:"\\}",keywords:t,contains:[]},i={begin:"html`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,a],subLanguage:"xml"}},r={begin:"css`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,a],subLanguage:"css"}},s={className:"string",begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE,a]};a.contains=[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,i,r,s,o,e.REGEXP_MODE];var c=a.contains.concat([e.C_BLOCK_COMMENT_MODE,e.C_LINE_COMMENT_MODE]);return{aliases:["js","jsx"],keywords:t,contains:[{className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},{className:"meta",begin:/^#!/,end:/$/},e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,i,r,s,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,o,{begin:/[{,\n]\s*/,relevance:0,contains:[{begin:n+"\\s*:",returnBegin:!0,relevance:0,contains:[{className:"attr",begin:n,relevance:0}]}]},{begin:"("+e.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,e.REGEXP_MODE,{className:"function",begin:"(\\(.*?\\)|"+n+")\\s*=>",returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:n},{begin:/\(\s*\)/},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:t,contains:c}]}]},{className:"",begin:/\s/,end:/\s*/,skip:!0},{begin:/</,end:/(\/[A-Za-z0-9\\._:-]+|[A-Za-z0-9\\._:-]+\/)>/,subLanguage:"xml",contains:[{begin:/<[A-Za-z0-9\\._:-]+\s*\/>/,skip:!0},{begin:/<[A-Za-z0-9\\._:-]+/,end:/(\/[A-Za-z0-9\\._:-]+|[A-Za-z0-9\\._:-]+\/)>/,skip:!0,contains:[{begin:/<[A-Za-z0-9\\._:-]+\s*\/>/,skip:!0},"self"]}]}],relevance:0},{className:"function",beginKeywords:"function",end:/\{/,excludeEnd:!0,contains:[e.inherit(e.TITLE_MODE,{begin:n}),{className:"params",begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,contains:c}],illegal:/\[|%/},{begin:/\$[(.]/},e.METHOD_GUARD,{className:"class",beginKeywords:"class",end:/[{;=]/,excludeEnd:!0,illegal:/[:"\[\]]/,contains:[{beginKeywords:"extends"},e.UNDERSCORE_TITLE_MODE]},{beginKeywords:"constructor get set",end:/\{/,excludeEnd:!0}],illegal:/#(?!!)/}})),an.registerLanguage("markdown",(function(e){return{aliases:["md","mkdown","mkd"],contains:[{className:"section",variants:[{begin:"^#{1,6}",end:"$"},{begin:"^.+?\\n[=-]{2,}$"}]},{begin:"<",end:">",subLanguage:"xml",relevance:0},{className:"bullet",begin:"^\\s*([*+-]|(\\d+\\.))\\s+"},{className:"strong",begin:"[*_]{2}.+?[*_]{2}"},{className:"emphasis",variants:[{begin:"\\*.+?\\*"},{begin:"_.+?_",relevance:0}]},{className:"quote",begin:"^>\\s+",end:"$"},{className:"code",variants:[{begin:"^```\\w*\\s*$",end:"^```[ ]*$"},{begin:"`.+?`"},{begin:"^( {4}|\\t)",end:"$",relevance:0}]},{begin:"^[-\\*]{3,}",end:"$"},{begin:"\\[.+?\\][\\(\\[].*?[\\)\\]]",returnBegin:!0,contains:[{className:"string",begin:"\\[",end:"\\]",excludeBegin:!0,returnEnd:!0,relevance:0},{className:"link",begin:"\\]\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0},{className:"symbol",begin:"\\]\\[",end:"\\]",excludeBegin:!0,excludeEnd:!0}],relevance:10},{begin:/^\[[^\n]+\]:/,returnBegin:!0,contains:[{className:"symbol",begin:/\[/,end:/\]/,excludeBegin:!0,excludeEnd:!0},{className:"link",begin:/:\s*/,end:/$/,excludeBegin:!0}]}]}})),an.registerLanguage("mojolicious",(function(e){return{subLanguage:"xml",contains:[{className:"meta",begin:"^__(END|DATA)__$"},{begin:"^\\s*%{1,2}={0,2}",end:"$",subLanguage:"perl"},{begin:"<%{1,2}={0,2}",end:"={0,1}%>",subLanguage:"perl",excludeBegin:!0,excludeEnd:!0}]}})),an.registerLanguage("nginx",(function(e){var n={className:"variable",variants:[{begin:/\$\d+/},{begin:/\$\{/,end:/}/},{begin:"[\\$\\@]"+e.UNDERSCORE_IDENT_RE}]},t={endsWithParent:!0,lexemes:"[a-z/_]+",keywords:{literal:"on off yes no true false none blocked debug info notice warn error crit select break last permanent redirect kqueue rtsig epoll poll /dev/poll"},relevance:0,illegal:"=>",contains:[e.HASH_COMMENT_MODE,{className:"string",contains:[e.BACKSLASH_ESCAPE,n],variants:[{begin:/"/,end:/"/},{begin:/'/,end:/'/}]},{begin:"([a-z]+):/",end:"\\s",endsWithParent:!0,excludeEnd:!0,contains:[n]},{className:"regexp",contains:[e.BACKSLASH_ESCAPE,n],variants:[{begin:"\\s\\^",end:"\\s|{|;",returnEnd:!0},{begin:"~\\*?\\s+",end:"\\s|{|;",returnEnd:!0},{begin:"\\*(\\.[a-z\\-]+)+"},{begin:"([a-z\\-]+\\.)+\\*"}]},{className:"number",begin:"\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}(:\\d{1,5})?\\b"},{className:"number",begin:"\\b\\d+[kKmMgGdshdwy]*\\b",relevance:0},n]};return{aliases:["nginxconf"],contains:[e.HASH_COMMENT_MODE,{begin:e.UNDERSCORE_IDENT_RE+"\\s+{",returnBegin:!0,end:"{",contains:[{className:"section",begin:e.UNDERSCORE_IDENT_RE}],relevance:0},{begin:e.UNDERSCORE_IDENT_RE+"\\s",end:";|{",returnBegin:!0,contains:[{className:"attribute",begin:e.UNDERSCORE_IDENT_RE,starts:t}],relevance:0}],illegal:"[^\\s\\}]"}})),an.registerLanguage("perl",(function(e){var n="getpwent getservent quotemeta msgrcv scalar kill dbmclose undef lc ma syswrite tr send umask sysopen shmwrite vec qx utime local oct semctl localtime readpipe do return format read sprintf dbmopen pop getpgrp not getpwnam rewinddir qqfileno qw endprotoent wait sethostent bless s|0 opendir continue each sleep endgrent shutdown dump chomp connect getsockname die socketpair close flock exists index shmgetsub for endpwent redo lstat msgctl setpgrp abs exit select print ref gethostbyaddr unshift fcntl syscall goto getnetbyaddr join gmtime symlink semget splice x|0 getpeername recv log setsockopt cos last reverse gethostbyname getgrnam study formline endhostent times chop length gethostent getnetent pack getprotoent getservbyname rand mkdir pos chmod y|0 substr endnetent printf next open msgsnd readdir use unlink getsockopt getpriority rindex wantarray hex system getservbyport endservent int chr untie rmdir prototype tell listen fork shmread ucfirst setprotoent else sysseek link getgrgid shmctl waitpid unpack getnetbyname reset chdir grep split require caller lcfirst until warn while values shift telldir getpwuid my getprotobynumber delete and sort uc defined srand accept package seekdir getprotobyname semop our rename seek if q|0 chroot sysread setpwent no crypt getc chown sqrt write setnetent setpriority foreach tie sin msgget map stat getlogin unless elsif truncate exec keys glob tied closedirioctl socket readlink eval xor readline binmode setservent eof ord bind alarm pipe atan2 getgrent exp time push setgrent gt lt or ne m|0 break given say state when",t={className:"subst",begin:"[$@]\\{",end:"\\}",keywords:n},o={begin:"->{",end:"}"},a={variants:[{begin:/\$\d/},{begin:/[\$%@](\^\w\b|#\w+(::\w+)*|{\w+}|\w+(::\w*)*)/},{begin:/[\$%@][^\s\w{]/,relevance:0}]},i=[e.BACKSLASH_ESCAPE,t,a],r=[a,e.HASH_COMMENT_MODE,e.COMMENT("^\\=\\w","\\=cut",{endsWithParent:!0}),o,{className:"string",contains:i,variants:[{begin:"q[qwxr]?\\s*\\(",end:"\\)",relevance:5},{begin:"q[qwxr]?\\s*\\[",end:"\\]",relevance:5},{begin:"q[qwxr]?\\s*\\{",end:"\\}",relevance:5},{begin:"q[qwxr]?\\s*\\|",end:"\\|",relevance:5},{begin:"q[qwxr]?\\s*\\<",end:"\\>",relevance:5},{begin:"qw\\s+q",end:"q",relevance:5},{begin:"'",end:"'",contains:[e.BACKSLASH_ESCAPE]},{begin:'"',end:'"'},{begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE]},{begin:"{\\w+}",contains:[],relevance:0},{begin:"-?\\w+\\s*\\=\\>",contains:[],relevance:0}]},{className:"number",begin:"(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b",relevance:0},{begin:"(\\/\\/|"+e.RE_STARTERS_RE+"|\\b(split|return|print|reverse|grep)\\b)\\s*",keywords:"split return print reverse grep",relevance:0,contains:[e.HASH_COMMENT_MODE,{className:"regexp",begin:"(s|tr|y)/(\\\\.|[^/])*/(\\\\.|[^/])*/[a-z]*",relevance:10},{className:"regexp",begin:"(m|qr)?/",end:"/[a-z]*",contains:[e.BACKSLASH_ESCAPE],relevance:0}]},{className:"function",beginKeywords:"sub",end:"(\\s*\\(.*?\\))?[;{]",excludeEnd:!0,relevance:5,contains:[e.TITLE_MODE]},{begin:"-\\w\\b",relevance:0},{begin:"^__DATA__$",end:"^__END__$",subLanguage:"mojolicious",contains:[{begin:"^@@.*",end:"$",className:"comment"}]}];return t.contains=r,o.contains=r,{aliases:["pl","pm"],lexemes:/[\w\.]+/,keywords:n,contains:r}})),an.registerLanguage("python",(function(e){var n={keyword:"and elif is global as in if from raise for except finally print import pass return exec else break not with class assert yield try while continue del or def lambda async await nonlocal|10",built_in:"Ellipsis NotImplemented",literal:"False None True"},t={className:"meta",begin:/^(>>>|\.\.\.) /},o={className:"subst",begin:/\{/,end:/\}/,keywords:n,illegal:/#/},a={begin:/\{\{/,relevance:0},i={className:"string",contains:[e.BACKSLASH_ESCAPE],variants:[{begin:/(u|b)?r?'''/,end:/'''/,contains:[e.BACKSLASH_ESCAPE,t],relevance:10},{begin:/(u|b)?r?"""/,end:/"""/,contains:[e.BACKSLASH_ESCAPE,t],relevance:10},{begin:/(fr|rf|f)'''/,end:/'''/,contains:[e.BACKSLASH_ESCAPE,t,a,o]},{begin:/(fr|rf|f)"""/,end:/"""/,contains:[e.BACKSLASH_ESCAPE,t,a,o]},{begin:/(u|r|ur)'/,end:/'/,relevance:10},{begin:/(u|r|ur)"/,end:/"/,relevance:10},{begin:/(b|br)'/,end:/'/},{begin:/(b|br)"/,end:/"/},{begin:/(fr|rf|f)'/,end:/'/,contains:[e.BACKSLASH_ESCAPE,a,o]},{begin:/(fr|rf|f)"/,end:/"/,contains:[e.BACKSLASH_ESCAPE,a,o]},e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},r={className:"number",relevance:0,variants:[{begin:e.BINARY_NUMBER_RE+"[lLjJ]?"},{begin:"\\b(0o[0-7]+)[lLjJ]?"},{begin:e.C_NUMBER_RE+"[lLjJ]?"}]},s={className:"params",begin:/\(/,end:/\)/,contains:["self",t,r,i,e.HASH_COMMENT_MODE]};return o.contains=[i,r,t],{aliases:["py","gyp","ipython"],keywords:n,illegal:/(<\/|->|\?)|=>/,contains:[t,r,i,e.HASH_COMMENT_MODE,{variants:[{className:"function",beginKeywords:"def"},{className:"class",beginKeywords:"class"}],end:/:/,illegal:/[${=;\n,]/,contains:[e.UNDERSCORE_TITLE_MODE,s,{begin:/->/,endsWithParent:!0,keywords:"None"}]},{className:"meta",begin:/^[\t ]*@/,end:/$/},{begin:/\b(print|exec)\(/}]}})),an.registerLanguage("scss",(function(e){var n={className:"variable",begin:"(\\$[a-zA-Z-][a-zA-Z0-9_-]*)\\b"},t={className:"number",begin:"#[0-9A-Fa-f]+"};e.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,e.C_BLOCK_COMMENT_MODE;return{case_insensitive:!0,illegal:"[=/|']",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{className:"selector-id",begin:"\\#[A-Za-z0-9_-]+",relevance:0},{className:"selector-class",begin:"\\.[A-Za-z0-9_-]+",relevance:0},{className:"selector-attr",begin:"\\[",end:"\\]",illegal:"$"},{className:"selector-tag",begin:"\\b(a|abbr|acronym|address|area|article|aside|audio|b|base|big|blockquote|body|br|button|canvas|caption|cite|code|col|colgroup|command|datalist|dd|del|details|dfn|div|dl|dt|em|embed|fieldset|figcaption|figure|footer|form|frame|frameset|(h[1-6])|head|header|hgroup|hr|html|i|iframe|img|input|ins|kbd|keygen|label|legend|li|link|map|mark|meta|meter|nav|noframes|noscript|object|ol|optgroup|option|output|p|param|pre|progress|q|rp|rt|ruby|samp|script|section|select|small|span|strike|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|time|title|tr|tt|ul|var|video)\\b",relevance:0},{begin:":(visited|valid|root|right|required|read-write|read-only|out-range|optional|only-of-type|only-child|nth-of-type|nth-last-of-type|nth-last-child|nth-child|not|link|left|last-of-type|last-child|lang|invalid|indeterminate|in-range|hover|focus|first-of-type|first-line|first-letter|first-child|first|enabled|empty|disabled|default|checked|before|after|active)"},{begin:"::(after|before|choices|first-letter|first-line|repeat-index|repeat-item|selection|value)"},n,{className:"attribute",begin:"\\b(z-index|word-wrap|word-spacing|word-break|width|widows|white-space|visibility|vertical-align|unicode-bidi|transition-timing-function|transition-property|transition-duration|transition-delay|transition|transform-style|transform-origin|transform|top|text-underline-position|text-transform|text-shadow|text-rendering|text-overflow|text-indent|text-decoration-style|text-decoration-line|text-decoration-color|text-decoration|text-align-last|text-align|tab-size|table-layout|right|resize|quotes|position|pointer-events|perspective-origin|perspective|page-break-inside|page-break-before|page-break-after|padding-top|padding-right|padding-left|padding-bottom|padding|overflow-y|overflow-x|overflow-wrap|overflow|outline-width|outline-style|outline-offset|outline-color|outline|orphans|order|opacity|object-position|object-fit|normal|none|nav-up|nav-right|nav-left|nav-index|nav-down|min-width|min-height|max-width|max-height|mask|marks|margin-top|margin-right|margin-left|margin-bottom|margin|list-style-type|list-style-position|list-style-image|list-style|line-height|letter-spacing|left|justify-content|initial|inherit|ime-mode|image-orientation|image-resolution|image-rendering|icon|hyphens|height|font-weight|font-variant-ligatures|font-variant|font-style|font-stretch|font-size-adjust|font-size|font-language-override|font-kerning|font-feature-settings|font-family|font|float|flex-wrap|flex-shrink|flex-grow|flex-flow|flex-direction|flex-basis|flex|filter|empty-cells|display|direction|cursor|counter-reset|counter-increment|content|column-width|column-span|column-rule-width|column-rule-style|column-rule-color|column-rule|column-gap|column-fill|column-count|columns|color|clip-path|clip|clear|caption-side|break-inside|break-before|break-after|box-sizing|box-shadow|box-decoration-break|bottom|border-width|border-top-width|border-top-style|border-top-right-radius|border-top-left-radius|border-top-color|border-top|border-style|border-spacing|border-right-width|border-right-style|border-right-color|border-right|border-radius|border-left-width|border-left-style|border-left-color|border-left|border-image-width|border-image-source|border-image-slice|border-image-repeat|border-image-outset|border-image|border-color|border-collapse|border-bottom-width|border-bottom-style|border-bottom-right-radius|border-bottom-left-radius|border-bottom-color|border-bottom|border|background-size|background-repeat|background-position|background-origin|background-image|background-color|background-clip|background-attachment|background-blend-mode|background|backface-visibility|auto|animation-timing-function|animation-play-state|animation-name|animation-iteration-count|animation-fill-mode|animation-duration|animation-direction|animation-delay|animation|align-self|align-items|align-content)\\b",illegal:"[^\\s]"},{begin:"\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},{begin:":",end:";",contains:[n,t,e.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,{className:"meta",begin:"!important"}]},{begin:"@",end:"[{;]",keywords:"mixin include extend for if else each while charset import debug media page content font-face namespace warn",contains:[n,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,t,e.CSS_NUMBER_MODE,{begin:"\\s[A-Za-z0-9_.-]+",relevance:0}]}]}})),an.registerLanguage("shell",(function(e){return{aliases:["console"],contains:[{className:"meta",begin:"^\\s{0,3}[/\\w\\d\\[\\]()@-]*[>%$#]",starts:{end:"$",subLanguage:"bash"}}]}})),an.registerLanguage("xml",(function(e){var n={endsWithParent:!0,illegal:/</,relevance:0,contains:[{className:"attr",begin:"[A-Za-z0-9\\._:-]+",relevance:0},{begin:/=\s*/,relevance:0,contains:[{className:"string",endsParent:!0,variants:[{begin:/"/,end:/"/},{begin:/'/,end:/'/},{begin:/[^\s"'=<>`]+/}]}]}]};return{aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist","wsf","svg"],case_insensitive:!0,contains:[{className:"meta",begin:"<!DOCTYPE",end:">",relevance:10,contains:[{begin:"\\[",end:"\\]"}]},e.COMMENT("\x3c!--","--\x3e",{relevance:10}),{begin:"<\\!\\[CDATA\\[",end:"\\]\\]>",relevance:10},{className:"meta",begin:/<\?xml/,end:/\?>/,relevance:10},{begin:/<\?(php)?/,end:/\?>/,subLanguage:"php",contains:[{begin:"/\\*",end:"\\*/",skip:!0},{begin:'b"',end:'"',skip:!0},{begin:"b'",end:"'",skip:!0},e.inherit(e.APOS_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0}),e.inherit(e.QUOTE_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0})]},{className:"tag",begin:"<style(?=\\s|>)",end:">",keywords:{name:"style"},contains:[n],starts:{end:"</style>",returnEnd:!0,subLanguage:["css","xml"]}},{className:"tag",begin:"<script(?=\\s|>)",end:">",keywords:{name:"script"},contains:[n],starts:{end:"<\/script>",returnEnd:!0,subLanguage:["actionscript","javascript","handlebars","xml"]}},{className:"tag",begin:"</?",end:"/?>",contains:[{className:"name",begin:/[^\/><\s]+/,relevance:0},n]}]}})),an.registerLanguage("yaml",(function(e){var n={className:"string",relevance:0,variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/\S+/}],contains:[e.BACKSLASH_ESCAPE,{className:"template-variable",variants:[{begin:"{{",end:"}}"},{begin:"%{",end:"}"}]}]};return{case_insensitive:!0,aliases:["yml","YAML","yaml"],contains:[{className:"attr",variants:[{begin:"\\w[\\w :\\/.-]*:(?=[ \t]|$)"},{begin:'"\\w[\\w :\\/.-]*":(?=[ \t]|$)'},{begin:"'\\w[\\w :\\/.-]*':(?=[ \t]|$)"}]},{className:"meta",begin:"^---s*$",relevance:10},{className:"string",begin:"[\\|>]([0-9]?[+-])?[ ]*\\n( *)[\\S ]+\\n(\\2[\\S ]+\\n?)*"},{begin:"<%[%=-]?",end:"[%-]?%>",subLanguage:"ruby",excludeBegin:!0,excludeEnd:!0,relevance:0},{className:"type",begin:"!"+e.UNDERSCORE_IDENT_RE},{className:"type",begin:"!!"+e.UNDERSCORE_IDENT_RE},{className:"meta",begin:"&"+e.UNDERSCORE_IDENT_RE+"$"},{className:"meta",begin:"\\*"+e.UNDERSCORE_IDENT_RE+"$"},{className:"bullet",begin:"\\-(?=[ ]|$)",relevance:0},e.HASH_COMMENT_MODE,{beginKeywords:"true false yes no null",keywords:{literal:"true false yes no null"}},{className:"number",begin:e.C_NUMBER_RE+"\\b"},n]}}));class cn extends xe{constructor(e){super(),we(this,e,sn,rn,s,{class:"className",animation:0,color:0,family:0,name:0,title:0})}}const dn=[];function un(n,t=e){let o;const a=[];function i(e){if(s(n,e)&&(n=e,o)){const e=!dn.length;for(let e=0;e<a.length;e+=1){const t=a[e];t[1](),dn.push(t,n)}if(e){for(let e=0;e<dn.length;e+=2)dn[e][0](dn[e+1]);dn.length=0}}}return{set:i,update:function(e){i(e(n))},subscribe:function(r,s=e){const c=[r,s];return a.push(c),1===a.length&&(o=t(i)||e),r(n),()=>{const e=a.indexOf(c);-1!==e&&a.splice(e,1),0===a.length&&(o(),o=null)}}}}var ln=location.href.replace(/\/+$/,""),fn="",pn=un(""),gn=un({wideScreen:!1,width:0}),mn=un(yn(location.href)),hn=un(document.title),$n=un(null);function bn(e,n){var t=e.indexOf(n);return-1==t?null:t}function vn(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!==e){var t=yn(e);if(!t)return location.href=e;n.event&&n.event.preventDefault(),history[n.replace?"replaceState":"pushState"]({},document.title,t.toString()),setTimeout((function(){return mn.set(t)}),0)}}function yn(e){if(-1==(e="/"==e.slice(0,1)?ln+e:e).indexOf(ln))return!1;var n=new URL(e),t=e.substring(ln.length,bn(e,"?")||bn(e,"#")||e.length);Object.defineProperty(n,"path",{value:t,writable:!1});var o=t.split("/").filter((function(e){return e.length})).map(decodeURIComponent);return Object.defineProperty(n,"pathParts",{value:o,writable:!1}),n}function _n(e,n){return Ee.async((function(t){for(;;)switch(t.prev=t.next){case 0:return document.cookie=n.res.headers["Set-Cookie"],n.reset(),t.next=4,Ee.awrap(e.load());case 4:vn(e.calculateLastUrl());case 5:case"end":return t.stop()}}))}function wn(e){var n=d($n);if(e!=n){if(!n)for(var t=document.querySelectorAll(".js-remove"),o=0;o<t.length;o++)t[o].remove();$n.set(e)}}function xn(e){return mn.base+e}function kn(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:d(mn)).searchParams.forEach((function(n,t){var o=e[t];o&&o.tagName&&("checkbox"==o.type?o.checked=!!n:o.value=n,o.syncValue&&o.syncValue())}))}function En(e){let n,t,o;const a=e.$$slots.default,i=l(a,e,null);return{c(){n=N("a"),i&&i.c(),A(n,"href",e.absoluteHref),A(n,"class",e.className),A(n,"style",e.style),A(n,"title",e.title),j(n,"has-path",e.$currentUrl==e.absoluteHref.replace(/(#|\?).*/,"")),o=P(n,"click",e.onClick)},m(o,a){k(o,n,a),i&&i.m(n,null),e.a_binding(n),t=!0},p(e,o){i&&i.p&&e.$$scope&&i.p(p(a,o,e,null),f(a,o,null)),t&&!e.absoluteHref||A(n,"href",o.absoluteHref),t&&!e.className||A(n,"class",o.className),t&&!e.style||A(n,"style",o.style),t&&!e.title||A(n,"title",o.title),(e.className||e.$currentUrl||e.absoluteHref)&&j(n,"has-path",o.$currentUrl==o.absoluteHref.replace(/(#|\?).*/,""))},i(e){t||(pe(i,e),t=!0)},o(e){ge(i,e),t=!1},d(t){t&&E(n),i&&i.d(t),e.a_binding(null),o()}}}function On(e,n,t){let o;u(e,mn,e=>t("$currentUrl",o=e));let a,{class:i=""}=n,{href:r="/"}=n,{native:s=!1}=n,{replace:c=!1}=n,{style:d=""}=n,{title:l=""}=n;let f,{$$slots:p={},$$scope:g}=n;return e.$set=e=>{"class"in e&&t("className",i=e.class),"href"in e&&t("href",r=e.href),"native"in e&&t("native",s=e.native),"replace"in e&&t("replace",c=e.replace),"style"in e&&t("style",d=e.style),"title"in e&&t("title",l=e.title),"$$scope"in e&&t("$$scope",g=e.$$scope)},e.$$.update=(e={href:1})=>{e.href&&t("absoluteHref",f="/"==r.slice(0,1)?mn.base+r:r)},{className:i,el:a,href:r,native:s,replace:c,style:d,title:l,focus:()=>a.focus(),onClick:function(e){s||vn(e.target.closest("a").href,{event:e,replace:c})},absoluteHref:f,$currentUrl:o,a_binding:function(e){J[e?"unshift":"push"](()=>{t("el",a=e)})},$$slots:p,$$scope:g}}Object.defineProperty(mn,"base",{get:function(){return ln},set:function(e){ln=e.replace(/\/+$/,""),mn.set(yn(d(mn).toString()))}});class Nn extends xe{constructor(e){super(),we(this,e,On,En,s,{class:"className",href:0,native:0,replace:0,style:0,title:0,focus:0})}get focus(){return this.$$.ctx.focus}}const Cn=()=>({}),Sn=()=>({});function Dn(e){let n,t,o,a,r,s,c;const d=e.$$slots.label,u=l(d,e,Sn);return{c(){n=N("div"),t=N("label"),u||(o=C("Label")),u&&u.c(),a=S(),r=N("input"),A(t,"for",e.id),A(r,"type","text"),A(r,"autocomplete",e.autocomplete),A(r,"name",e.name),A(r,"placeholder",e.placeholder),A(r,"id",e.id),r.readOnly=e.readonly,A(n,"class","text-field"),n.hidden=e.hidden,c=[P(r,"input",e.input_input_handler),P(r,"keyup",e.keyup_handler)]},m(i,c){k(i,n,c),x(n,t),u||x(t,o),u&&u.m(t,null),x(n,a),x(n,r),T(r,e.value),e.input_binding(r),s=!0},p(e,o){u&&u.p&&e.$$scope&&u.p(p(d,o,e,Cn),f(d,o,Sn)),s&&!e.id||A(t,"for",o.id),s&&!e.autocomplete||A(r,"autocomplete",o.autocomplete),s&&!e.name||A(r,"name",o.name),s&&!e.placeholder||A(r,"placeholder",o.placeholder),s&&!e.id||A(r,"id",o.id),s&&!e.readonly||(r.readOnly=o.readonly),e.value&&r.value!==o.value&&T(r,o.value),s&&!e.hidden||(n.hidden=o.hidden)},i(e){s||(pe(u,e),s=!0)},o(e){ge(u,e),s=!1},d(t){t&&E(n),u&&u.d(t),e.input_binding(null),i(c)}}}function Pn(e,n,t){let o,{autocomplete:a=null}=n,{hidden:i=!1}=n,{name:r=""}=n,{id:s=(r?"form_"+r:en())}=n,{placeholder:c=""}=n,{readonly:d=!1}=n,{value:u=""}=n,{$$slots:l={},$$scope:f}=n;return e.$set=e=>{"autocomplete"in e&&t("autocomplete",a=e.autocomplete),"hidden"in e&&t("hidden",i=e.hidden),"name"in e&&t("name",r=e.name),"id"in e&&t("id",s=e.id),"placeholder"in e&&t("placeholder",c=e.placeholder),"readonly"in e&&t("readonly",d=e.readonly),"value"in e&&t("value",u=e.value),"$$scope"in e&&t("$$scope",f=e.$$scope)},e.$$.update=(e={inputEl:1})=>{e.inputEl&&o&&!o.syncValue&&(t("inputEl",o.syncValue=function(){t("value",u=this.value)},o),o.syncValue())},{inputEl:o,autocomplete:a,hidden:i,name:r,id:s,placeholder:c,readonly:d,value:u,keyup_handler:function(n){Z(e,n)},input_input_handler:function(){u=this.value,t("value",u),t("inputEl",o)},input_binding:function(e){J[e?"unshift":"push"](()=>{t("inputEl",o=e)})},$$slots:l,$$scope:f}}class Mn extends xe{constructor(e){super(),we(this,e,Pn,Dn,s,{autocomplete:0,hidden:0,name:0,id:0,placeholder:0,readonly:0,value:0})}}function An(e){const n=e-1;return n*n*n+1}function Rn(e,{delay:t=0,duration:o=400,easing:a=n}){const i=+getComputedStyle(e).opacity;return{delay:t,duration:o,easing:a,css:e=>`opacity: ${e*i}`}}function Tn(e,{delay:n=0,duration:t=400,easing:o=An,x:a=0,y:i=0,opacity:r=0}){const s=getComputedStyle(e),c=+s.opacity,d="none"===s.transform?"":s.transform,u=c*(1-r);return{delay:n,duration:t,easing:o,css:(e,n)=>`\n\t\t\ttransform: ${d} translate(${(1-e)*a}px, ${(1-e)*i}px);\n\t\t\topacity: ${c-u*n}`}}
/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */var Ln=function(){var e={base:"https://twemoji.maxcdn.com/v/12.1.3/",ext:".png",size:"72x72",className:"emoji",convert:{fromCodePoint:function(e){var n="string"==typeof e?parseInt(e,16):e;if(n<65536)return s(n);return s(55296+((n-=65536)>>10),56320+(1023&n))},toCodePoint:h},onerror:function(){this.parentNode&&this.parentNode.replaceChild(c(this.alt,!1),this)},parse:function(n,t){t&&"function"!=typeof t||(t={callback:t});return("string"==typeof n?f:l)(n,{callback:t.callback||d,attributes:"function"==typeof t.attributes?t.attributes:g,base:"string"==typeof t.base?t.base:e.base,ext:t.ext||e.ext,size:t.folder||(o=t.size||e.size,"number"==typeof o?o+"x"+o:o),className:t.className||e.className,onerror:t.onerror||e.onerror});var o},replace:m,test:function(e){t.lastIndex=0;var n=t.test(e);return t.lastIndex=0,n}},n={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},t=/(?:\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c\udffb|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c\udffb|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c\udffb|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb\udffc]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udffd]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d])|(?:\ud83d[\udc68\udc69])(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f)|[#*0-9]\ufe0f?\u20e3|(?:[\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a-\udc6d\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5\udeeb\udeec\udef4-\udefa\udfe0-\udfeb]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd71\udd73-\udd76\udd7a-\udda2\udda5-\uddaa\uddae-\uddb4\uddb7\uddba\uddbc-\uddca\uddd0\uddde-\uddff\ude70-\ude73\ude78-\ude7a\ude80-\ude82\ude90-\ude95]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,o=/\uFE0F/g,a=String.fromCharCode(8205),i=/[&<>'"]/g,r=/^(?:iframe|noframes|noscript|script|select|style|textarea)$/,s=String.fromCharCode;return e;function c(e,n){return document.createTextNode(n?e.replace(o,""):e)}function d(e,n){return"".concat(n.base,n.size,"/",e,n.ext)}function u(e){return h(e.indexOf(a)<0?e.replace(o,""):e)}function l(e,n){for(var o,a,i,s,d,l,f,p,g,m,h,$,b,v=function e(n,t){for(var o,a,i=n.childNodes,s=i.length;s--;)3===(a=(o=i[s]).nodeType)?t.push(o):1!==a||"ownerSVGElement"in o||r.test(o.nodeName.toLowerCase())||e(o,t);return t}(e,[]),y=v.length;y--;){for(i=!1,s=document.createDocumentFragment(),l=(d=v[y]).nodeValue,p=0;f=t.exec(l);){if((g=f.index)!==p&&s.appendChild(c(l.slice(p,g),!0)),$=u(h=f[0]),p=g+h.length,b=n.callback($,n),$&&b){for(a in(m=new Image).onerror=n.onerror,m.setAttribute("draggable","false"),o=n.attributes(h,$))o.hasOwnProperty(a)&&0!==a.indexOf("on")&&!m.hasAttribute(a)&&m.setAttribute(a,o[a]);m.className=n.className,m.alt=h,m.src=b,i=!0,s.appendChild(m)}m||s.appendChild(c(h,!1)),m=null}i&&(p<l.length&&s.appendChild(c(l.slice(p),!0)),d.parentNode.replaceChild(s,d))}return e}function f(e,n){return m(e,(function(e){var t,o,a=e,r=u(e),s=n.callback(r,n);if(r&&s){for(o in a="<img ".concat('class="',n.className,'" ','draggable="false" ','alt="',e,'"',' src="',s,'"'),t=n.attributes(e,r))t.hasOwnProperty(o)&&0!==o.indexOf("on")&&-1===a.indexOf(" "+o+"=")&&(a=a.concat(" ",o,'="',t[o].replace(i,p),'"'));a=a.concat("/>")}return a}))}function p(e){return n[e]}function g(){return null}function m(e,n){return String(e).replace(t,n)}function h(e,n){for(var t=[],o=0,a=0,i=0;i<e.length;)o=e.charCodeAt(i++),a?(t.push((65536+(a-55296<<10)+(o-56320)).toString(16)),a=0):55296<=o&&o<=56319?a=o:t.push(o.toString(16));return t.join(n||"-")}}(),jn=new RegExp("(\\\\?)`([^`]+)`","g"),In={},Un={},zn=new RegExp("\\b[a-z]{2,5}://\\S+","g"),Bn=new RegExp("\\[([^]+)\\]\\(([^)]+)\\)"),Hn=new RegExp("(^|\\s)(\\\\?)(\\*+|_+)(\\w[^<]*?)\\3","g"),qn={":confused:":":/",":disappointed:":":(",":grin:":";D",":heart:":"&lt;3",":slight_smile:":":)",":smiley:":":D",":stuck_out_tongue:":":P",":wink:":";)"},Fn=new RegExp("(^|\\s)(:\\w+:|"+Object.keys(qn).map((function(e){return Ze(qn[e])})).join("|")+")(?=\\W|$)","gi"),Kn={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"};function Gn(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"single";return window.__emojiList&&(window.__emojiList.forEach((function(e){if(":"==(e.shortname||"")[0]){if(qn[e.shortname]&&(Un[qn[e.shortname]]=e),Un[e.shortname]=e,e.category){var n=":"+e.category;In[n]||(In[n]=[]),In[n].push(e)}e.shortname.match(/(_|:)\w/g).forEach((function(n){In[n]||(In[n]=[]),In[n].push(e)})),delete e.category,delete e.html,delete e.order,delete e.unicode}})),delete window.__emojiList),"group"==n?In[e]||[]:Un[e]||{}}function Wn(e){return e=(e=(e=e.replace(/[&<>"']/g,(function(e){return Kn[e]}))).replace(/^&gt;\s(.*)/,(function(e,n){return"<blockquote>"+n+"</blockquote>"})).replace(Hn,(function(e,n,t,o,a){return o.match(/^_/)&&a.match(/^[A-Z]+$/)?e:1==o.length?t?e.replace(/^\\/,""):n+"<em>"+a+"</em>":2==o.length?t?e.replace(/^\\/,""):n+"<strong>"+a+"</strong>":3==o.length?t?e.replace(/^\\/,""):n+"<em><strong>"+a+"</strong></em>":e})).replace(Bn,(function(e,n,t){return'<a href="'+t+'">'+n+"</a>"})).replace(jn,(function(e,n,t){return n?e.replace(/^\\/,""):"<code>"+t+"</code>"}))).replace(zn,(function(e){if(-1!=e.indexOf("</a>"))return e;var n=e.match(/^(.*?)(&\w+;|\W)?$/);return'<a href="'+n[1]+'" target="_blank">'+n[1].replace(/^https:\/\//,"")+"</a>"+(n[2]||"")})).replace(/mailto:(\S+)/,(function(e,n){return-1!=e.indexOf('">')?e:'<a href="'+e+'" target="_blank">'+n+"</a>"})),e=Ln.parse(e.replace(Fn,(function(e,n,t){return n+(Gn(t).emoji||t)})))}var Vn={en:{}},Zn="en";function Yn(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),o=1;o<n;o++)t[o-1]=arguments[o];return String(Vn[e]&&Vn[e][Zn]||e).replace(/%(\d+)/g,(function(e,n){return t[n-1]}))}function Jn(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),o=1;o<n;o++)t[o-1]=arguments[o];return Wn(Yn.apply(void 0,[e].concat(t)))}function Qn(e,n){return e.frozen?Yn(e.frozen):e==n?Yn("Connection messages."):(n.frozen?Yn(n.frozen):n.topic)||n.is_private&&Yn("Private conversation.")||Yn("No topic is set.")}function Xn(e,n,t){const o=Object.create(e);return o.dialog=n[t],o}function et(e,n,t){const o=Object.create(e);return o.connection=n[t],o}function nt(e){let n,t,o,a,i,r,s,c,d=e.connection.connection_id+"",u=pt(e.connection)+"";const l=new cn({props:{name:"network-wired"}});return{c(){ve(l.$$.fragment),n=S(),t=N("span"),o=C(d),a=S(),i=N("b"),r=C(u),A(i,"class","unread"),i.hidden=s=!e.connection.unread},m(e,s){ye(l,e,s),k(e,n,s),k(e,t,s),x(t,o),k(e,a,s),k(e,i,s),x(i,r),c=!0},p(e,n){c&&!e.$user||d===(d=n.connection.connection_id+"")||R(o,d),c&&!e.$user||u===(u=pt(n.connection)+"")||R(r,u),(!c||e.$user&&s!==(s=!n.connection.unread))&&(i.hidden=s)},i(e){c||(pe(l.$$.fragment,e),c=!0)},o(e){ge(l.$$.fragment,e),c=!1},d(e){_e(l,e),e&&E(n),e&&E(t),e&&E(a),e&&E(i)}}}function tt(e){let n,t,o,a,i,r,s,c,d=e.dialog.name+"",u=pt(e.dialog)+"";const l=new cn({props:{name:e.dialog.is_private?"user":"user-friends"}});return{c(){ve(l.$$.fragment),n=S(),t=N("span"),o=C(d),a=S(),i=N("b"),r=C(u),A(i,"class","unread"),i.hidden=s=!e.dialog.unread},m(e,s){ye(l,e,s),k(e,n,s),k(e,t,s),x(t,o),k(e,a,s),k(e,i,s),x(i,r),c=!0},p(e,n){const t={};e.$user&&(t.name=n.dialog.is_private?"user":"user-friends"),l.$set(t),c&&!e.$user||d===(d=n.dialog.name+"")||R(o,d),c&&!e.$user||u===(u=pt(n.dialog)+"")||R(r,u),(!c||e.$user&&s!==(s=!n.dialog.unread))&&(i.hidden=s)},i(e){c||(pe(l.$$.fragment,e),c=!0)},o(e){ge(l.$$.fragment,e),c=!1},d(e){_e(l,e),e&&E(n),e&&E(t),e&&E(a),e&&E(i)}}}function ot(e){let n;const t=new Nn({props:{href:e.dialog.path,class:ft(e.connection,e.dialog),title:Qn(e.connection,e.dialog),$$slots:{default:[tt]},$$scope:{ctx:e}}});return{c(){ve(t.$$.fragment)},m(e,o){ye(t,e,o),n=!0},p(e,n){const o={};e.$user&&(o.href=n.dialog.path),e.$user&&(o.class=ft(n.connection,n.dialog)),e.$user&&(o.title=Qn(n.connection,n.dialog)),(e.$$scope||e.$user)&&(o.$$scope={changed:e,ctx:n}),t.$set(o)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function at(e){let n,t,o;const a=new Nn({props:{href:e.connection.path,class:ft(e.connection,e.connection),title:Qn(e.connection,e.connection),$$slots:{default:[nt]},$$scope:{ctx:e}}});let i=e.connection.dialogs.toArray(),r=[];for(let n=0;n<i.length;n+=1)r[n]=ot(Xn(e,i,n));const s=e=>ge(r[e],1,1,()=>{r[e]=null});return{c(){ve(a.$$.fragment),n=S();for(let e=0;e<r.length;e+=1)r[e].c();t=D()},m(e,i){ye(a,e,i),k(e,n,i);for(let n=0;n<r.length;n+=1)r[n].m(e,i);k(e,t,i),o=!0},p(e,n){const o={};if(e.$user&&(o.href=n.connection.path),e.$user&&(o.class=ft(n.connection,n.connection)),e.$user&&(o.title=Qn(n.connection,n.connection)),(e.$$scope||e.$user)&&(o.$$scope={changed:e,ctx:n}),a.$set(o),e.$user||e.dialogClassNames||e.topicOrStatus||e.renderUnread){let o;for(i=n.connection.dialogs.toArray(),o=0;o<i.length;o+=1){const a=Xn(n,i,o);r[o]?(r[o].p(e,a),pe(r[o],1)):(r[o]=ot(a),r[o].c(),pe(r[o],1),r[o].m(t.parentNode,t))}for(le(),o=i.length;o<r.length;o+=1)s(o);fe()}},i(e){if(!o){pe(a.$$.fragment,e);for(let e=0;e<i.length;e+=1)pe(r[e]);o=!0}},o(e){ge(a.$$.fragment,e),r=r.filter(Boolean);for(let e=0;e<r.length;e+=1)ge(r[e]);o=!1},d(e){_e(a,e),e&&E(n),O(r,e),e&&E(t)}}}function it(e){let n,t,o,a,i,r,s,c=pt(e.$notifications)+"";const d=new cn({props:{name:e.$notifications.unread?"bell":"bell-slash"}});return{c(){ve(d.$$.fragment),n=S(),(t=N("span")).textContent=`${Yn("Notifications")}`,o=S(),a=N("b"),i=C(c),A(a,"class","unread"),a.hidden=r=!e.$notifications.unread},m(e,r){ye(d,e,r),k(e,n,r),k(e,t,r),k(e,o,r),k(e,a,r),x(a,i),s=!0},p(e,n){const t={};e.$notifications&&(t.name=n.$notifications.unread?"bell":"bell-slash"),d.$set(t),s&&!e.$notifications||c===(c=pt(n.$notifications)+"")||R(i,c),(!s||e.$notifications&&r!==(r=!n.$notifications.unread))&&(a.hidden=r)},i(e){s||(pe(d.$$.fragment,e),s=!0)},o(e){ge(d.$$.fragment,e),s=!1},d(e){_e(d,e),e&&E(n),e&&E(t),e&&E(o),e&&E(a)}}}function rt(n){let t,o,a;const i=new cn({props:{name:"comment"}});return{c(){ve(i.$$.fragment),t=S(),(o=N("span")).textContent=`${Yn("Add conversation")}`},m(e,n){ye(i,e,n),k(e,t,n),k(e,o,n),a=!0},p:e,i(e){a||(pe(i.$$.fragment,e),a=!0)},o(e){ge(i.$$.fragment,e),a=!1},d(e){_e(i,e),e&&E(t),e&&E(o)}}}function st(n){let t,o,a;const i=new cn({props:{name:"network-wired"}});return{c(){ve(i.$$.fragment),t=S(),(o=N("span")).textContent=`${Yn("Add connection")}`},m(e,n){ye(i,e,n),k(e,t,n),k(e,o,n),a=!0},p:e,i(e){a||(pe(i.$$.fragment,e),a=!0)},o(e){ge(i.$$.fragment,e),a=!1},d(e){_e(i,e),e&&E(t),e&&E(o)}}}function ct(n){let t,o,a;const i=new cn({props:{name:"cog"}});return{c(){ve(i.$$.fragment),t=S(),(o=N("span")).textContent=`${Yn("Settings")}`},m(e,n){ye(i,e,n),k(e,t,n),k(e,o,n),a=!0},p:e,i(e){a||(pe(i.$$.fragment,e),a=!0)},o(e){ge(i.$$.fragment,e),a=!1},d(e){_e(i,e),e&&E(t),e&&E(o)}}}function dt(n){let t,o,a;const i=new cn({props:{name:"question-circle"}});return{c(){ve(i.$$.fragment),t=S(),(o=N("span")).textContent=`${Yn("Help")}`},m(e,n){ye(i,e,n),k(e,t,n),k(e,o,n),a=!0},p:e,i(e){a||(pe(i.$$.fragment,e),a=!0)},o(e){ge(i.$$.fragment,e),a=!1},d(e){_e(i,e),e&&E(t),e&&E(o)}}}function ut(n){let t,o,a;const i=new cn({props:{name:"power-off"}});return{c(){ve(i.$$.fragment),t=S(),(o=N("span")).textContent=`${Yn("Log out")}`},m(e,n){ye(i,e,n),k(e,t,n),k(e,o,n),a=!0},p:e,i(e){a||(pe(i.$$.fragment,e),a=!0)},o(e){ge(i.$$.fragment,e),a=!1},d(e){_e(i,e),e&&E(t),e&&E(o)}}}function lt(e){let n,t,o,a,r,s,c,d,u,l,f,p,g,m,h,$,b,v,y,_,w,D,M=(e.$user.email||Yn("Account"))+"";const L=new cn({props:{name:"search"}});let I=e.$user.connections.toArray(),U=[];for(let n=0;n<I.length;n+=1)U[n]=at(et(e,I,n));const z=e=>ge(U[e],1,1,()=>{U[e]=null}),B=new Nn({props:{href:"/chat",$$slots:{default:[it]},$$scope:{ctx:e}}}),H=new Nn({props:{href:"/add/conversation",$$slots:{default:[rt]},$$scope:{ctx:e}}}),q=new Nn({props:{href:"/add/connection",$$slots:{default:[st]},$$scope:{ctx:e}}}),F=new Nn({props:{href:"/settings",$$slots:{default:[ct]},$$scope:{ctx:e}}}),K=new Nn({props:{href:"/help",$$slots:{default:[dt]},$$scope:{ctx:e}}}),G=new Nn({props:{href:"/api/user/logout.html",native:!0,$$slots:{default:[ut]},$$scope:{ctx:e}}});return{c(){n=N("div"),t=N("form"),o=N("input"),r=S(),s=N("label"),ve(L.$$.fragment),c=S(),d=N("nav"),(u=N("h3")).textContent=`${Yn("Conversations")}`,l=S();for(let e=0;e<U.length;e+=1)U[e].c();f=S(),p=N("h3"),g=C(M),m=S(),ve(B.$$.fragment),h=S(),ve(H.$$.fragment),$=S(),ve(q.$$.fragment),b=S(),ve(F.$$.fragment),v=S(),ve(K.$$.fragment),y=S(),ve(G.$$.fragment),A(o,"type","text"),A(o,"id","sidebar_left_search_input"),A(o,"placeholder",a=e.searchHasFocus?Yn("Search..."):Yn("Convos")),A(s,"for","sidebar_left_search_input"),A(t,"class","sidebar__header"),A(d,"class","sidebar-left__nav"),j(d,"is-filtering",e.filter.length>0),A(n,"class","sidebar-left"),D=[P(o,"input",e.input_input_handler),P(o,"blur",e.clearFilter),P(o,"focus",e.filterNav),P(o,"keydown",e.onSearchKeydown),P(t,"submit",gt),P(d,"click",e.onNavItemClicked)]},m(a,i){k(a,n,i),x(n,t),x(t,o),T(o,e.filter),x(t,r),x(t,s),ye(L,s,null),x(n,c),x(n,d),x(d,u),x(d,l);for(let e=0;e<U.length;e+=1)U[e].m(d,null);x(d,f),x(d,p),x(p,g),x(d,m),ye(B,d,null),x(d,h),ye(H,d,null),x(d,$),ye(q,d,null),x(d,b),ye(F,d,null),x(d,v),ye(K,d,null),x(d,y),ye(G,d,null),e.nav_binding(d),w=!0},p(e,n){if((!w||e.searchHasFocus&&a!==(a=n.searchHasFocus?Yn("Search..."):Yn("Convos")))&&A(o,"placeholder",a),e.filter&&o.value!==n.filter&&T(o,n.filter),e.$user||e.dialogClassNames||e.topicOrStatus||e.renderUnread){let t;for(I=n.$user.connections.toArray(),t=0;t<I.length;t+=1){const o=et(n,I,t);U[t]?(U[t].p(e,o),pe(U[t],1)):(U[t]=at(o),U[t].c(),pe(U[t],1),U[t].m(d,f))}for(le(),t=I.length;t<U.length;t+=1)z(t);fe()}w&&!e.$user||M===(M=(n.$user.email||Yn("Account"))+"")||R(g,M);const t={};(e.$$scope||e.$notifications)&&(t.$$scope={changed:e,ctx:n}),B.$set(t);const i={};e.$$scope&&(i.$$scope={changed:e,ctx:n}),H.$set(i);const r={};e.$$scope&&(r.$$scope={changed:e,ctx:n}),q.$set(r);const s={};e.$$scope&&(s.$$scope={changed:e,ctx:n}),F.$set(s);const c={};e.$$scope&&(c.$$scope={changed:e,ctx:n}),K.$set(c);const u={};e.$$scope&&(u.$$scope={changed:e,ctx:n}),G.$set(u),e.filter&&j(d,"is-filtering",n.filter.length>0)},i(t){if(!w){pe(L.$$.fragment,t);for(let e=0;e<I.length;e+=1)pe(U[e]);pe(B.$$.fragment,t),pe(H.$$.fragment,t),pe(q.$$.fragment,t),pe(F.$$.fragment,t),pe(K.$$.fragment,t),pe(G.$$.fragment,t),ae(()=>{_||(_=he(n,Tn,e.transition,!0)),_.run(1)}),w=!0}},o(t){ge(L.$$.fragment,t),U=U.filter(Boolean);for(let e=0;e<U.length;e+=1)ge(U[e]);ge(B.$$.fragment,t),ge(H.$$.fragment,t),ge(q.$$.fragment,t),ge(F.$$.fragment,t),ge(K.$$.fragment,t),ge(G.$$.fragment,t),_||(_=he(n,Tn,e.transition,!1)),_.run(0),w=!1},d(t){t&&E(n),_e(L),O(U,t),_e(B),_e(H),_e(q),_e(F),_e(K),_e(G),e.nav_binding(null),t&&_&&_.end(),i(D)}}}function ft(e,n){const t=[n.dialog_id?"for-dialog":"for-connection"];return(n.frozen||"connected"!=e.state)&&t.push("is-frozen"),n.errors&&t.push("has-errors"),t.join(" ")}function pt(e){return e.unread>60?"60+":e.unread||0}const gt=e=>e.preventDefault();function mt(e,n,t){let o,a,i;u(e,pn,e=>t("$activeMenu",a=e));let{transition:r}=n;const s=V("user");u(e,s,e=>t("$user",o=e));const c=o.notifications;u(e,c,e=>t("$notifications",i=e));let d,l=0,f="",p=!1,m=[];function h(){t("searchHasFocus",p=!1),setTimeout(()=>{t("filter",f="")},100)}function $(){if(!d)return;const e=f.match(/^\W+/)?"":"\\b\\W*",n=new RegExp(e+Ze(f),"i"),o={};t("activeLinkIndex",l=0),t("searchHasFocus",p=!0),t("visibleLinks",m=[]),Ve(d,"a",(e,a)=>{const i=e.classList;!f.length&&i.contains("has-path")&&t("activeLinkIndex",l=a),i.remove("has-focus");const r=!f.length||!o[e.href]&&e.textContent.match(n);r&&m.push(e),Je(e,r),o[e.href]=!0}),Ve(d,".for-connection",e=>{let n=e;for(;(n=n.nextElementSibling)&&n.classList.contains("for-dialog");)if(Je(n,"is-visible"))return Je(e,!0)}),Ve(d,"h3",e=>{let n=e;for(;(n=n.nextElementSibling)&&!Xe(n,"h3");)if(Je(n,"is-visible"))return Je(e,!0);Je(e,!1)})}return e.$set=e=>{"transition"in e&&t("transition",r=e.transition)},e.$$.update=(e={filter:1,visibleLinks:1,activeLinkIndex:1})=>{e.filter&&$(),(e.visibleLinks||e.activeLinkIndex)&&m[l]&&m[l].classList.add("has-focus")},{transition:r,user:s,notifications:c,filter:f,navEl:d,searchHasFocus:p,clearFilter:h,filterNav:$,onNavItemClicked:function(e){(e.target.className||"").match(/network|user/)&&setTimeout(()=>{g(pn,a="settings")},50)},onSearchKeydown:function(e){if(13==e.keyCode)return e.preventDefault(),h(),void(m[l]&&vn(m[l].href));const n=38==e.keyCode?-1:40==e.keyCode?1:0;n&&(e.preventDefault(),m[l]&&m[l].classList.remove("has-focus"),t("activeLinkIndex",l+=e.ctrlKey?4*n:n)),l<0&&t("activeLinkIndex",l=m.length-1),l>=m.length&&t("activeLinkIndex",l=0)},$user:o,$notifications:i,input_input_handler:function(){f=this.value,t("filter",f)},nav_binding:function(e){J[e?"unshift":"push"](()=>{t("navEl",d=e)})}}}class ht extends xe{constructor(e){super(),we(this,e,mt,lt,s,{transition:0})}}function $t(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Convos")}`},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function bt(n){let t,o=Yn("Login")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function vt(n){let t,o=Yn("Create account")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function yt(n){let t,o=Yn("Documentation")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function _t(n){let t,o=Yn("GitHub")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function wt(e){let n,t,o,a,i,r,s,c,d,u;const l=new Nn({props:{href:"/",$$slots:{default:[$t]},$$scope:{ctx:e}}}),f=new Nn({props:{href:"/login",$$slots:{default:[bt]},$$scope:{ctx:e}}}),p=new Nn({props:{href:"/register",$$slots:{default:[vt]},$$scope:{ctx:e}}}),g=new Nn({props:{href:"https://convos.by/doc",$$slots:{default:[yt]},$$scope:{ctx:e}}}),m=new Nn({props:{href:"https://github.com/Nordaaker/convos",$$slots:{default:[_t]},$$scope:{ctx:e}}});return{c(){n=N("div"),t=N("h1"),ve(l.$$.fragment),o=S(),(a=N("p")).textContent=`${Yn("A multiuser chat application.")}`,i=S(),r=N("nav"),ve(f.$$.fragment),s=S(),ve(p.$$.fragment),c=S(),ve(g.$$.fragment),d=S(),ve(m.$$.fragment),A(r,"class","sidebar-left__nav"),A(n,"class","sidebar-left")},m(e,h){k(e,n,h),x(n,t),ye(l,t,null),x(n,o),x(n,a),x(n,i),x(n,r),ye(f,r,null),x(r,s),ye(p,r,null),x(r,c),ye(g,r,null),x(r,d),ye(m,r,null),u=!0},p(e,n){const t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),l.$set(t);const o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),f.$set(o);const a={};e.$$scope&&(a.$$scope={changed:e,ctx:n}),p.$set(a);const i={};e.$$scope&&(i.$$scope={changed:e,ctx:n}),g.$set(i);const r={};e.$$scope&&(r.$$scope={changed:e,ctx:n}),m.$set(r)},i(e){u||(pe(l.$$.fragment,e),pe(f.$$.fragment,e),pe(p.$$.fragment,e),pe(g.$$.fragment,e),pe(m.$$.fragment,e),u=!0)},o(e){ge(l.$$.fragment,e),ge(f.$$.fragment,e),ge(p.$$.fragment,e),ge(g.$$.fragment,e),ge(m.$$.fragment,e),u=!1},d(e){e&&E(n),_e(l),_e(f),_e(p),_e(g),_e(m)}}}class xt extends xe{constructor(e){super(),we(this,e,null,wt,s,{})}}var kt=function(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&null!==(e=Le(e)););return e},Et=ke((function(e){function n(t,o,a){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=n=Reflect.get:e.exports=n=function(e,n,t){var o=kt(e,n);if(o){var a=Object.getOwnPropertyDescriptor(o,n);return a.get?a.get.call(t):a.value}},n(t,o,a||t)}e.exports=n})),Ot=function(){function e(n){var t=this;Oe(this,e),this._url=new URL("http://localhost"),Object.defineProperty(this,"href",{get:function(){return t._url.href.replace(/^http:/,t.protocol)},set:function(e){t._url.href=e.replace(/^\w+:/,"http:"),t.protocol=e.match(/^\w+:/)[0]}}),["host","pathname","password","searchParams","username"].forEach((function(e){Object.defineProperty(t,e,{get:function(){return t._url[e]},set:function(n){t._url[e]=n}})})),this.href=n}return Ce(e,[{key:"fromForm",value:function(e){var n=e.server.value;return e.nick.value.length&&this.searchParams.append("nick",e.nick.value),this.searchParams.append("tls",e.tls.checked?"1":"0"),this.searchParams.append("tls_verify",e.tls_verify&&e.tls_verify.checked?"1":"0"),this.host=n.match(/:\d+$/)?n:n+":6667",this.password=e.password.value,this.username=e.username.value,this}},{key:"toString",value:function(){return this.href.replace(/^http:/,this.connProtocol)}}]),e}();var Nt=function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}};var Ct=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)};var St=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")};var Dt=function(e){return Nt(e)||Ct(e)||St()};var Pt=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},Mt=ke((function(e){function n(t,o,a){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?e.exports=n=function(e,n,t){var o=[null];o.push.apply(o,n);var a=new(Function.bind.apply(e,o));return t&&je(a,t.prototype),a}:e.exports=n=Reflect.construct,n.apply(null,arguments)}e.exports=n})),At=ke((function(e){function n(t){var o="function"==typeof Map?new Map:void 0;return e.exports=n=function(e){if(null===e||!Pt(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==o){if(o.has(e))return o.get(e);o.set(e,n)}function n(){return Mt(e,arguments,Le(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),je(n,e)},n(t)}e.exports=n})),Rt=function(e,n){return e.name.localeCompare(n.name)},Tt=function(e){function n(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Oe(this,n),(e=Te(this,Le(n).call(this,t))).sorter=o.sorter||Rt,e._sort(),e}return Ie(n,e),Ce(n,[{key:"filter",value:function(e){return Array.from(this.values()).filter(e)}},{key:"set",value:function(e,t){Et(Le(n.prototype),"set",this).call(this,e,t),this._sort()}},{key:"toArray",value:function(){return Array.from(this.values())}},{key:"_sort",value:function(){var e=this,t=Array.from(this.entries()),o=this.sorter;return this.clear(),t.sort((function(e,n){return o(e[1],n[1])})).forEach((function(t){var o=Ae(t,2),a=o[0],i=o[1];return Et(Le(n.prototype),"set",e).call(e,a,i)})),t}}]),n}(At(Map)),Lt={0:"Jan",1:"Feb",2:"March",3:"Apr",4:"May",5:"Jun",6:"July",7:"Aug",8:"Sept",9:"Oct",10:"Nov",11:"Dec"},jt=function(e){function n(e){return Oe(this,n),"string"!=typeof e||e.match(/Z$/)||(e+="Z"),Te(this,Le(n).call(this,e||new Date))}return Ie(n,e),Ce(n,[{key:"getHumanDate",value:function(){var e=this.getMonthAbbr()+" "+this.getDate(),t=new n;return this.getYear()==t.getYear()||(e+=", "+this.getFullYear()),e}},{key:"getHM",value:function(){return[this.getHours(),this.getMinutes()].map((function(e){return e<10?"0"+e:e})).join(":")}},{key:"getMonthAbbr",value:function(){return Lt[this.getMonth()]||""}},{key:"toEpoch",value:function(){return this.getTime()/1e3}}]),n}(At(Date)),It={b:"channel_ban",C:"ctcp_block",c:"colour_filter",e:"ban_exemption",F:"enable_forwarding",f:"forward",g:"free_invite",I:"invite_exemption",j:"join_throttle",k:"password",l:"join_limit",L:"large_ban_list",m:"moderated",n:"prevent_external_send",P:"permanent",p:"privat",Q:"block_forwarded_users",q:"quiet",r:"block_unidentified",s:"secret",S:"secure_connection_only",t:"ops_topic"},Ut={a:"admin",B:"bot",h:"half_operator",i:"invisible",I:"whois_hide_online",o:"operator",p:"whois_hide_channels",R:"privmsg_from_registered_only",r:"registered",S:"service_bot",T:"ctcp_block",t:"vhost",v:"voice",W:"whois_notifications",x:"cloaked_hostname",z:"secure_connection",Z:"secure_connection_only"};function zt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function Bt(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?zt(t,!0).forEach((function(n){Ue(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):zt(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Ht=new RegExp("^[#&]"),qt={o:"@",v:"+"},Ft=function(e,n){return n.modes.operator||!1-e.modes.operator||n.modes.voice||!1-e.modes.voice||e.name.localeCompare(n.name)},Kt=function(e){function n(e){var t;Oe(this,n),t=Te(this,Le(n).call(this));var o=["","chat"];return e.connection_id&&o.push(e.connection_id),e.dialog_id&&o.push(e.dialog_id),e.connection_id&&!e.name&&console.trace("[Convos] Invalid params was passed on to new Dialog(",e,")"),t.prop("ro","_participants",new Tt([],{sorter:Ft})),t.prop("ro","api",e.api),t.prop("ro","color",Qe(e.dialog_id||e.connection_id||"")),t.prop("ro","connection_id",e.connection_id||""),t.prop("ro","events",e.events),t.prop("ro","is_private",(function(){return!Ht.test(t.name)})),t.prop("ro","path",o.map((function(e){return encodeURIComponent(e)})).join("/")),t.prop("rw","errors",0),t.prop("rw","last_active",new jt(e.last_active)),t.prop("rw","last_read",new jt(e.last_read)),t.prop("rw","messages",[]),t.prop("rw","modes",{}),t.prop("rw","name",e.name||e.dialog_id||"#unknown"),t.prop("rw","status","pending"),t.prop("rw","topic",e.topic||""),t.prop("rw","unread",e.unread||0),e.hasOwnProperty("dialog_id")?(t.prop("ro","dialog_id",e.dialog_id),t.prop("rw","frozen",e.frozen||"")):t.prop("ro","frozen",(function(){return t._calculateFrozen()})),t._addOperations(),t}return Ie(n,e),Ce(n,[{key:"addMessage",value:function(e){e.highlight&&this.events.notifyUser(e.from,e.message),this.addMessages("push",[e]),-1!=["action","error","private"].indexOf(e.type)&&this.update({unread:this.unread+1})}},{key:"addMessages",value:function(e,n){var t=0,o=n.length;switch(e){case"push":t=this.messages.length,o=(n=this.messages.concat(n)).length;break;case"unshift":n=n.concat(this.messages)}for(var a=t;a<o;a++){var i=n[a];i.hasOwnProperty("markdown")||(i.from||(i.from=this.connection_id||"Convos"),i.type||(i.type="notice"),i.vars&&(i.message=Yn.apply(void 0,[i.message].concat(Dt(i.vars)))),i.color=Qe(i.from.toLowerCase()),i.ts=new jt(i.ts),i.dayChanged=0!=a&&i.ts.getDate()!=n[a-1].ts.getDate(),i.embeds=(i.message.match(/https?:\/\/(\S+)/g)||[]).map((function(e){return e.replace(/(\W)?$/,"")})),i.fromId=i.from.toLowerCase(),i.isSameSender=0!=a&&n[a].from==n[a-1].from,i.markdown=Wn(i.message))}return this.update({messages:n}),this}},{key:"is",value:function(e){return"frozen"==e?this.frozen&&!0:"private"==e?this.is_private:"unread"==e?this.unread&&!0:this.status==e}},{key:"load",value:function(e){var n,t,o;return Ee.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.before,this.messagesOp&&!this.is("loading")){a.next=3;break}return a.abrupt("return",this);case 3:if(t={connection_id:this.connection_id,dialog_id:this.dialog_id},!n||!n.endOfHistory){a.next=6;break}return a.abrupt("return");case 6:return n&&n.ts&&(n=n.ts.toISOString()),n&&(t.before=n),this.update({status:"loading"}),a.next=11,Ee.awrap(this.messagesOp.perform(t));case 11:return o=this.messagesOp.res.body,this.addMessages("unshift",o.messages||[]),this.update({status:"success"}),o.end&&this.messages.length&&(this.messages[0].endOfHistory=!0),a.abrupt("return",this);case 16:case"end":return a.stop()}}),null,this)}},{key:"findParticipant",value:function(e){return this._participants.get(this._participantId(void 0===e?"":e))}},{key:"participants",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return n.forEach((function(n){n.nick||(n.nick=n.name);var t=e._participantId(n.nick),o=e._participants.get(t);o&&(Object.keys(n).forEach((function(e){o[e]=n[e]})),n=o),n.modes||(n.modes={}),e._calculateModes(Ut,n.mode,n.modes),delete n.mode,e._participants.set(t,Bt({name:n.nick},n,{color:Qe(t),id:t,ts:new jt}))})),n.length&&this.update({participants:this._participants.size}),this._participants.toArray()}},{key:"send",value:function(e,n){this.events.send({connection_id:this.connection_id,dialog_id:this.dialog_id||"",message:e},n?this[n].bind(this):null)}},{key:"setLastRead",value:function(){return Ee.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setLastReadOp){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Ee.awrap(this.setLastReadOp.perform({connection_id:this.connection_id,dialog_id:this.dialog_id}));case 4:this.update(Bt({errors:0,unread:0},this.setLastReadOp.res.body));case 5:case"end":return e.stop()}}),null,this)}},{key:"update",value:function(e){return this._loadParticipants(),Et(Le(n.prototype),"update",this).call(this,e)}},{key:"wsEventMode",value:function(e){e.nick?(this.participants([{nick:e.nick,mode:e.mode}]),this.addMessage({message:"%1 got mode %2 from %3.",vars:[e.nick,e.mode,e.from]})):this.update({modes:this._calculateModes(It,e.mode,this.modes)})}},{key:"wsEventNickChange",value:function(e){var n=this._participantId(e.old_nick);if(this._participants.has(n)&&e.old_nick!=e.new_nick){this._participants.delete(n);var t="me"==e.type?"You (%1) changed nick to %2.":"%1 changed nick to %2.";this.addMessage({message:t,vars:[e.old_nick,e.new_nick]})}}},{key:"wsEventPart",value:function(e){var n=this.findParticipant(e.nick);n&&!n.me&&(this._participants.delete(this._participantId(e.nick)),this.update({participants:this._participants.size}),this.addMessage(this._partMessage(e)))}},{key:"wsEventSentNames",value:function(e){this._updateParticipants(e);var n={message:"Participants (%1): %2",vars:[]},t=this._participants.map((function(e){return(qt[e.mode]||"")+e.name}));t.length>1&&(n.message+=" and %3.",n.vars[2]=t.pop()),n.vars[0]=t.length,n.vars[1]=t.join(", "),this.addMessage(n)}},{key:"_addOperations",value:function(){this.prop("ro","messagesOp",this.api.operation("dialogMessages")),this.prop("ro","setLastReadOp",this.api.operation("setDialogLastRead"))}},{key:"_calculateModes",value:function(e,n,t){var o=(n||"").match(/^(\+|-)?(.*)/)||["","+",""],a=Ae(o,3),i=(a[0],a[1]);a[2].split("").forEach((function(n){t[e[n]||n]="-"!=i}))}},{key:"_calculateFrozen",value:function(){return""}},{key:"_loadParticipants",value:function(){if(!this.participantsLoaded&&this.dialog_id&&this.messagesOp&&!this.is("frozen")&&this.messagesOp.is("success"))return this.participantsLoaded=!0,this.is_private?this.send("/ison","_noop"):this.send("/names","_updateParticipants")}},{key:"_noop",value:function(){}},{key:"_participantId",value:function(e){return e.toLowerCase()}},{key:"_partMessage",value:function(e){var n={message:"%1 parted.",vars:[e.nick]};return e.kicker?(n.message="%1 was kicked by %2"+(e.message?": %3":""),n.vars.push(e.kicker),n.vars.push(e.message)):e.message&&(n.message+=" Reason: %2",n.vars.push(e.message)),n}},{key:"_updateParticipants",value:function(e){this._participants.clear(),this.participants(e.participants),e.stopPropagation()}}]),n}(ze);function Gt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}var Wt=function(e,n){return(e.is_private||0)-(n.is_private||0)||e.name.localeCompare(n.name)},Vt=function(e){function n(e){var t;return Oe(this,n),(t=Te(this,Le(n).call(this,e))).prop("ro","dialogs",new Tt([],{sorter:Wt})),t.prop("rw","on_connect_commands",e.on_connect_commands||""),t.prop("rw","state",e.state||"queued"),t.prop("rw","wanted_state",e.wanted_state||"connected"),t.prop("rw","url","string"==typeof e.url?new Ot(e.url):e.url),t.prop("rw","nick",e.nick||t.url.searchParams.get("nick")||""),t.participants([{nick:t.nick}]),t}return Ie(n,e),Ce(n,[{key:"addDialog",value:function(e){var n=e.match(/^[a-z]/i);this.send(n?"/query ".concat(e):"/join ".concat(e))}},{key:"ensureDialog",value:function(e){var n=this,t=this.dialogs.get(e.dialog_id);return t?t.update(e):((t=new Kt(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Gt(t,!0).forEach((function(n){Ue(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Gt(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},e,{connection_id:this.connection_id,api:this.api,events:this.events}))).on("message",(function(e){return n.emit("message",e)})),t.on("update",(function(){return n.update({dialogs:n.dialogs.size})})),this._addDefaultParticipants(t),this.dialogs.set(t.dialog_id,t),this.update({dialogs:this.dialogs.size}),t)}},{key:"findDialog",value:function(e){return this.dialogs.get(e.dialog_id)}},{key:"is",value:function(e){return this.state==e||Et(Le(n.prototype),"is",this).call(this,e)}},{key:"removeDialog",value:function(e){return this.dialogs.delete(e.dialog_id),this.update({dialogs:this.dialogs.size})}},{key:"update",value:function(e){return e.url&&"string"==typeof e.url&&(e.url=new Ot(e.url)),Et(Le(n.prototype),"update",this).call(this,e)}},{key:"wsEventConnection",value:function(e){this.update({state:e.state}),this.addMessage(e.message?{message:"Connection state changed to %1: %2",vars:[e.state,e.message]}:{message:"Connection state changed to %1.",vars:[e.state]})}},{key:"wsEventFrozen",value:function(e){var n=this.findDialog(e),t=n&&n.frozen;this.ensureDialog(e).participants([{nick:this.nick,me:!0}]),e.frozen&&(n||this).addMessage({message:e.frozen,vars:[]}),t&&!e.frozen&&n.addMessage({message:"Connected.",vars:[]})}},{key:"wsEventMessage",value:function(e){return e.dialog_id?this.ensureDialog(e).addMessage(e):this.addMessage(e)}},{key:"wsEventNickChange",value:function(e){var t={old_nick:e.old_nick||this.nick,new_nick:e.new_nick||e.nick,type:e.type};Et(Le(n.prototype),"wsEventNickChange",this).call(this,t),this.dialogs.forEach((function(e){return e.wsEventNickChange(t)}))}},{key:"wsEventError",value:function(e){var n=e.dialog_id&&e.frozen?this.ensureDialog(e):this.findDialog(e)||this;n.update({errors:this.errors+1});var t=Ke(e)||e.frozen||"Unknown error from %1.";"Password protected."==t&&(t="Invalid password."),n.addMessage({message:t,type:"error",sent:e,vars:e.command||[e.message]})}},{key:"wsEventJoin",value:function(e){var n=this.ensureDialog(e),t=e.nick||this.nick;t!=this.nick&&n.addMessage({message:"%1 joined.",vars:[t]}),n.participants([{nick:t}])}},{key:"wsEventPart",value:function(e){if(e.nick==this.nick)return this.removeDialog(e);e.dialog_id||(this.dialogs.forEach((function(n){return n.wsEventPart(e)})),e.stopPropagation())}},{key:"wsEventQuit",value:function(e){this.wsEventPart(e)}},{key:"wsEventSentJoin",value:function(e){this.wsEventJoin(e)}},{key:"wsEventSentList",value:function(e){var n=e.args||"/*/";this.addMessage(e.done?{message:"Found %1 of %2 dialogs from %3.",vars:[e.dialogs.length,e.n_dialogs,n]}:{message:"Found %1 of %2 dialogs from %3, but dialogs are still loading.",vars:[e.dialogs.length,e.n_dialogs,n]})}},{key:"wsEventSentQuery",value:function(e){this.ensureDialog(e)}},{key:"wsEventSentWhois",value:function(e){var n="%1 (%2)",t=[e.nick,e.host],o=Object.keys(e.channels).sort().map((function(n){return(e.channels[n].mode||"")+n}));e.channels=o,e.idle_for&&o.length?(n+=" has been idle for %3 in %4.",t.push(e.idle_for),t.push(o.join(", "))):e.idle_for&&!o.length?(n+="has been idle for %3, and is not active in any channels.",t.push(e.idle_for)):(n+="is active in %3.",t.push(o.join(", "))),(this.findDialog(e)||this).addMessage({message:n,vars:t,sent:e})}},{key:"wsEventTopic",value:function(e){this.ensureDialog(e).addMessage(e.topic?{message:"Topic changed to: %1",vars:[e.topic]}:{message:"No topic is set.",vars:[]})}},{key:"_addDefaultParticipants",value:function(e){var n=[{nick:this.nick,me:!0}];e.is_private&&n.push({nick:e.name}),e.participants(n)}},{key:"_addOperations",value:function(){this.prop("ro","setLastReadOp",this.api.operation("setConnectionLastRead")),this.prop("ro","messagesOp",this.api.operation("connectionMessages"))}},{key:"_calculateFrozen",value:function(){switch(this.state){case"connected":return"";case"disconnected":return"Disconnected.";case"unreachable":return"Unreachable.";default:return"Connecting..."}}}]),n}(Kt),Zt=ke((function(e){function n(e){let n=document.createElement("div");const t=[[e,n]],o=[];for(;t.length;){const[e,a]=t.shift();let i,r,s=typeof e;if(null===e||"undefined"==s?s="null":Array.isArray(e)&&(s="array"),"array"==s)(r=e=>e).len=e.length,(i=document.createElement("div")).className="json-array "+(r.len?"has-items":"is-empty");else if("object"==s){const n=Object.keys(e).sort();(r=e=>n[e]).len=n.length,(i=document.createElement("div")).className="json-object "+(r.len?"has-items":"is-empty")}else(i=document.createElement("span")).className="json-"+s,i.textContent="null"==s?"null":"boolean"!=s?e:e?"true":"false";if(r){const c=document.createElement("span");if(c.className="json-type",c.textContent=r.len?s+"["+r.len+"]":"{}",a.appendChild(c),-1!=o.indexOf(e))n.classList.add("has-recursive-items"),i.classList.add("is-seen");else{for(let n=0;n<r.len;n++){const o=r(n),a=document.createElement("div"),s=document.createElement("span");s.className="json-key",s.textContent=o,a.appendChild(s),i.appendChild(a),t.push([e[o],a])}o.push(e)}}a.className="json-item "+i.className.replace(/^json-/,"contains-"),a.appendChild(i)}return n}try{e.exports={jsonhtmlify:n}}catch(e){window.jsonhtmlify=n}})).jsonhtmlify;function Yt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}var Jt=function(e){function n(e){var t;return Oe(this,n),(t=Te(this,Le(n).call(this))).name="EmbedMaker",t.prop("persist","disableInstagram",!1),t.prop("persist","disableTwitter",!1),t.prop("persist","expandUrlToMedia",!0),t.prop("ro","api",e.api),t.prop("ro","embeds",{}),t}return Ie(n,e),Ce(n,[{key:"render",value:function(e,n){var t=this;if(this.expandUrlToMedia){var o={};Ve(e,".message__embed",(function(e){o[e.dataset.url]=e})),n.forEach((function(n){t.embeds[n]||t._loadAndRender(n),o[n]||e.appendChild(t._ensureEmbedEl(n)),delete o[n]})),Object.keys(o).forEach((function(e){return o[e].remove()}))}}},{key:"renderInstagram",value:function(e){if(!this.disableInstagram)return window.instgrm?window.instgrm.Embeds.process():void Ge("//platform.instagram.com/en_US/embeds.js")}},{key:"renderPasteEl",value:function(e){an.highlightBlock(e.querySelector("pre")),Ve(e,".le-meta",(function(e){e.addEventListener("click",(function(){return e.parentNode.classList.toggle("is-expanded")}))}))}},{key:"renderPhoto",value:function(e){var n=this;Ve(e,"img",(function(e){return e.addEventListener("click",(function(){return n.showMedia(e)}))}))}},{key:"renderTwitter",value:function(e){this.disableTwitter||(window.twttr&&window.twttr.widgets.load(),Ge("//platform.twitter.com/widgets.js"))}},{key:"showMedia",value:function(e){var n=Fe(document.querySelector("body"),"fullscreen-media-wrapper",(function(e){e.addEventListener("click",(function(n){return Je(e,n.target!=e)}))}));!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(n),n.appendChild(e.cloneNode()),Je(n,!0)}},{key:"toggleDetails",value:function(e,n){var t=e.querySelector(".has-message-details");if(t)return Je(t,"toggle");var o=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Yt(t,!0).forEach((function(n){Ue(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Yt(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},n.sent||n);["bubbles","color","command","dayChanged","dispatchTo","embeds","event","fromId","id","isSameSender","markdown","method","stopPropagation"].forEach((function(e){return delete o[e]})),o.ts=n.ts.toLocaleString(),(t=Zt(o.sent||o)).className=["message__embed","has-message-details",t.className].join(" "),e.appendChild(t)}},{key:"_ensureEmbedEl",value:function(e){return this.embeds[e].el||(this.embeds[e].el=Fe(null,"message__embed",(function(n){n.dataset.url=e})))}},{key:"_loadAndRender",value:function(e){var n=this;return this.embeds[e]={},this.api.operation("embed",{url:e}).perform().then((function(t){var o=t.res.body;if(o.html){var a=n._ensureEmbedEl(e);a.innerHTML=o.html,Ve(a,"a",(function(e){e.target="_blank"}));var i=(o.provider_name||"").toLowerCase();if("instagram"==i)return n.renderInstagram(a);if("twitter"==i)return n.renderTwitter(a);if(-1!=(a.firstChild.className||"").split(/\s+/).indexOf("le-paste"))return n.renderPasteEl(a);Ve(a,".le-photo, .le-thumbnail",(function(e){return n.renderPhoto(a)}))}}))}}]),n}(ze);function Qt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function Xt(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Qt(t,!0).forEach((function(n){Ue(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Qt(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var eo=0,no=function(e){function n(e){var t;return Oe(this,n),(t=Te(this,Le(n).call(this))).keepaliveTid=setInterval((function(){return t._send({method:"ping"})}),1e4),t.notificationIcon="",t.queue=[],t.waiting={},t.prop("persist","debugEvents",-1!=navigator.userAgent.indexOf("Mozilla")?1:0),t.prop("persist","notificationCloseDelay",5e3),t.prop("persist","wantNotifications",null),t.prop("ro","wsUrl",e.wsUrl),t.prop("rw","ready",!1),t}return Ie(n,e),Ce(n,[{key:"dispatch",value:function(e){var n=("wsEvent_"+this._getEventNameFromParam(e)).replace(/_(\w)/g,(function(e,n){return n.toUpperCase()}));this.debugEvents&&this._debug(n,e),e.bubbles=!0,e.stopPropagation=function(){e.bubbles=!1};var t=this.waiting[e.id];t&&t(e),e.bubbles&&this.emit("message",Xt({},e,{dispatchTo:n}))}},{key:"ensureConnected",value:function(){this._ws("dequeue")}},{key:"listenToGlobalEvents",value:function(){var e=this;window.addEventListener("error",(function(n){var t=n.colno,o=n.error,a=n.filename,i=n.lineno,r=n.message,s=n.type,c=n.timeStamp;e.send({method:"debug",type:s,colno:t,error:o,filename:a,lineno:i,message:r,timeStamp:c})})),window.addEventListener("unhandledrejection",(function(n){var t=n.type,o=n.reason,a=n.returnValue,i=n.timeStamp;e.send({method:"debug",type:t,reason:o,returnValue:a,timeStamp:i})}))}},{key:"notifyUser",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this._notificationRejectReason();if(o)this.debugEvents&&console.log("[Events:notifyUser] "+o,e,n,t);else{var a=new Notification(e,Xt({icon:this.notificationIcon},t,{body:n}));a.onclick=function(e){a.cancel(),window.focus()},setTimeout((function(){return a.close()}),this.notificationCloseDelay)}}},{key:"send",value:function(e,n){e.id||"ping"==e.method||(e.id=++eo),!e.method&&e.message&&(e.method="send"),e.dialog&&["connection_id","dialog_id"].forEach((function(n){e[n]=e.dialog[n]||""})),delete e.dialog,this.debugEvents&&this._debug("send",e),n&&(this.waiting[e.id]=n),this.queue.push(e),this._ws("dequeue")}},{key:"update",value:function(e){return Et(Le(n.prototype),"update",this).call(this,e),e.wantNotifications&&this.notifyUser("Convos","You have enabled notifications!"),this}},{key:"_debug",value:function(e,n){1==this.debugEvents&&"wsEventPong"!=e&&"ping"!=n.method?console.log("[Events:"+(e||"data")+"]",n):this.debugEvents>=2&&console.log("[Events:"+(e||"data")+"]",n)}},{key:"_getEventNameFromParam",value:function(e){return e.errors?"error":"state"==e.event?e.type:"sent"==e.event&&e.message.match(/\/\S+/)?(e.command=e.message.split(/\s+/).filter((function(e){return e.length})),e.command[0]=e.command[0].substring(1),"sent_"+e.command[0]):e.event}},{key:"_notificationRejectReason",value:function(){return this.wantNotifications?window.Notification?"granted"!=Notification.permission?Notification.permission:document.hasFocus()?"document.hasFocus":"":"window.Notification":"wantNotifications == false"}},{key:"_send",value:function(e){var n=this.ws&&1==this.ws.readyState&&this.ws;return n&&n.send(JSON.stringify(e)),!!n}},{key:"_ws",value:function(e){var n=this;"dequeue"==e&&this._wsReconnectTid&&(clearTimeout(this._wsReconnectTid),delete this._wsReconnectTid),"start"==e&&this.update({ready:!0}),"stop"==e?(this._wsReconnectTid||(this._wsReconnectTid=setTimeout((function(){return n._ws("dequeue")}),3e3)),this.update({ready:!1}),delete this.ws):this.ws?this.queue=this.queue.filter((function(e){return!n._send(e)})):(this.ws=new WebSocket(this.wsUrl),this.ws.onopen=function(){return n._ws("start")},this.ws.onclose=function(){return n._ws("stop")},this.ws.onerror=function(){return n._ws("stop")},this.ws.onmessage=function(e){return n.dispatch(JSON.parse(e.data))})}}]),n}(ze);function to(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}var oo=function(e){function n(e){return Oe(this,n),Te(this,Le(n).call(this,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?to(t,!0).forEach((function(n){Ue(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):to(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},e,{connection_id:"",dialog_id:"notifications",is_private:!0,name:"Notifications"})))}return Ie(n,e),Ce(n,[{key:"send",value:function(){}},{key:"_addOperations",value:function(){this.prop("ro","messagesOp",this.api.operation("notificationMessages")),this.prop("ro","setLastReadOp",this.api.operation("readNotifications"))}}]),n}(Kt);function ao(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}var io=function(e){function n(e){var t;Oe(this,n),t=Te(this,Le(n).call(this));var o=e.api;return t.prop("ro","api",(function(){return o})),t.prop("ro","connections",new Tt),t.prop("ro","email",(function(){return t.getUserOp.res.body.email||""})),t.prop("ro","embedMaker",new Jt({api:o})),t.prop("ro","events",t._createEvents(e)),t.prop("ro","getUserOp",o.operation("getUser",{connections:!0,dialogs:!0})),t.prop("ro","notifications",new oo({api:o,events:t.events})),t.prop("ro","unread",(function(){return t._calculateUnread()})),t.prop("rw","highlight_keywords",[]),t.prop("persist","lastUrl",""),t.prop("persist","showGrid",!1),t.prop("persist","theme","auto"),t.prop("persist","version","0"),t.prop("proxy","expandUrlToMedia","embedMaker"),t.prop("proxy","wantNotifications","events"),t.prop("proxy","status","getUserOp"),t}return Ie(n,e),Ce(n,[{key:"calculateLastUrl",value:function(){return this.is("error")?"/login":this.is("success")?this.lastUrl?this.lastUrl:this.connections.size?"/chat":"/add/connection":null}},{key:"dialogs",value:function(e){var n=[];return this.connections.toArray().forEach((function(t){t.dialogs.toArray().forEach((function(t){e&&!e(t)||n.push(t)}))})),n}},{key:"ensureConnected",value:function(){this.getUserOp.is("success")&&this.events.ensureConnected()}},{key:"ensureDialog",value:function(e){var n=this;if(e.dialog_id)return this.ensureDialog({connection_id:e.connection_id}).ensureDialog(e);var t=this.findDialog(e);return t?t.update(e):((t=new Vt(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ao(t,!0).forEach((function(n){Ue(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ao(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},e,{api:this.api,events:this.events}))).on("update",(function(){return n.update({connections:n.connections.size})})),this.connections.set(t.connection_id,t),this.update({connections:this.connections.size}),t)}},{key:"findDialog",value:function(e){var n=this.connections.get(e.connection_id);return e.dialog_id?n&&n.findDialog(e):n}},{key:"is",value:function(e){var n=this;return Array.isArray(e)?!!e.filter((function(e){return n.is(e)})).length:"loggedIn"==e?this.email&&!0:"offline"==e?"fetch"==Ke(this.getUserOp.err||[],"source"):this.getUserOp.is(e)}},{key:"load",value:function(){return Ee.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.getUserOp.is("success")){e.next=2;break}return e.abrupt("return",this);case 2:return e.next=4,Ee.awrap(this.getUserOp.perform());case 4:return this._parseGetUser(this.getUserOp.res.body),this.email&&this.send({method:"ping"}),e.abrupt("return",this);case 7:case"end":return e.stop()}}),null,this)}},{key:"removeDialog",value:function(e){if(e.dialog_id){var n=this.findDialog({connection_id:e.connection_id});n&&n.removeDialog(e)}else this.connections.delete(e.connection_id),this.update({connections:this.connections.size})}},{key:"send",value:function(e,n){return this.events.send(e,n)}},{key:"wsEventMe",value:function(e){var n=this.ensureDialog({connection_id:e.connection_id});n.wsEventNickChange(e),n.update(e)}},{key:"wsEventPong",value:function(e){this.wsPongTimestamp=e.ts}},{key:"_calculateUnread",value:function(){return this.notifications.unread+this.dialogs((function(e){return e.is_private})).reduce((function(e,n){return e+n.unread}),0)}},{key:"_createEvents",value:function(e){var n=this,t=new no(e);return t.on("message",(function(e){n._dispatchMessageToDialog(e),n.emit(e.dispatchTo,e),n[e.dispatchTo]&&n[e.dispatchTo](e)})),t.on("update",(function(e){if(e.ready)return!!n.getUserOp.is("pending")&&n.load();n.getUserOp.update({status:"pending"}),n.connections.forEach((function(e){return e.update({state:"unreachable"})}))})),t}},{key:"_dispatchMessageToDialog",value:function(e){var n=this.findDialog({connection_id:e.connection_id});if(n&&(n[e.dispatchTo]&&n[e.dispatchTo](e),e.bubbles)){var t=n.findDialog(e);t&&t[e.dispatchTo]&&t[e.dispatchTo](e)}}},{key:"_parseGetUser",value:function(e){var n=this;this.connections.clear(),this.notifications.update({unread:e.unread||0}),(e.connections||[]).forEach((function(e){return n.ensureDialog(e)})),(e.dialogs||[]).forEach((function(e){return n.ensureDialog(e)})),this.update({highlight_keywords:e.highlight_keywords})}}]),n}(ze),ro=[["auto","Auto"],["dark","Dark"],["light","Light"],["nord","Nord"]],so="dark",co=window.matchMedia("(prefers-color-scheme: dark)");function uo(e){let n,t,o,a,i,r,s,c,d;const u=e.$$slots.default,g=l(u,e,null),m=new cn({props:{name:e.$activeMenu?"times-circle":"bars"}});return{c(){n=N("header"),g&&g.c(),t=S(),o=N("a"),ve(m.$$.fragment),a=S(),i=N("small"),r=C(e.unread),A(i,"class","chat-header__unread"),i.hidden=s=!e.unread,A(o,"href",c="#activeMenu:"+(e.$activeMenu?"":"nav")),A(o,"class","chat-header__hamburger"),A(n,"class","chat-header")},m(e,s){k(e,n,s),g&&g.m(n,null),x(n,t),x(n,o),ye(m,o,null),x(o,a),x(o,i),x(i,r),d=!0},p(e,n){g&&g.p&&e.$$scope&&g.p(p(u,n,e,null),f(u,n,null));const t={};e.$activeMenu&&(t.name=n.$activeMenu?"times-circle":"bars"),m.$set(t),d&&!e.unread||R(r,n.unread),(!d||e.unread&&s!==(s=!n.unread))&&(i.hidden=s),(!d||e.$activeMenu&&c!==(c="#activeMenu:"+(n.$activeMenu?"":"nav")))&&A(o,"href",c)},i(e){d||(pe(g,e),pe(m.$$.fragment,e),d=!0)},o(e){ge(g,e),ge(m.$$.fragment,e),d=!1},d(e){e&&E(n),g&&g.d(e),_e(m)}}}function lo(e,n,t){let o,a;u(e,pn,e=>t("$activeMenu",a=e));const i=V("user");u(e,i,e=>t("$user",o=e));let r,{$$slots:s={},$$scope:c}=n;return e.$set=e=>{"$$scope"in e&&t("$$scope",c=e.$$scope)},e.$$.update=(e={$user:1})=>{e.$user&&t("unread",r=o.unread)},{user:i,unread:r,$activeMenu:a,$$slots:s,$$scope:c}}co.matches&&(so="dark"),co.addListener((function(e){so=e.matches?"dark":"light"}));class fo extends xe{constructor(e){super(),we(this,e,lo,uo,s,{})}}var po=[];function go(e,n){return go[e]?go[e](n):[]}function mo(e,n,t){const o=Object.create(e);return o.opt=n[t],o.i=t,o}function ho(e){let n,t,o,a=(e.opt.text||e.opt.val)+"";return{c(){A(n=N("a"),"href",t="#index:"+e.i),A(n,"tabindex","-1"),j(n,"has-focus",e.i==e.activeAutocompleteIndex),o=P(n,"click",M(e.selectOption))},m(e,t){k(e,n,t),n.innerHTML=a},p(e,t){e.autocompleteOptions&&a!==(a=(t.opt.text||t.opt.val)+"")&&(n.innerHTML=a),e.activeAutocompleteIndex&&j(n,"has-focus",t.i==t.activeAutocompleteIndex)},d(e){e&&E(n),o()}}}function $o(e){let n,t,o,a,r,s,c,d,u,l,f;const p=new cn({props:{name:"paper-plane"}});let g=e.autocompleteOptions,m=[];for(let n=0;n<g.length;n+=1)m[n]=ho(mo(e,g,n));return{c(){n=N("div"),t=N("textarea"),a=S(),r=N("a"),ve(p.$$.fragment),s=S(),c=N("div");for(let e=0;e<m.length;e+=1)m[e].c();A(t,"id","chat_input_textarea"),A(t,"placeholder",o=Yn("What is on your mind %1?",e.$connection.nick)),A(r,"href","#send"),A(r,"class","btn-send"),A(c,"class",d="chat-input_autocomplete chat-input_autocomplete_"+e.autocompleteCategory),c.hidden=u=!e.autocompleteOptions.length,A(n,"class","chat-input"),f=[P(t,"change",e.change_handler),P(t,"keydown",e.keydown_handler),P(t,"keyup",e.keyup_handler),P(r,"click",M(e.sendMessage))]},m(o,i){k(o,n,i),x(n,t),e.textarea_binding(t),x(n,a),x(n,r),ye(p,r,null),x(n,s),x(n,c);for(let e=0;e<m.length;e+=1)m[e].m(c,null);l=!0},p(e,n){if((!l||e.$connection&&o!==(o=Yn("What is on your mind %1?",n.$connection.nick)))&&A(t,"placeholder",o),e.activeAutocompleteIndex||e.selectOption||e.autocompleteOptions){let t;for(g=n.autocompleteOptions,t=0;t<g.length;t+=1){const o=mo(n,g,t);m[t]?m[t].p(e,o):(m[t]=ho(o),m[t].c(),m[t].m(c,null))}for(;t<m.length;t+=1)m[t].d(1);m.length=g.length}(!l||e.autocompleteCategory&&d!==(d="chat-input_autocomplete chat-input_autocomplete_"+n.autocompleteCategory))&&A(c,"class",d),(!l||e.autocompleteOptions&&u!==(u=!n.autocompleteOptions.length))&&(c.hidden=u)},i(e){l||(pe(p.$$.fragment,e),l=!0)},o(e){ge(p.$$.fragment,e),l=!1},d(t){t&&E(n),e.textarea_binding(null),_e(p),O(m,t),i(f)}}}function bo(n,t,o){let a,i=e;n.$$.on_destroy.push(()=>i());let r,{dialog:s={}}=t,d=0,u="none",l=0;const f=V("user");function p(e,n={}){const t=n.space||"";o("inputEl",r.value=y[0]+e+t+y[3],r),o("inputEl",r.selectionStart=o("inputEl",r.selectionEnd=(y[0]+e+t).length,r),r),t.length&&o("pos",l=r.selectionStart)}function g(e){const n=b[d];n&&p(n.val,e)}function m(e,n){b.length&&(e.preventDefault(),o("activeAutocompleteIndex",d+=n),d<0&&o("activeAutocompleteIndex",d=b.length-1),d>=b.length&&o("activeAutocompleteIndex",d=0),g({space:""}))}function h(){const e={message:r.value,method:"send",dialog:s};e.message=e.message.replace(/^\/close/i,"/part"),e.message=e.message.replace(/^\/j\b/i,"/join");(e.message.match(/^\/(\w+)\s*(\S*)/)||["","message",""]).slice(1);e.message.length&&f.send(e),o("inputEl",r.value="",r)}const $={ArrowDown:e=>m(e,e.shiftKey?4:1),ArrowUp:e=>m(e,e.shiftKey?-4:-1),Tab:e=>m(e,e.shiftKey?-1:1),Enter(e){b[d]?(e.preventDefault(),g({space:" "})):e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||(e.preventDefault(),h())},Fallback(e){},Release(e){1!=e.key.length&&-1==["ArrowLeft","ArrowRight","Backspace"].indexOf(e.key)||o("pos",l=r.selectionStart)}};let b,v,y;return n.$set=e=>{"dialog"in e&&o("dialog",s=e.dialog)},n.$$.update=(e={pos:1,inputParts:1,dialog:1})=>{e.pos&&o("inputParts",y=l?function(e){let n="",t="";return[r.value.substring(0,e).replace(/(\S)(\S*)$/,(e,o,a)=>(n=o,t=a,"")),n,t,r.value.substring(e)]}(l):["","","",""]),e.inputParts&&o("autocompleteOptions",b=function([e,n,t,a]){o("autocompleteCategory",u=":"==n&&t.length?"emojis":"/"!=n||e.length?"@"==n&&t.length?"nicks":"#"==n||"&"==n?"dialogs":"none":"commands"),o("activeAutocompleteIndex",d=0);const i=go(u,{dialog:s,query:n+t,user:f});return i.length&&i.unshift({val:n+t}),i}(y)||[]),e.dialog&&(()=>(i(),i=c(v,e=>o("$connection",a=e)),v))(o("connection",v=f.findDialog({connection_id:s.connection_id})))},{dialog:s,activeAutocompleteIndex:d,autocompleteCategory:u,inputEl:r,pos:l,add:p,selectOption:function(e){o("activeAutocompleteIndex",d=parseInt(e.target.closest("a").href.replace(/.*index:/,""),10)),g({space:" "}),r.focus()},sendMessage:h,keys:$,autocompleteOptions:b,connection:v,$connection:a,textarea_binding:function(e){J[e?"unshift":"push"](()=>{o("inputEl",r=e)})},change_handler:e=>{o("pos",l=r.selectionStart)},keydown_handler:e=>($[e.key]||$.Fallback)(e),keyup_handler:e=>$.Release(e)}}go.commands=function(e){for(var n=e.query,t=[],o=0;o<po.length;o++)if(0==po[o].cmd.indexOf(n)){var a=po[o].alias||po[o].cmd,i=po[o].example.replace(/</g,"&lt;");t.push({text:i,val:a})}return t},go.dialogs=function(e){for(var n=e.dialog,t=e.query,o=e.user.findDialog({connection_id:n.connection_id}).dialogs.toArray(),a=[],i=0;i<o.length&&!(-1!=o[i].name.toLowerCase().indexOf(t)&&(a.push({text:o[i].name,val:o[i].dialog_id}),a.length>=20));i++);return a},go.emojis=function(e){var n=e.query,t=[];return[":","_"].map((function(e){return e+n.slice(1,2)})).forEach((function(e){for(var o=Gn(e,"group"),a=0;a<o.length&&(o[a].shortname.indexOf(n)>=0&&t.push({val:o[a].emoji,text:Wn(o[a].emoji)}),!(t.length>=20));a++);})),t},go.nicks=function(e){var n=e.dialog,t=e.query,o=n.participants(),a=new RegExp("^"+Ze(t.slice(1)),"i"),i=[],r=!0,s=!1,c=void 0;try{for(var d,u=o[Symbol.iterator]();!(r=(d=u.next()).done);r=!0){var l=d.value;if(i.length>=20)break;l.nick.match(a)&&i.push({val:l.nick})}}catch(e){s=!0,c=e}finally{try{r||null==u.return||u.return()}finally{if(s)throw c}}return i},po.push({cmd:"/me",example:"/me <msg>",description:"Send message as an action."}),po.push({cmd:"/say",example:"/say <msg>",description:NaN}),po.push({cmd:"/topic",example:"/topic or /topic <new topic>",description:"Show current topic, or set a new one."}),po.push({cmd:"/whois",example:"/whois <nick>",description:"Show information about a user."}),po.push({cmd:"/query",example:"/query <nick>",description:"Open up a new chat window with nick."}),po.push({cmd:"/msg",example:"/msg <nick> <msg>",description:"Send a direct message to nick."}),po.push({cmd:"/names",example:"/names",description:"Show participants in the channel."}),po.push({cmd:"/join",example:"/join <#channel>",description:"Join channel and open up a chat window."}),po.push({cmd:"/nick",example:"/nick <nick>",description:"Change your wanted nick."}),po.push({cmd:"/part",example:"/part",description:"Leave channel, and close window."}),po.push({cmd:"/close",example:"/close <nick>",description:"Close conversation with nick, defaults to current active."}),po.push({cmd:"/kick",example:"/kick <nick>",description:"Kick a user from the current channel."}),po.push({cmd:"/mode",example:"/mode +o #channel nick",description:"Change mode of yourself or a user"}),po.push({cmd:"/reconnect",example:"/reconnect",description:"Restart the current connection."}),po.push({cmd:"/cs",example:"/cs <msg>",description:'Short for "/msg chanserv ...".',alias:"/msg chanserv"}),po.push({cmd:"/ns",example:"/ns <msg>",description:'Short for "/msg nickserv ...".',alias:"/msg nickserv"}),po.push({cmd:"/hs",example:"/hs <msg>",description:'Short for "/msg hostserv ...".',alias:"/msg hostserv"}),po.push({cmd:"/bs",example:"/bs <msg>",description:'Short for "/msg botserv ...".',alias:"/msg botserv"});class vo extends xe{constructor(e){super(),we(this,e,bo,$o,s,{dialog:0,add:0})}get add(){return this.$$.ctx.add}}function yo(e){let n,t,o,a,i;const r=new cn({props:{name:e.icon,animation:e.animation}}),s=e.$$slots.default,c=l(s,e,null);return{c(){n=N("div"),t=N("span"),ve(r.$$.fragment),o=S(),c&&c.c(),A(n,"class",a="message-status-line "+e.className)},m(e,a){k(e,n,a),x(n,t),ye(r,t,null),x(t,o),c&&c.m(t,null),i=!0},p(e,t){const o={};e.icon&&(o.name=t.icon),e.animation&&(o.animation=t.animation),r.$set(o),c&&c.p&&e.$$scope&&c.p(p(s,t,e,null),f(s,t,null)),(!i||e.className&&a!==(a="message-status-line "+t.className))&&A(n,"class",a)},i(e){i||(pe(r.$$.fragment,e),pe(c,e),i=!0)},o(e){ge(r.$$.fragment,e),ge(c,e),i=!1},d(e){e&&E(n),_e(r),c&&c.d(e)}}}function _o(e,n,t){let{class:o=""}=n,{icon:a=""}=n,{animation:i=""}=n,{$$slots:r={},$$scope:s}=n;return e.$set=e=>{"class"in e&&t("className",o=e.class),"icon"in e&&t("icon",a=e.icon),"animation"in e&&t("animation",i=e.animation),"$$scope"in e&&t("$$scope",s=e.$$scope)},{className:o,icon:a,animation:i,$$slots:r,$$scope:s}}class wo extends xe{constructor(e){super(),we(this,e,_o,yo,s,{class:"className",icon:0,animation:0})}}function xo(e,n,t){const o=Object.create(e);return o.message=n[t],o.i=t,o}function ko(e){let n,t,o=Yn("notifications"==e.dialog.dialog_id?"No notifications.":"No messages.")+"";return{c(){n=N("h2"),t=C(o)},m(e,o){k(e,n,o),x(n,t)},p(e,n){e.dialog&&o!==(o=Yn("notifications"==n.dialog.dialog_id?"No notifications.":"No messages.")+"")&&R(t,o)},d(e){e&&E(n)}}}function Eo(e){let n;const t=new wo({props:{class:"for-loading",icon:"spinner",animation:"spin",$$slots:{default:[Oo]},$$scope:{ctx:e}}});return{c(){ve(t.$$.fragment)},m(e,o){ye(t,e,o),n=!0},p(e,n){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),t.$set(o)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function Oo(n){let t,o=Yn("Loading...")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function No(e){let n;const t=new wo({props:{class:"for-last-read",icon:"comments",$$slots:{default:[Co]},$$scope:{ctx:e}}});return{c(){ve(t.$$.fragment)},m(e,o){ye(t,e,o),n=!0},p(e,n){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),t.$set(o)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function Co(n){let t,o=Yn("New messages")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function So(e){let n;const t=new wo({props:{class:"for-day-changed",icon:"calendar-alt",$$slots:{default:[Po]},$$scope:{ctx:e}}});return{c(){ve(t.$$.fragment)},m(e,o){ye(t,e,o),n=!0},p(e,n){const o={};(e.$$scope||e.messages)&&(o.$$scope={changed:e,ctx:n}),t.$set(o)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function Do(e){let n;const t=new wo({props:{class:"for-start-of-history",icon:"calendar-alt",$$slots:{default:[Mo]},$$scope:{ctx:e}}});return{c(){ve(t.$$.fragment)},m(e,o){ye(t,e,o),n=!0},p(e,n){const o={};(e.$$scope||e.messages)&&(o.$$scope={changed:e,ctx:n}),t.$set(o)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function Po(e){let n,t=e.message.ts.getHumanDate()+"";return{c(){n=C(t)},m(e,t){k(e,n,t)},p(e,o){e.messages&&t!==(t=o.message.ts.getHumanDate()+"")&&R(n,t)},d(e){e&&E(n)}}}function Mo(e){let n,t=Yn("Started chatting on %1",e.message.ts.getHumanDate())+"";return{c(){n=C(t)},m(e,t){k(e,n,t)},p(e,o){e.messages&&t!==(t=Yn("Started chatting on %1",o.message.ts.getHumanDate())+"")&&R(n,t)},d(e){e&&E(n)}}}function Ao(e){let n,t,o=Yn("%1 in %2",e.message.from,e.message.dialog_id)+"";return{c(){n=N("a"),t=C(o),A(n,"href","#see"),A(n,"class","message__from"),L(n,"color",e.message.color)},m(e,o){k(e,n,o),x(n,t)},p(e,a){e.messages&&o!==(o=Yn("%1 in %2",a.message.from,a.message.dialog_id)+"")&&R(t,o),e.messages&&L(n,"color",a.message.color)},d(e){e&&E(n)}}}function Ro(e){let n,t,o,a,i=e.message.from+"";function r(...n){return e.click_handler(e,...n)}return{c(){n=N("a"),t=C(i),A(n,"href",o="#input:"+e.message.from),A(n,"class","message__from"),L(n,"color",e.message.color),a=P(n,"click",M(r))},m(e,o){k(e,n,o),x(n,t)},p(a,r){e=r,a.messages&&i!==(i=e.message.from+"")&&R(t,i),a.messages&&o!==(o="#input:"+e.message.from)&&A(n,"href",o),a.messages&&L(n,"color",e.message.color)},d(e){e&&E(n),a()}}}function To(e){let n;const t=new cn({props:{name:"error"==e.message.type?"exclamation-circle":"info-circle"}});return t.$on("click",e.toggleDetails),{c(){ve(t.$$.fragment)},m(e,o){ye(t,e,o),n=!0},p(e,n){const o={};e.messages&&(o.name="error"==n.message.type?"exclamation-circle":"info-circle"),t.$set(o)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function Lo(e){let n,t,o,a,i,r,s,c,d,u,l,f,p,g,m,h,$,b,v=e.message.ts.getHM()+"",y=e.message.markdown+"",_=e.i&&e.i==e.messages.length-e.unreadFrom&&No(e);const w=[Do,So],O=[];function D(e,n){return n.message.endOfHistory?0:n.message.dayChanged?1:-1}~(t=D(0,e))&&(o=O[t]=w[t](e));const M=new cn({props:{name:"pick:"+e.message.from,color:e.message.color}});function T(e,n){return n.dialog.connection_id?Ro:Ao}let L=T(0,e),U=L(e),z=("error"==e.message.type||"notice"==e.message.type)&&To(e);return{c(){_&&_.c(),n=S(),o&&o.c(),a=S(),i=N("div"),ve(M.$$.fragment),r=S(),s=N("b"),c=C(v),u=S(),U.c(),l=S(),f=N("div"),z&&z.c(),p=S(),A(s,"class","message__ts"),A(s,"title",d=e.message.ts.toLocaleString()),g=new I(y,null),A(f,"class","message__text"),A(i,"class",m="message is-type-"+e.message.type),A(i,"data-index",h=e.i),j(i,"is-not-present",!e.senderIsOnline(e.message)),j(i,"is-sent-by-you",e.message.from==e.connection.nick),j(i,"is-highlighted",e.message.highlight),j(i,"has-not-same-from",!e.message.isSameSender&&!e.message.dayChanged),j(i,"has-same-from",e.message.isSameSender&&!e.message.dayChanged),b=P(i,"click",e.gotoDialogFromNotifications)},m(e,o){_&&_.m(e,o),k(e,n,o),~t&&O[t].m(e,o),k(e,a,o),k(e,i,o),ye(M,i,null),x(i,r),x(i,s),x(s,c),x(i,u),U.m(i,null),x(i,l),x(i,f),z&&z.m(f,null),x(f,p),g.m(f),$=!0},p(e,r){r.i&&r.i==r.messages.length-r.unreadFrom?_?(_.p(e,r),pe(_,1)):((_=No(r)).c(),pe(_,1),_.m(n.parentNode,n)):_&&(le(),ge(_,1,1,()=>{_=null}),fe());let u=t;(t=D(0,r))===u?~t&&O[t].p(e,r):(o&&(le(),ge(O[u],1,1,()=>{O[u]=null}),fe()),~t?((o=O[t])||(o=O[t]=w[t](r)).c(),pe(o,1),o.m(a.parentNode,a)):o=null);const h={};e.messages&&(h.name="pick:"+r.message.from),e.messages&&(h.color=r.message.color),M.$set(h),$&&!e.messages||v===(v=r.message.ts.getHM()+"")||R(c,v),(!$||e.messages&&d!==(d=r.message.ts.toLocaleString()))&&A(s,"title",d),L===(L=T(0,r))&&U?U.p(e,r):(U.d(1),(U=L(r))&&(U.c(),U.m(i,l))),"error"==r.message.type||"notice"==r.message.type?z?(z.p(e,r),pe(z,1)):((z=To(r)).c(),pe(z,1),z.m(f,p)):z&&(le(),ge(z,1,1,()=>{z=null}),fe()),$&&!e.messages||y===(y=r.message.markdown+"")||g.p(y),(!$||e.messages&&m!==(m="message is-type-"+r.message.type))&&A(i,"class",m),(e.messages||e.senderIsOnline||e.messages)&&j(i,"is-not-present",!r.senderIsOnline(r.message)),(e.messages||e.messages||e.connection)&&j(i,"is-sent-by-you",r.message.from==r.connection.nick),(e.messages||e.messages)&&j(i,"is-highlighted",r.message.highlight),(e.messages||e.messages)&&j(i,"has-not-same-from",!r.message.isSameSender&&!r.message.dayChanged),(e.messages||e.messages)&&j(i,"has-same-from",r.message.isSameSender&&!r.message.dayChanged)},i(e){$||(pe(_),pe(o),pe(M.$$.fragment,e),pe(z),$=!0)},o(e){ge(_),ge(o),ge(M.$$.fragment,e),ge(z),$=!1},d(e){_&&_.d(e),e&&E(n),~t&&O[t].d(e),e&&E(a),e&&E(i),_e(M),U.d(),z&&z.d(),b()}}}function jo(e){let n;const t=new wo({props:{class:"for-loading",icon:"spinner",animation:"spin",$$slots:{default:[Io]},$$scope:{ctx:e}}});return{c(){ve(t.$$.fragment)},m(e,o){ye(t,e,o),n=!0},p(e,n){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),t.$set(o)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function Io(n){let t,o=Yn("Loading...")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Uo(e){let n,t,o,a,i,r=e.messages.length>40&&e.dialog.is("loading"),s=e.dialog.is("loading"),c=0==e.messages.length&&ko(e),d=r&&Eo(e),u=e.messages,l=[];for(let n=0;n<u.length;n+=1)l[n]=Lo(xo(e,u,n));const f=e=>ge(l[e],1,1,()=>{l[e]=null});let p=s&&jo(e);return{c(){c&&c.c(),n=S(),d&&d.c(),t=S();for(let e=0;e<l.length;e+=1)l[e].c();o=S(),p&&p.c(),a=D()},m(e,r){c&&c.m(e,r),k(e,n,r),d&&d.m(e,r),k(e,t,r);for(let n=0;n<l.length;n+=1)l[n].m(e,r);k(e,o,r),p&&p.m(e,r),k(e,a,r),i=!0},p(e,i){if(0==i.messages.length?c?c.p(e,i):((c=ko(i)).c(),c.m(n.parentNode,n)):c&&(c.d(1),c=null),(e.messages||e.dialog)&&(r=i.messages.length>40&&i.dialog.is("loading")),r?d?(d.p(e,i),pe(d,1)):((d=Eo(i)).c(),pe(d,1),d.m(t.parentNode,t)):d&&(le(),ge(d,1,1,()=>{d=null}),fe()),e.messages||e.senderIsOnline||e.connection||e.gotoDialogFromNotifications||e.toggleDetails||e.dialog||e.input||e.l||e.unreadFrom){let n;for(u=i.messages,n=0;n<u.length;n+=1){const t=xo(i,u,n);l[n]?(l[n].p(e,t),pe(l[n],1)):(l[n]=Lo(t),l[n].c(),pe(l[n],1),l[n].m(o.parentNode,o))}for(le(),n=u.length;n<l.length;n+=1)f(n);fe()}e.dialog&&(s=i.dialog.is("loading")),s?p?(p.p(e,i),pe(p,1)):((p=jo(i)).c(),pe(p,1),p.m(a.parentNode,a)):p&&(le(),ge(p,1,1,()=>{p=null}),fe())},i(e){if(!i){pe(d);for(let e=0;e<u.length;e+=1)pe(l[e]);pe(p),i=!0}},o(e){ge(d),l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)ge(l[e]);ge(p),i=!1},d(e){c&&c.d(e),e&&E(n),d&&d.d(e),e&&E(t),O(l,e),e&&E(o),p&&p.d(e),e&&E(a)}}}function zo(e,n,t){let{connection:o}=n,{dialog:a}=n,{input:i}=n;const r=V("user");let s=[],c=0;function d(e){return{color:o.color,from:"Convos",markdown:Jn(e.message,...e.vars),ts:new jt,type:"error",...e}}return e.$set=e=>{"connection"in e&&t("connection",o=e.connection),"dialog"in e&&t("dialog",a=e.dialog),"input"in e&&t("input",i=e.input)},e.$$.update=(e={dialog:1})=>{e.dialog&&function(e){const n=[];if("Password protected."==e.frozen)n.push(d({message:"Conversation is password protected. Go to [settings](%1) to enter the password.",vars:["#activeMenu:settings"]}));else if(o.frozen){const e=o.is("unreachable");n.push(d({message:e?"Trying to [reconnect](%1)...":"Disconnected. Your connection %1 can be edited in [settings](%2).",vars:e?["#call:user:ensureConnected"]:[o.name,xn("/chat/"+o.connection_id+"#activeMenu:settings")]}))}else e.frozen&&n.push(d({message:Qn(o,e).replace(/\.$/,""),vars:[]}));null===r.wantNotifications&&n.push(d({message:"Please go to [settings](%1) to enable notifications.",vars:["/settings"]})),t("messages",s=n.length?e.messages.concat(n):e.messages),t("unreadFrom",c=e.unread+n.length)}(a)},{connection:o,dialog:a,input:i,messages:s,unreadFrom:c,gotoDialogFromNotifications:function(e){if(a.connection_id)return;const n=e.target.closest(".message"),t=s[n.dataset.index];t&&(e.preventDefault(),vn(["","chat",t.connection_id,t.dialog_id].map(encodeURIComponent).join("/")+"#"+t.ts.toISOString()))},senderIsOnline:function(e){return!e.dialog_id||a.findParticipant(e.fromId)},toggleDetails:function(e){const n=e.target.closest(".message");r.embedMaker.toggleDetails(n,s[n.dataset.index])},click_handler:({message:e})=>i.add(e.from)}}class Bo extends xe{constructor(e){super(),we(this,e,zo,Uo,s,{connection:0,dialog:0,input:0})}}function Ho(e){let n,t,o,a,i;const r=new cn({props:{animation:e.animation,name:e.icon}}),s=e.$$slots.default,c=l(s,e,null);return{c(){n=N("button"),ve(r.$$.fragment),t=S(),c&&c.c(),A(n,"class",o=e.classNames.join(" ")),n.disabled=e.disabledProp,A(n,"type",e.type),i=P(n,"click",e.click_handler)},m(e,o){k(e,n,o),ye(r,n,null),x(n,t),c&&c.m(n,null),a=!0},p(e,t){const i={};e.animation&&(i.animation=t.animation),e.icon&&(i.name=t.icon),r.$set(i),c&&c.p&&e.$$scope&&c.p(p(s,t,e,null),f(s,t,null)),(!a||e.classNames&&o!==(o=t.classNames.join(" ")))&&A(n,"class",o),a&&!e.disabledProp||(n.disabled=t.disabledProp),a&&!e.type||A(n,"type",t.type)},i(e){a||(pe(r.$$.fragment,e),pe(c,e),a=!0)},o(e){ge(r.$$.fragment,e),ge(c,e),a=!1},d(e){e&&E(n),_e(r),c&&c.d(e),i()}}}const qo=700;function Fo(n,t,o){let a,i=e,r=()=>(i(),i=c(g,e=>o("$op",a=e)),g);n.$$.on_destroy.push(()=>i());let s="",d=[],u=!1,l=0,{disabled:f=!1}=t,{icon:p=""}=t,{op:g=new tn({api:!1,id:""})}=t;r();let{type:m=""}=t;function h(e){e&&o("t0",l=(new jt).toEpoch()),o("animation",s=e?"spin":""),o("forceDisable",u=e)}let $,{$$slots:b={},$$scope:v}=t;return n.$set=e=>{"disabled"in e&&o("disabled",f=e.disabled),"icon"in e&&o("icon",p=e.icon),"op"in e&&r(o("op",g=e.op)),"type"in e&&o("type",m=e.type),"$$scope"in e&&o("$$scope",v=e.$$scope)},n.$$.update=(e={$op:1,t0:1,icon:1,disabled:1,forceDisable:1})=>{e.$op&&a.is("loading")&&h(!0),(e.$op||e.t0)&&(a.is("loading")||setTimeout(()=>h(!1),qo-((new jt).toEpoch()-l))),e.icon&&o("classNames",d=["btn","for-"+(p||"default")]),(e.disabled||e.forceDisable)&&o("disabledProp",$=f||u)},{animation:s,classNames:d,disabled:f,icon:p,op:g,type:m,disabledProp:$,click_handler:function(e){Z(n,e)},$$slots:b,$$scope:v}}class Ko extends xe{constructor(e){super(),we(this,e,Fo,Ho,s,{disabled:0,icon:0,op:0,type:0})}}const Go=()=>({}),Wo=()=>({});function Vo(e){let n,t,o,a,r,s,c,d;const u=new cn({props:{family:"regular",name:e.icon}});u.$on("click",e.click_handler);const g=e.$$slots.label,m=l(g,e,Wo);return{c(){n=N("div"),t=N("input"),o=S(),ve(u.$$.fragment),a=S(),r=N("label"),m||(s=C("Label")),m&&m.c(),A(t,"type","checkbox"),A(t,"id",e.id),A(t,"name",e.name),t.__value=e.value,t.value=t.__value,t.disabled=e.disabled,A(r,"for",e.id),A(n,"class","checkbox"),j(n,"has-focus",e.hasFocus),j(n,"is-disabled",e.disabled),d=[P(t,"change",e.input_change_handler),P(t,"blur",e.blur_handler),P(t,"focus",e.focus_handler)]},m(i,d){k(i,n,d),x(n,t),t.checked=e.checked,e.input_binding(t),x(n,o),ye(u,n,null),x(n,a),x(n,r),m||x(r,s),m&&m.m(r,null),c=!0},p(e,o){c&&!e.id||A(t,"id",o.id),c&&!e.name||A(t,"name",o.name),c&&!e.value||(t.__value=o.value),t.value=t.__value,c&&!e.disabled||(t.disabled=o.disabled),e.checked&&(t.checked=o.checked);const a={};e.icon&&(a.name=o.icon),u.$set(a),m&&m.p&&e.$$scope&&m.p(p(g,o,e,Go),f(g,o,Wo)),c&&!e.id||A(r,"for",o.id),e.hasFocus&&j(n,"has-focus",o.hasFocus),e.disabled&&j(n,"is-disabled",o.disabled)},i(e){c||(pe(u.$$.fragment,e),pe(m,e),c=!0)},o(e){ge(u.$$.fragment,e),ge(m,e),c=!1},d(t){t&&E(n),e.input_binding(null),_e(u),m&&m.d(t),i(d)}}}function Zo(e,n,t){let o,{checked:a=!1}=n,{disabled:i=!1}=n,{name:r=""}=n,{id:s=(r?"form_"+r:en())}=n,{value:c=1}=n,d=!1,{$$slots:u={},$$scope:l}=n;let f;return e.$set=e=>{"checked"in e&&t("checked",a=e.checked),"disabled"in e&&t("disabled",i=e.disabled),"name"in e&&t("name",r=e.name),"id"in e&&t("id",s=e.id),"value"in e&&t("value",c=e.value),"$$scope"in e&&t("$$scope",l=e.$$scope)},e.$$.update=(e={inputEl:1,checked:1})=>{e.inputEl&&o&&!o.syncValue&&(t("inputEl",o.syncValue=function(){t("checked",[a,c]=[this.checked,this.value],a,(t("value",c),t("inputEl",o)))},o),o.syncValue()),e.checked&&t("icon",f=a?"check-square":"square")},{checked:a,disabled:i,name:r,id:s,value:c,inputEl:o,hasFocus:d,icon:f,input_change_handler:function(){a=this.checked,t("checked",a),t("inputEl",o)},input_binding:function(e){J[e?"unshift":"push"](()=>{t("inputEl",o=e)})},blur_handler:()=>{t("hasFocus",d=!1)},focus_handler:()=>{t("hasFocus",d=!0)},click_handler:()=>{i||t("checked",a=!a)},$$slots:u,$$scope:l}}class Yo extends xe{constructor(e){super(),we(this,e,Zo,Vo,s,{checked:0,disabled:0,name:0,id:0,value:0})}}function Jo(e){let n,t,o=Yn(e.$op.error())+"";return{c(){n=N("div"),t=C(o),A(n,"class","error")},m(e,o){k(e,n,o),x(n,t)},p(e,n){e.$op&&o!==(o=Yn(n.$op.error())+"")&&R(t,o)},d(e){e&&E(n)}}}function Qo(n){let t,o=n.$op.is("error"),a=o&&Jo(n);return{c(){a&&a.c(),t=D()},m(e,n){a&&a.m(e,n),k(e,t,n)},p(e,n){e.$op&&(o=n.$op.is("error")),o?a?a.p(e,n):((a=Jo(n)).c(),a.m(t.parentNode,t)):a&&(a.d(1),a=null)},i:e,o:e,d(e){a&&a.d(e),e&&E(t)}}}function Xo(n,t,o){let a,i=e,r=()=>(i(),i=c(s,e=>o("$op",a=e)),s);n.$$.on_destroy.push(()=>i());let{op:s=new tn({})}=t;return r(),n.$set=e=>{"op"in e&&r(o("op",s=e.op))},{op:s,$op:a}}class ea extends xe{constructor(e){super(),we(this,e,Xo,Qo,s,{op:0})}}const na=()=>({}),ta=()=>({});function oa(e){let n,t,o,a,i,r,s;const c=e.$$slots.label,d=l(c,e,ta);return{c(){n=N("div"),t=N("label"),d||(o=C("Label")),d&&d.c(),a=S(),i=N("input"),A(t,"for",e.id),A(i,"type","password"),A(i,"name",e.name),A(i,"id",e.id),A(i,"placeholder",e.placeholder),A(n,"class","text-field has-password"),n.hidden=e.hidden,s=P(i,"input",e.input_input_handler)},m(s,c){k(s,n,c),x(n,t),d||x(t,o),d&&d.m(t,null),x(n,a),x(n,i),T(i,e.value),r=!0},p(e,o){d&&d.p&&e.$$scope&&d.p(p(c,o,e,na),f(c,o,ta)),r&&!e.id||A(t,"for",o.id),r&&!e.name||A(i,"name",o.name),r&&!e.id||A(i,"id",o.id),r&&!e.placeholder||A(i,"placeholder",o.placeholder),e.value&&i.value!==o.value&&T(i,o.value),r&&!e.hidden||(n.hidden=o.hidden)},i(e){r||(pe(d,e),r=!0)},o(e){ge(d,e),r=!1},d(e){e&&E(n),d&&d.d(e),s()}}}function aa(e,n,t){let{hidden:o=!1}=n,{name:a=""}=n,{id:i=(a?"form_"+a:en())}=n,{placeholder:r=""}=n,{value:s=""}=n,{$$slots:c={},$$scope:d}=n;return e.$set=e=>{"hidden"in e&&t("hidden",o=e.hidden),"name"in e&&t("name",a=e.name),"id"in e&&t("id",i=e.id),"placeholder"in e&&t("placeholder",r=e.placeholder),"value"in e&&t("value",s=e.value),"$$scope"in e&&t("$$scope",d=e.$$scope)},{hidden:o,name:a,id:i,placeholder:r,value:s,input_input_handler:function(){s=this.value,t("value",s)},$$slots:c,$$scope:d}}class ia extends xe{constructor(e){super(),we(this,e,aa,oa,s,{hidden:0,name:0,id:0,placeholder:0,value:0})}}function ra(e){let n,t,o,a,i=Yn(e.dialog.dialog_id?"Conversation":"Connection")+"";const r=new cn({props:{name:"times-circle"}});return{c(){n=N("h2"),t=C(i),o=S(),ve(r.$$.fragment)},m(e,i){k(e,n,i),x(n,t),k(e,o,i),ye(r,e,i),a=!0},p(e,n){a&&!e.dialog||i===(i=Yn(n.dialog.dialog_id?"Conversation":"Connection")+"")||R(t,i)},i(e){a||(pe(r.$$.fragment,e),a=!0)},o(e){ge(r.$$.fragment,e),a=!1},d(e){e&&E(n),e&&E(o),_e(r,e)}}}function sa(e){let n,t={href:e.dialog.path,class:"sidebar__header for-settings",$$slots:{default:[ra]},$$scope:{ctx:e}};const o=new Nn({props:t});return e.link_binding(o),{c(){ve(o.$$.fragment)},m(e,t){ye(o,e,t),n=!0},p(e,n){const t={};e.dialog&&(t.href=n.dialog.path),(e.$$scope||e.dialog)&&(t.$$scope={changed:e,ctx:n}),o.$set(t)},i(e){n||(pe(o.$$.fragment,e),n=!0)},o(e){ge(o.$$.fragment,e),n=!1},d(n){e.link_binding(null),_e(o,n)}}}function ca(e,n,t){let o,{dialog:a={}}=n;return e.$set=e=>{"dialog"in e&&t("dialog",a=e.dialog)},e.$$.update=(e={linkEl:1})=>{e.linkEl&&o&&o.focus()},{dialog:a,linkEl:o,link_binding:function(e){J[e?"unshift":"push"](()=>{t("linkEl",o=e)})}}}class da extends xe{constructor(e){super(),we(this,e,ca,sa,s,{dialog:0})}}const ua=()=>({}),la=()=>({});function fa(e){let n,t,o,a,i,r,s;const c=e.$$slots.label,d=l(c,e,la);return{c(){n=N("div"),t=N("label"),d||(o=C("Label")),d&&d.c(),a=S(),i=N("textarea"),A(t,"for",e.id),A(i,"name",e.name),A(i,"placeholder",e.placeholder),A(i,"id",e.id),i.readOnly=e.readonly,A(n,"class","text-area"),n.hidden=e.hidden,s=P(i,"input",e.textarea_input_handler)},m(s,c){k(s,n,c),x(n,t),d||x(t,o),d&&d.m(t,null),x(n,a),x(n,i),T(i,e.value),e.textarea_binding(i),r=!0},p(e,o){d&&d.p&&e.$$scope&&d.p(p(c,o,e,ua),f(c,o,la)),r&&!e.id||A(t,"for",o.id),r&&!e.name||A(i,"name",o.name),r&&!e.placeholder||A(i,"placeholder",o.placeholder),r&&!e.id||A(i,"id",o.id),r&&!e.readonly||(i.readOnly=o.readonly),e.value&&T(i,o.value),r&&!e.hidden||(n.hidden=o.hidden)},i(e){r||(pe(d,e),r=!0)},o(e){ge(d,e),r=!1},d(t){t&&E(n),d&&d.d(t),e.textarea_binding(null),s()}}}function pa(e,n,t){let o,{hidden:a=!1}=n,{name:i=""}=n,{id:r=(i?"form_"+i:en())}=n,{placeholder:s=""}=n,{readonly:c=!1}=n,{value:d=""}=n,{$$slots:u={},$$scope:l}=n;return e.$set=e=>{"hidden"in e&&t("hidden",a=e.hidden),"name"in e&&t("name",i=e.name),"id"in e&&t("id",r=e.id),"placeholder"in e&&t("placeholder",s=e.placeholder),"readonly"in e&&t("readonly",c=e.readonly),"value"in e&&t("value",d=e.value),"$$scope"in e&&t("$$scope",l=e.$$scope)},e.$$.update=(e={inputEl:1})=>{e.inputEl&&o&&!o.syncValue&&(t("inputEl",o.syncValue=function(){t("value",d=this.value)},o),o.syncValue())},{inputEl:o,hidden:a,name:i,id:r,placeholder:s,readonly:c,value:d,textarea_input_handler:function(){d=this.value,t("value",d),t("inputEl",o)},textarea_binding:function(e){J[e?"unshift":"push"](()=>{t("inputEl",o=e)})},$$slots:u,$$scope:l}}class ga extends xe{constructor(e){super(),we(this,e,pa,fa,s,{hidden:0,name:0,id:0,placeholder:0,readonly:0,value:0})}}function ma(e){let n,t;return{c(){A(n=N("input"),"type","hidden"),A(n,"name","connection_id"),n.value=t=e.connection.connection_id},m(e,t){k(e,n,t)},p(e,o){e.connection&&t!==(t=o.connection.connection_id)&&(n.value=t)},d(e){e&&E(n)}}}function ha(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Host and port")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function $a(n){return{c:e,m:e,p:e,d:e}}function ba(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Nickname")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function va(n){return{c:e,m:e,p:e,d:e}}function ya(e){let n;const t=new Mn({props:{name:"dialog",placeholder:Yn("Ex: #convos"),$$slots:{default:[xa],label:[wa]},$$scope:{ctx:e}}});return{c(){ve(t.$$.fragment)},m(e,o){ye(t,e,o),n=!0},p(e,n){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),t.$set(o)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function _a(e){let n,t;function o(n){e.checkbox_checked_binding.call(null,n)}let a={$$slots:{default:[Ea],label:[ka]},$$scope:{ctx:e}};void 0!==e.wantToBeConnected&&(a.checked=e.wantToBeConnected);const i=new Yo({props:a});return J.push(()=>be(i,"checked",o)),{c(){ve(i.$$.fragment)},m(e,n){ye(i,e,n),t=!0},p(e,t){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),!n&&e.wantToBeConnected&&(n=!0,o.checked=t.wantToBeConnected,ie(()=>n=!1)),i.$set(o)},i(e){t||(pe(i.$$.fragment,e),t=!0)},o(e){ge(i.$$.fragment,e),t=!1},d(e){_e(i,e)}}}function wa(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Conversation name")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function xa(n){return{c:e,m:e,p:e,d:e}}function ka(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Want to be connected")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Ea(n){return{c:e,m:e,p:e,d:e}}function Oa(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Secure connection (TLS)")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Na(n){return{c:e,m:e,p:e,d:e}}function Ca(e){let n,t;function o(n){e.checkbox_checked_binding_1.call(null,n)}let a={name:"tls_verify",$$slots:{default:[Da],label:[Sa]},$$scope:{ctx:e}};void 0!==e.verifyTls&&(a.checked=e.verifyTls);const i=new Yo({props:a});return J.push(()=>be(i,"checked",o)),{c(){ve(i.$$.fragment)},m(e,n){ye(i,e,n),t=!0},p(e,t){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),!n&&e.verifyTls&&(n=!0,o.checked=t.verifyTls,ie(()=>n=!1)),i.$set(o)},i(e){t||(pe(i.$$.fragment,e),t=!0)},o(e){ge(i.$$.fragment,e),t=!1},d(e){_e(i,e)}}}function Sa(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Verify certificate (TLS)")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Da(n){return{c:e,m:e,p:e,d:e}}function Pa(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Show advanced settings")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Ma(n){return{c:e,m:e,p:e,d:e}}function Aa(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Username")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Ra(n){return{c:e,m:e,p:e,d:e}}function Ta(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Password")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function La(n){return{c:e,m:e,p:e,d:e}}function ja(n){let t;return{c(){(t=N("span")).textContent=`${Yn("On-connect commands")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Ia(n){return{c:e,m:e,p:e,d:e}}function Ua(e){let n;const t=new Ko({props:{icon:"save",op:e.createConnectionOp,$$slots:{default:[Ba]},$$scope:{ctx:e}}});return{c(){ve(t.$$.fragment)},m(e,o){ye(t,e,o),n=!0},p(e,n){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),t.$set(o)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function za(e){let n,t;const o=new Ko({props:{icon:"save",op:e.updateConnectionOp,$$slots:{default:[Ha]},$$scope:{ctx:e}}}),a=new Ko({props:{icon:"trash",type:"button",op:e.removeConnectionOp,$$slots:{default:[qa]},$$scope:{ctx:e}}});return a.$on("click",e.removeConnection),{c(){ve(o.$$.fragment),n=S(),ve(a.$$.fragment)},m(e,i){ye(o,e,i),k(e,n,i),ye(a,e,i),t=!0},p(e,n){const t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),o.$set(t);const i={};e.$$scope&&(i.$$scope={changed:e,ctx:n}),a.$set(i)},i(e){t||(pe(o.$$.fragment,e),pe(a.$$.fragment,e),t=!0)},o(e){ge(o.$$.fragment,e),ge(a.$$.fragment,e),t=!1},d(e){_e(o,e),e&&E(n),_e(a,e)}}}function Ba(n){let t,o=Yn("Create")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Ha(n){let t,o=Yn("Update")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function qa(n){let t,o=Yn("Delete")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Fa(n){let t,o,a,i,r,s,c,d,u,l,f,p,g,m,h,$,b,v,y,_,w,O,C,D,R,T,L,j,I=n.connection.connection_id&&ma(n);const U=new Mn({props:{name:"server",placeholder:Yn("Ex: chat.freenode.net:6697"),readonly:n.settings.forced_connection,$$slots:{default:[$a],label:[ha]},$$scope:{ctx:n}}});let z=n.settings.forced_connection&&function(n){let t,o=Jn("Connection is locked by %1.",n.settings.contact)+"";return{c(){t=N("p")},m(e,n){k(e,t,n),t.innerHTML=o},p:e,d(e){e&&E(t)}}}(n);const B=new Mn({props:{name:"nick",placeholder:Yn("Ex: your-name"),$$slots:{default:[va],label:[ba]},$$scope:{ctx:n}}}),H=[_a,ya],q=[];function F(e,n){return n.connection.url?0:1}function K(e){n.checkbox0_checked_binding.call(null,e)}l=F(0,n),f=q[l]=H[l](n);let G={name:"tls",$$slots:{default:[Na],label:[Oa]},$$scope:{ctx:n}};void 0!==n.useTls&&(G.checked=n.useTls);const W=new Yo({props:G});J.push(()=>be(W,"checked",K));let V=n.useTls&&Ca(n);function Z(e){n.checkbox1_checked_binding.call(null,e)}let Y={$$slots:{default:[Ma],label:[Pa]},$$scope:{ctx:n}};void 0!==n.showAdvancedSettings&&(Y.checked=n.showAdvancedSettings);const Q=new Yo({props:Y});J.push(()=>be(Q,"checked",Z));const X=new Mn({props:{name:"username",hidden:!n.showAdvancedSettings,$$slots:{default:[Ra],label:[Aa]},$$scope:{ctx:n}}}),ee=new ia({props:{name:"password",hidden:!n.showAdvancedSettings,$$slots:{default:[La],label:[Ta]},$$scope:{ctx:n}}}),ne=new ga({props:{name:"on_connect_commands",hidden:!n.showAdvancedSettings,$$slots:{default:[Ia],label:[ja]},$$scope:{ctx:n}}}),te=[za,Ua],oe=[];function ae(e,n){return n.connection.url?0:1}O=ae(0,n),C=oe[O]=te[O](n);const re=new ea({props:{op:n.createConnectionOp}}),se=new ea({props:{op:n.removeConnectionOp}}),ce=new ea({props:{op:n.updateConnectionOp}});return{c(){t=N("form"),I&&I.c(),o=S(),a=N("input"),i=S(),r=N("input"),s=S(),ve(U.$$.fragment),c=S(),z&&z.c(),d=S(),ve(B.$$.fragment),u=S(),f.c(),p=S(),ve(W.$$.fragment),m=S(),V&&V.c(),h=S(),ve(Q.$$.fragment),b=S(),ve(X.$$.fragment),v=S(),ve(ee.$$.fragment),y=S(),ve(ne.$$.fragment),_=S(),w=N("div"),C.c(),D=S(),ve(re.$$.fragment),R=S(),ve(se.$$.fragment),T=S(),ve(ce.$$.fragment),A(a,"type","hidden"),A(a,"name","url"),A(r,"type","hidden"),A(r,"name","wanted_state"),A(w,"class","form-actions"),A(t,"method","post"),j=P(t,"submit",M(n.submitForm))},m(e,f){k(e,t,f),I&&I.m(t,null),x(t,o),x(t,a),x(t,i),x(t,r),x(t,s),ye(U,t,null),x(t,c),z&&z.m(t,null),x(t,d),ye(B,t,null),x(t,u),q[l].m(t,null),x(t,p),ye(W,t,null),x(t,m),V&&V.m(t,null),x(t,h),ye(Q,t,null),x(t,b),ye(X,t,null),x(t,v),ye(ee,t,null),x(t,y),ye(ne,t,null),x(t,_),x(t,w),oe[O].m(w,null),x(t,D),ye(re,t,null),x(t,R),ye(se,t,null),x(t,T),ye(ce,t,null),n.form_binding(t),L=!0},p(e,n){n.connection.connection_id?I?I.p(e,n):((I=ma(n)).c(),I.m(t,o)):I&&(I.d(1),I=null);const a={};e.$$scope&&(a.$$scope={changed:e,ctx:n}),U.$set(a),n.settings.forced_connection&&z.p(e,n);const i={};e.$$scope&&(i.$$scope={changed:e,ctx:n}),B.$set(i);let r=l;(l=F(0,n))===r?q[l].p(e,n):(le(),ge(q[r],1,1,()=>{q[r]=null}),fe(),(f=q[l])||(f=q[l]=H[l](n)).c(),pe(f,1),f.m(t,p));const s={};e.$$scope&&(s.$$scope={changed:e,ctx:n}),!g&&e.useTls&&(g=!0,s.checked=n.useTls,ie(()=>g=!1)),W.$set(s),n.useTls?V?(V.p(e,n),pe(V,1)):((V=Ca(n)).c(),pe(V,1),V.m(t,h)):V&&(le(),ge(V,1,1,()=>{V=null}),fe());const c={};e.$$scope&&(c.$$scope={changed:e,ctx:n}),!$&&e.showAdvancedSettings&&($=!0,c.checked=n.showAdvancedSettings,ie(()=>$=!1)),Q.$set(c);const d={};e.showAdvancedSettings&&(d.hidden=!n.showAdvancedSettings),e.$$scope&&(d.$$scope={changed:e,ctx:n}),X.$set(d);const u={};e.showAdvancedSettings&&(u.hidden=!n.showAdvancedSettings),e.$$scope&&(u.$$scope={changed:e,ctx:n}),ee.$set(u);const m={};e.showAdvancedSettings&&(m.hidden=!n.showAdvancedSettings),e.$$scope&&(m.$$scope={changed:e,ctx:n}),ne.$set(m);let b=O;(O=ae(0,n))===b?oe[O].p(e,n):(le(),ge(oe[b],1,1,()=>{oe[b]=null}),fe(),(C=oe[O])||(C=oe[O]=te[O](n)).c(),pe(C,1),C.m(w,null))},i(e){L||(pe(U.$$.fragment,e),pe(B.$$.fragment,e),pe(f),pe(W.$$.fragment,e),pe(V),pe(Q.$$.fragment,e),pe(X.$$.fragment,e),pe(ee.$$.fragment,e),pe(ne.$$.fragment,e),pe(C),pe(re.$$.fragment,e),pe(se.$$.fragment,e),pe(ce.$$.fragment,e),L=!0)},o(e){ge(U.$$.fragment,e),ge(B.$$.fragment,e),ge(f),ge(W.$$.fragment,e),ge(V),ge(Q.$$.fragment,e),ge(X.$$.fragment,e),ge(ee.$$.fragment,e),ge(ne.$$.fragment,e),ge(C),ge(re.$$.fragment,e),ge(se.$$.fragment,e),ge(ce.$$.fragment,e),L=!1},d(e){e&&E(t),I&&I.d(),_e(U),z&&z.d(),_e(B),q[l].d(),_e(W),V&&V.d(),_e(Q),_e(X),_e(ee),_e(ne),oe[O].d(),_e(re),_e(se),_e(ce),n.form_binding(null),j()}}}function Ka(e,n,t){let{dialog:o={}}=n;const a=V("settings"),i=V("user"),r=i.api.operation("createConnection"),s=i.api.operation("removeConnection"),c=i.api.operation("updateConnection");[r,c].forEach(e=>{e.on("start",e=>{e.body.on_connect_commands=e.body.on_connect_commands.split("\n").map(e=>e.trim())})});let d,u={},l=!1,f=!1,p=!1,g=!1;function m(){u.url&&(t("formEl",d.server.value=u.url.host,d),t("formEl",d.nick.value=u.url.searchParams.get("nick")||"",d),t("formEl",d.on_connect_commands.value=u.on_connect_commands.join("\n"),d),t("formEl",d.password.value=u.url.password,d),t("formEl",d.username.value=u.url.username,d),t("formEl",d.url.value=u.url.toString(),d),t("useTls",f="1"==u.url.searchParams.get("tls")),t("verifyTls",p="1"==u.url.searchParams.get("tls_verify")),t("wantToBeConnected",g="connected"==u.wanted_state))}return G(async()=>{if(d)return t("connection",u=i.findDialog({connection_id:o.connection_id})||{}),u.url?m():function(){a.forced_connection&&t("formEl",d.server.value=a.default_connection,d);t("formEl",d.nick.value=i.email.replace(/@.*/,"").replace(/\W/g,"_"),d),t("useTls",f=!0),t("wantToBeConnected",g=!0);const e=new URL(location.href);if(!e.searchParams.get("uri"))return kn(d,e);const n=new Ot(e.searchParams.get("uri")),o=n.searchParams;n.host&&t("formEl",d.server.value=n.host,d);n.password&&t("formEl",d.password.value=n.password,d);n.username&&t("formEl",d.username.value=n.username,d);o.get("nick")&&t("formEl",d.nick.value=o.get("nick"),d);n.pathname&&d.dialog&&t("formEl",d.dialog.value=decodeURIComponent(n.pathname.split("/").filter(e=>e.length)[0]||""),d);Number(o.get("tls")||0)&&t("useTls",f=!0);Number(o.get("tls_verify")||0)&&t("verifyTls",p=!0)}()}),e.$set=e=>{"dialog"in e&&t("dialog",o=e.dialog)},e.$$.update=(e={formEl:1,wantToBeConnected:1})=>{(e.formEl||e.wantToBeConnected)&&d&&t("formEl",d.wanted_state.value=g?"connected":"disconnected",d)},{dialog:o,settings:a,createConnectionOp:r,removeConnectionOp:s,updateConnectionOp:c,connection:u,formEl:d,showAdvancedSettings:l,useTls:f,verifyTls:p,wantToBeConnected:g,removeConnection:async function(e){await s.perform(u),i.removeDialog(u),vn("/chat")},submitForm:async function(e){if(d.server.value)if(t("formEl",d.url.value=new Ot("irc://localhost:6667").fromForm(e.target).toString(),d),u.connection_id)await c.perform(e.target),i.ensureDialog(c.res.body),m();else{await r.perform(e.target),vn(i.ensureDialog(r.res.body).path)}},checkbox_checked_binding:function(e){t("wantToBeConnected",g=e)},checkbox0_checked_binding:function(e){t("useTls",f=e)},checkbox_checked_binding_1:function(e){t("verifyTls",p=e)},checkbox1_checked_binding:function(e){t("showAdvancedSettings",l=e)},form_binding:function(e){J[e?"unshift":"push"](()=>{t("formEl",d=e)})}}}class Ga extends xe{constructor(e){super(),we(this,e,Ka,Fa,s,{dialog:0})}}function Wa(e){let n,t,o=Yn("Currently connecting to %1.",e.connectionHost)+"";return{c(){n=N("p"),t=C(o)},m(e,o){k(e,n,o),x(n,t)},p(e,n){e.connectionHost&&o!==(o=Yn("Currently connecting to %1.",n.connectionHost)+"")&&R(t,o)},d(e){e&&E(n)}}}function Va(e){let n,t,o=Yn("Currently connected to %1.",e.connectionHost)+"";return{c(){n=N("p"),t=C(o)},m(e,o){k(e,n,o),x(n,t)},p(e,n){e.connectionHost&&o!==(o=Yn("Currently connected to %1.",n.connectionHost)+"")&&R(t,o)},d(e){e&&E(n)}}}function Za(e){let n,t,o=Yn("Currently disconnected from %1.",e.connectionHost)+"";return{c(){n=N("p"),t=C(o)},m(e,o){k(e,n,o),x(n,t)},p(e,n){e.connectionHost&&o!==(o=Yn("Currently disconnected from %1.",n.connectionHost)+"")&&R(t,o)},d(e){e&&E(n)}}}function Ya(n){let t;return{c(){(t=N("p")).textContent=`${Yn("Connection not found.")}`},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Ja(e){let n,t,o,a,i;const r=new da({props:{dialog:e.dialog}});function s(e,n){return n.connection.url?"disconnected"==n.connection.state?Za:"connected"==n.connection.state?Va:Wa:Ya}let c=s(0,e),d=c(e);const u=new Ga({props:{dialog:e.dialog}});return{c(){n=N("div"),ve(r.$$.fragment),t=S(),d.c(),o=S(),ve(u.$$.fragment),A(n,"class","sidebar-left")},m(e,a){k(e,n,a),ye(r,n,null),x(n,t),d.m(n,null),x(n,o),ye(u,n,null),i=!0},p(e,t){const a={};e.dialog&&(a.dialog=t.dialog),r.$set(a),c===(c=s(0,t))&&d?d.p(e,t):(d.d(1),(d=c(t))&&(d.c(),d.m(n,o)));const i={};e.dialog&&(i.dialog=t.dialog),u.$set(i)},i(t){i||(pe(r.$$.fragment,t),pe(u.$$.fragment,t),ae(()=>{a||(a=he(n,Tn,e.transition,!0)),a.run(1)}),i=!0)},o(t){ge(r.$$.fragment,t),ge(u.$$.fragment,t),a||(a=he(n,Tn,e.transition,!1)),a.run(0),i=!1},d(e){e&&E(n),_e(r),d.d(),_e(u),e&&a&&a.end()}}}function Qa(e,n,t){let{dialog:o={}}=n,{transition:a}=n;const i=V("user");let r,s={};return G(async()=>{await i.load(),t("connection",s=i.findDialog({connection_id:o.connection_id})||{})}),e.$set=e=>{"dialog"in e&&t("dialog",o=e.dialog),"transition"in e&&t("transition",a=e.transition)},e.$$.update=(e={connection:1})=>{e.connection&&t("connectionHost",r=s.url&&s.url.host)},{dialog:o,transition:a,connection:s,connectionHost:r}}class Xa extends xe{constructor(e){super(),we(this,e,Qa,Ja,s,{dialog:0,transition:0})}}function ei(e,n,t){const o=Object.create(e);return o.participant=n[t],o}function ni(e){let n,t=Yn("You are not a channel operator in %1.",e.dialog.name)+"";return{c(){n=C(t)},m(e,t){k(e,n,t)},p(e,o){e.dialog&&t!==(t=Yn("You are not a channel operator in %1.",o.dialog.name)+"")&&R(n,t)},d(e){e&&E(n)}}}function ti(e){let n,t=Yn("You are a channel operator in %1.",e.dialog.name)+"";return{c(){n=C(t)},m(e,t){k(e,n,t)},p(e,o){e.dialog&&t!==(t=Yn("You are a channel operator in %1.",o.dialog.name)+"")&&R(n,t)},d(e){e&&E(n)}}}function oi(e){let n,t=Yn("Private conversation with %1.",e.dialog.name)+"";return{c(){n=C(t)},m(e,t){k(e,n,t)},p(e,o){e.dialog&&t!==(t=Yn("Private conversation with %1.",o.dialog.name)+"")&&R(n,t)},d(e){e&&E(n)}}}function ai(e){let n,t=Yn("Conversation with %1 is frozen. Reason: %2",e.dialog.name,Yn(e.dialog.frozen))+"";return{c(){n=C(t)},m(e,t){k(e,n,t)},p(e,o){e.dialog&&t!==(t=Yn("Conversation with %1 is frozen. Reason: %2",o.dialog.name,Yn(o.dialog.frozen))+"")&&R(n,t)},d(e){e&&E(n)}}}function ii(e){let n,t,o,a,i,r,s,c,d,u;function l(n){e.textarea_value_binding.call(null,n)}let f={name:"topic",placeholder:Yn("No topic is set."),readonly:!e.isOperator,$$slots:{default:[si],label:[ri]},$$scope:{ctx:e}};void 0!==e.dialogTopic&&(f.value=e.dialogTopic);const p=new ga({props:f});function g(n){e.passwordfield_value_binding.call(null,n)}J.push(()=>be(p,"value",l));let m={name:"password",$$slots:{default:[di],label:[ci]},$$scope:{ctx:e}};void 0!==e.dialogPassword&&(m.value=e.dialogPassword);const h=new ia({props:m});return J.push(()=>be(h,"value",g)),{c(){n=N("input"),o=S(),a=N("input"),r=S(),ve(p.$$.fragment),c=S(),ve(h.$$.fragment),A(n,"type","hidden"),A(n,"name","connection_id"),n.value=t=e.dialog.connection_id,A(a,"type","hidden"),A(a,"name","dialog_id"),a.value=i=e.dialog.dialog_id},m(e,t){k(e,n,t),k(e,o,t),k(e,a,t),k(e,r,t),ye(p,e,t),k(e,c,t),ye(h,e,t),u=!0},p(e,o){(!u||e.dialog&&t!==(t=o.dialog.connection_id))&&(n.value=t),(!u||e.dialog&&i!==(i=o.dialog.dialog_id))&&(a.value=i);const r={};e.isOperator&&(r.readonly=!o.isOperator),e.$$scope&&(r.$$scope={changed:e,ctx:o}),!s&&e.dialogTopic&&(s=!0,r.value=o.dialogTopic,ie(()=>s=!1)),p.$set(r);const c={};e.$$scope&&(c.$$scope={changed:e,ctx:o}),!d&&e.dialogPassword&&(d=!0,c.value=o.dialogPassword,ie(()=>d=!1)),h.$set(c)},i(e){u||(pe(p.$$.fragment,e),pe(h.$$.fragment,e),u=!0)},o(e){ge(p.$$.fragment,e),ge(h.$$.fragment,e),u=!1},d(e){e&&E(n),e&&E(o),e&&E(a),e&&E(r),_e(p,e),e&&E(c),_e(h,e)}}}function ri(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Topic")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function si(n){return{c:e,m:e,p:e,d:e}}function ci(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Password")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function di(n){return{c:e,m:e,p:e,d:e}}function ui(e){let n;const t=new Ko({props:{icon:"save",$$slots:{default:[li]},$$scope:{ctx:e}}});return{c(){ve(t.$$.fragment)},m(e,o){ye(t,e,o),n=!0},p(e,n){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),t.$set(o)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function li(n){let t,o=Yn("Update")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function fi(n){let t,o=Yn("Part")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function pi(e){let n,t,o,a,i,r=Yn("Participants (%1)",e.dialog.participants().length)+"",s=e.dialog.participants(),c=[];for(let n=0;n<s.length;n+=1)c[n]=mi(ei(e,s,n));const d=e=>ge(c[e],1,1,()=>{c[e]=null});return{c(){n=N("nav"),t=N("h3"),o=C(r),a=S();for(let e=0;e<c.length;e+=1)c[e].c();A(n,"class","sidebar-left__nav")},m(e,r){k(e,n,r),x(n,t),x(t,o),x(n,a);for(let e=0;e<c.length;e+=1)c[e].m(n,null);i=!0},p(e,t){if(i&&!e.dialog||r===(r=Yn("Participants (%1)",t.dialog.participants().length)+"")||R(o,r),e.dialog||e.modeClassNames){let o;for(s=t.dialog.participants(),o=0;o<s.length;o+=1){const a=ei(t,s,o);c[o]?(c[o].p(e,a),pe(c[o],1)):(c[o]=mi(a),c[o].c(),pe(c[o],1),c[o].m(n,null))}for(le(),o=s.length;o<c.length;o+=1)d(o);fe()}},i(e){if(!i){for(let e=0;e<s.length;e+=1)pe(c[e]);i=!0}},o(e){c=c.filter(Boolean);for(let e=0;e<c.length;e+=1)ge(c[e]);i=!1},d(e){e&&E(n),O(c,e)}}}function gi(e){let n,t,o,a=e.participant.nick+"";return{c(){n=N("span"),t=C(a),o=S()},m(e,a){k(e,n,a),x(n,t),k(e,o,a)},p(e,n){e.dialog&&a!==(a=n.participant.nick+"")&&R(t,a)},d(e){e&&E(n),e&&E(o)}}}function mi(e){let n;const t=new Nn({props:{href:"/chat/"+e.dialog.connection_id+"/"+e.participant.id,class:"participant "+We(e.participant.modes),$$slots:{default:[gi]},$$scope:{ctx:e}}});return{c(){ve(t.$$.fragment)},m(e,o){ye(t,e,o),n=!0},p(e,n){const o={};e.dialog&&(o.href="/chat/"+n.dialog.connection_id+"/"+n.participant.id),e.dialog&&(o.class="participant "+We(n.participant.modes)),(e.$$scope||e.dialog)&&(o.$$scope={changed:e,ctx:n}),t.$set(o)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function hi(e){let n,t,o,a,i,r,s,c,d,u,l,f,p,g=!e.dialog.is("private"),m=!e.dialog.is("private");const h=new da({props:{dialog:e.dialog}});function $(e,n){return n.dialog.frozen?ai:((null==a||e.dialog)&&(a=!!n.dialog.is("private")),a?oi:n.isOperator?ti:ni)}let b=$(null,e),v=b(e),y=g&&ii(e),_=m&&ui(e);const w=new Ko({props:{type:"button",icon:"sign-out-alt",$$slots:{default:[fi]},$$scope:{ctx:e}}});w.$on("click",e.partDialog);let O=!e.dialog.frozen&&pi(e);return{c(){n=N("div"),ve(h.$$.fragment),t=S(),o=N("p"),v.c(),i=S(),r=N("form"),y&&y.c(),s=S(),c=N("div"),_&&_.c(),d=S(),ve(w.$$.fragment),u=S(),O&&O.c(),A(c,"class","form-actions"),A(r,"method","post"),A(n,"class","sidebar-left"),p=P(r,"submit",M(e.saveDialogSettings))},m(a,l){k(a,n,l),ye(h,n,null),x(n,t),x(n,o),v.m(o,null),x(n,i),x(n,r),y&&y.m(r,null),x(r,s),x(r,c),_&&_.m(c,null),x(c,d),ye(w,c,null),e.form_binding(r),x(n,u),O&&O.m(n,null),f=!0},p(e,t){const a={};e.dialog&&(a.dialog=t.dialog),h.$set(a),b===(b=$(e,t))&&v?v.p(e,t):(v.d(1),(v=b(t))&&(v.c(),v.m(o,null))),e.dialog&&(g=!t.dialog.is("private")),g?y?(y.p(e,t),pe(y,1)):((y=ii(t)).c(),pe(y,1),y.m(r,s)):y&&(le(),ge(y,1,1,()=>{y=null}),fe()),e.dialog&&(m=!t.dialog.is("private")),m?_?(_.p(e,t),pe(_,1)):((_=ui(t)).c(),pe(_,1),_.m(c,d)):_&&(le(),ge(_,1,1,()=>{_=null}),fe());const i={};e.$$scope&&(i.$$scope={changed:e,ctx:t}),w.$set(i),t.dialog.frozen?O&&(le(),ge(O,1,1,()=>{O=null}),fe()):O?(O.p(e,t),pe(O,1)):((O=pi(t)).c(),pe(O,1),O.m(n,null))},i(t){f||(pe(h.$$.fragment,t),pe(y),pe(_),pe(w.$$.fragment,t),pe(O),ae(()=>{l||(l=he(n,Tn,e.transition,!0)),l.run(1)}),f=!0)},o(t){ge(h.$$.fragment,t),ge(y),ge(_),ge(w.$$.fragment,t),ge(O),l||(l=he(n,Tn,e.transition,!1)),l.run(0),f=!1},d(t){t&&E(n),_e(h),v.d(),y&&y.d(),_&&_.d(),_e(w),e.form_binding(null),O&&O.d(),t&&l&&l.end(),p()}}}function $i(e,n,t){let{dialog:o={}}=n,{transition:a}=n;const i=V("user");let r,s,c="",d=o.topic;return e.$set=e=>{"dialog"in e&&t("dialog",o=e.dialog),"transition"in e&&t("transition",a=e.transition)},e.$$.update=(e={dialog:1,formEl:1})=>{e.dialog&&t("isOperator",s=function(e){const n=i.findDialog({connection_id:e.connection_id}),t=e.findParticipant(n&&n.nick);return t&&t.modes.operator}(o)),(e.formEl||e.dialog)&&r&&r.topic&&t("formEl",r.topic.value=o.topic||"",r)},{dialog:o,transition:a,dialogPassword:c,dialogTopic:d,formEl:r,partDialog:function(e){i.send({message:"/part",dialog:o})},saveDialogSettings:function(e){if(c){const e=s?"/mode +k "+c:"/join "+o.name+" "+c;i.send({message:e,dialog:o}),t("dialogPassword",c="")}s&&d!=o.topic&&i.send({message:"/topic "+d,dialog:o})},isOperator:s,textarea_value_binding:function(e){t("dialogTopic",d=e)},passwordfield_value_binding:function(e){t("dialogPassword",c=e)},form_binding:function(e){J[e?"unshift":"push"](()=>{t("formEl",r=e)})}}}class bi extends xe{constructor(e){super(),we(this,e,$i,hi,s,{dialog:0,transition:0})}}function vi(e,n,t){const o=Object.create(e);return o.participant=n[t],o}function yi(e){let n,t;var o=e.settingsComponent;function a(e){return{props:{dialog:e.dialog,transition:{duration:250,x:e.$container.wideScreen?0:e.$container.width}}}}if(o)var i=new o(a(e));return{c(){i&&ve(i.$$.fragment),n=D()},m(e,o){i&&ye(i,e,o),k(e,n,o),t=!0},p(e,t){const r={};if(e.dialog&&(r.dialog=t.dialog),e.$container&&(r.transition={duration:250,x:t.$container.wideScreen?0:t.$container.width}),o!==(o=t.settingsComponent)){if(i){le();const e=i;ge(e.$$.fragment,1,0,()=>{_e(e,1)}),fe()}o?(ve((i=new o(a(t))).$$.fragment),pe(i.$$.fragment,1),ye(i,n.parentNode,n)):i=null}else o&&i.$set(r)},i(e){t||(i&&pe(i.$$.fragment,e),t=!0)},o(e){i&&ge(i.$$.fragment,e),t=!1},d(e){e&&E(n),i&&_e(i,e)}}}function _i(e){let n,t,o,a,i,r,s,c,d,u=(e.pathParts[2]||e.pathParts[1]||Yn("Notifications"))+"",l=Qn(e.connection,e.dialog)+"";const f=new cn({props:{name:e.dialog.connection_id?"sliders-h":"bell"}});return{c(){n=N("h1"),t=N("a"),ve(f.$$.fragment),o=N("span"),a=C(u),r=S(),s=N("i"),c=C(l),A(t,"href",i="#activeMenu:"+(e.dialog.connection_id?"settings":"")),A(s,"class","chat-header__topic")},m(e,i){k(e,n,i),x(n,t),ye(f,t,null),x(t,o),x(o,a),k(e,r,i),k(e,s,i),x(s,c),d=!0},p(e,n){const o={};e.dialog&&(o.name=n.dialog.connection_id?"sliders-h":"bell"),f.$set(o),d&&!e.pathParts||u===(u=(n.pathParts[2]||n.pathParts[1]||Yn("Notifications"))+"")||R(a,u),(!d||e.dialog&&i!==(i="#activeMenu:"+(n.dialog.connection_id?"settings":"")))&&A(t,"href",i),d&&!e.connection&&!e.dialog||l===(l=Qn(n.connection,n.dialog)+"")||R(c,l)},i(e){d||(pe(f.$$.fragment,e),d=!0)},o(e){ge(f.$$.fragment,e),d=!1},d(e){e&&E(n),_e(f),e&&E(r),e&&E(s)}}}function wi(e){let n;const t=new Bo({props:{connection:e.connection,dialog:e.dialog,input:e.chatInput}});return{c(){ve(t.$$.fragment)},m(e,o){ye(t,e,o),n=!0},p(e,n){const o={};e.connection&&(o.connection=n.connection),e.dialog&&(o.dialog=n.dialog),e.chatInput&&(o.input=n.chatInput),t.$set(o)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function xi(e){let n,t,o,a,i,r,s,c,d,u,l,f,p=Yn('Do you want to chat with "%1"?',e.pathParts[2])+"",g=Yn("Yes")+"";const m=new Nn({props:{href:"/chat",class:"btn",$$slots:{default:[Ei]},$$scope:{ctx:e}}});return{c(){(n=N("h2")).textContent=`${Yn("You are not part of this conversation.")}`,t=S(),o=N("p"),a=C(p),i=S(),r=N("p"),s=N("a"),c=C(g),u=S(),ve(m.$$.fragment),A(s,"href",d="#add:"+e.pathParts[2]),A(s,"class","btn"),f=P(s,"click",M(e.addDialog))},m(e,d){k(e,n,d),k(e,t,d),k(e,o,d),x(o,a),k(e,i,d),k(e,r,d),x(r,s),x(s,c),x(r,u),ye(m,r,null),l=!0},p(e,n){l&&!e.pathParts||p===(p=Yn('Do you want to chat with "%1"?',n.pathParts[2])+"")||R(a,p),(!l||e.pathParts&&d!==(d="#add:"+n.pathParts[2]))&&A(s,"href",d);const t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),m.$set(t)},i(e){l||(pe(m.$$.fragment,e),l=!0)},o(e){ge(m.$$.fragment,e),l=!1},d(e){e&&E(n),e&&E(t),e&&E(o),e&&E(i),e&&E(r),_e(m),f()}}}function ki(e){let n,t,o,a,i,r,s,c,d=Yn('Do you want to create the connection "%1"?',e.pathParts[1])+"";const u=new Nn({props:{href:"/add/connection?server="+encodeURIComponent(e.pathParts[1])+"&dialog="+encodeURIComponent(e.pathParts[2]),class:"btn",$$slots:{default:[Oi]},$$scope:{ctx:e}}}),l=new Nn({props:{href:"/chat",class:"btn",$$slots:{default:[Ni]},$$scope:{ctx:e}}});return{c(){(n=N("h2")).textContent=`${Yn("Connection does not exist.")}`,t=S(),o=N("p"),a=C(d),i=S(),r=N("p"),ve(u.$$.fragment),s=S(),ve(l.$$.fragment)},m(e,d){k(e,n,d),k(e,t,d),k(e,o,d),x(o,a),k(e,i,d),k(e,r,d),ye(u,r,null),x(r,s),ye(l,r,null),c=!0},p(e,n){c&&!e.pathParts||d===(d=Yn('Do you want to create the connection "%1"?',n.pathParts[1])+"")||R(a,d);const t={};e.pathParts&&(t.href="/add/connection?server="+encodeURIComponent(n.pathParts[1])+"&dialog="+encodeURIComponent(n.pathParts[2])),e.$$scope&&(t.$$scope={changed:e,ctx:n}),u.$set(t);const o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),l.$set(o)},i(e){c||(pe(u.$$.fragment,e),pe(l.$$.fragment,e),c=!0)},o(e){ge(u.$$.fragment,e),ge(l.$$.fragment,e),c=!1},d(e){e&&E(n),e&&E(t),e&&E(o),e&&E(i),e&&E(r),_e(u),_e(l)}}}function Ei(n){let t,o=Yn("No")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Oi(n){let t,o=Yn("Yes")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Ni(n){let t,o=Yn("No")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Ci(e){let n,t={dialog:e.dialog};const o=new vo({props:t});return e.chatinput_binding(o),{c(){ve(o.$$.fragment)},m(e,t){ye(o,e,t),n=!0},p(e,n){const t={};e.dialog&&(t.dialog=n.dialog),o.$set(t)},i(e){n||(pe(o.$$.fragment,e),n=!0)},o(e){ge(o.$$.fragment,e),n=!1},d(n){e.chatinput_binding(null),_e(o,n)}}}function Si(e){let n,t,o,a,i,r,s,c,d=Yn("Participants (%1)",e.dialog.participants().length)+"",u=e.dialog.participants(),l=[];for(let n=0;n<u.length;n+=1)l[n]=Pi(vi(e,u,n));const f=e=>ge(l[e],1,1,()=>{l[e]=null});return{c(){n=N("div"),t=N("nav"),o=N("h3"),a=C(d),i=S();for(let e=0;e<l.length;e+=1)l[e].c();r=S(),s=N("nav"),A(t,"class","sidebar-right__nav"),A(n,"class","sidebar-right")},m(e,d){k(e,n,d),x(n,t),x(t,o),x(o,a),x(t,i);for(let e=0;e<l.length;e+=1)l[e].m(t,null);x(t,r),x(t,s),c=!0},p(e,n){if(c&&!e.dialog||d===(d=Yn("Participants (%1)",n.dialog.participants().length)+"")||R(a,d),e.dialog||e.modeClassNames){let o;for(u=n.dialog.participants(),o=0;o<u.length;o+=1){const a=vi(n,u,o);l[o]?(l[o].p(e,a),pe(l[o],1)):(l[o]=Pi(a),l[o].c(),pe(l[o],1),l[o].m(t,r))}for(le(),o=u.length;o<l.length;o+=1)f(o);fe()}},i(e){if(!c){for(let e=0;e<u.length;e+=1)pe(l[e]);c=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)ge(l[e]);c=!1},d(e){e&&E(n),O(l,e)}}}function Di(e){let n,t,o,a,i=e.participant.nick+"";const r=new cn({props:{name:"pick:"+e.participant.id,family:"solid",color:e.participant.color}});return{c(){ve(r.$$.fragment),n=S(),t=N("span"),o=C(i)},m(e,i){ye(r,e,i),k(e,n,i),k(e,t,i),x(t,o),a=!0},p(e,n){const t={};e.dialog&&(t.name="pick:"+n.participant.id),e.dialog&&(t.color=n.participant.color),r.$set(t),a&&!e.dialog||i===(i=n.participant.nick+"")||R(o,i)},i(e){a||(pe(r.$$.fragment,e),a=!0)},o(e){ge(r.$$.fragment,e),a=!1},d(e){_e(r,e),e&&E(n),e&&E(t)}}}function Pi(e){let n;const t=new Nn({props:{href:"/chat/"+e.dialog.connection_id+"/"+e.participant.id,class:"participant "+We(e.participant.modes),$$slots:{default:[Di]},$$scope:{ctx:e}}});return{c(){ve(t.$$.fragment)},m(e,o){ye(t,e,o),n=!0},p(e,n){const o={};e.dialog&&(o.href="/chat/"+n.dialog.connection_id+"/"+n.participant.id),e.dialog&&(o.class="participant "+We(n.participant.modes)),(e.$$scope||e.dialog)&&(o.$$scope={changed:e,ctx:n}),t.$set(o)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function Mi(e){let n,t,o,a,r,s,c,d,u,l,f,p,g=e.dialog.participants().length;ae(e.onwindowresize);let m="settings"==e.$activeMenu&&yi(e);const h=new fo({props:{$$slots:{default:[_i]},$$scope:{ctx:e}}}),$=[ki,xi,wi],b=[];function v(e,n){return n.pathParts[1]&&!n.connection.connection_id?0:n.pathParts[2]&&!n.dialog.connection_id?1:2}r=v(0,e),s=b[r]=$[r](e);let y=e.dialog.connection_id&&Ci(e),_=g&&Si(e);return{c(){m&&m.c(),n=S(),ve(h.$$.fragment),t=S(),o=N("main"),a=N("div"),s.c(),d=S(),y&&y.c(),u=S(),_&&_.c(),l=D(),A(a,"class","messages-container"),ae(()=>e.div_resize_handler.call(a)),j(a,"has-notifications",1==e.pathParts.length),A(o,"class","main"),p=[P(window,"resize",e.onwindowresize),P(o,"scroll",e.onScroll)]},m(i,s){m&&m.m(i,s),k(i,n,s),ye(h,i,s),k(i,t,s),k(i,o,s),x(o,a),b[r].m(a,null),c=function(e,n){"static"===getComputedStyle(e).position&&(e.style.position="relative");const t=document.createElement("object");let o;return t.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;"),t.type="text/html",t.tabIndex=-1,t.onload=()=>{(o=t.contentDocument.defaultView).addEventListener("resize",n)},/Trident/.test(navigator.userAgent)?(e.appendChild(t),t.data="about:blank"):(t.data="about:blank",e.appendChild(t)),{cancel:()=>{o&&o.removeEventListener&&o.removeEventListener("resize",n),e.removeChild(t)}}}(a,e.div_resize_handler.bind(a)),e.main_binding(o),k(i,d,s),y&&y.m(i,s),k(i,u,s),_&&_.m(i,s),k(i,l,s),f=!0},p(e,t){"settings"==t.$activeMenu?m?(m.p(e,t),pe(m,1)):((m=yi(t)).c(),pe(m,1),m.m(n.parentNode,n)):m&&(le(),ge(m,1,1,()=>{m=null}),fe());const o={};(e.$$scope||e.connection||e.dialog||e.pathParts)&&(o.$$scope={changed:e,ctx:t}),h.$set(o);let i=r;(r=v(0,t))===i?b[r].p(e,t):(le(),ge(b[i],1,1,()=>{b[i]=null}),fe(),(s=b[r])||(s=b[r]=$[r](t)).c(),pe(s,1),s.m(a,null)),e.pathParts&&j(a,"has-notifications",1==t.pathParts.length),t.dialog.connection_id?y?(y.p(e,t),pe(y,1)):((y=Ci(t)).c(),pe(y,1),y.m(u.parentNode,u)):y&&(le(),ge(y,1,1,()=>{y=null}),fe()),e.dialog&&(g=t.dialog.participants().length),g?_?(_.p(e,t),pe(_,1)):((_=Si(t)).c(),pe(_,1),_.m(l.parentNode,l)):_&&(le(),ge(_,1,1,()=>{_=null}),fe())},i(e){f||(pe(m),pe(h.$$.fragment,e),pe(s),pe(y),pe(_),f=!0)},o(e){ge(m),ge(h.$$.fragment,e),ge(s),ge(y),ge(_),f=!1},d(a){m&&m.d(a),a&&E(n),_e(h,a),a&&E(t),a&&E(o),b[r].d(),c.cancel(),e.main_binding(null),a&&E(d),y&&y.d(a),a&&E(u),_&&_.d(a),a&&E(l),i(p)}}}function Ai(e,n,t){let o,a,i,r;u(e,mn,e=>t("$currentUrl",o=e)),u(e,pn,e=>t("$activeMenu",i=e)),u(e,gn,e=>t("$container",r=e));const s=V("user");let c,d;u(e,s,e=>t("$user",a=e));let l,f=null,p=0,g=0,m=0,h="bottom",$={},b=s.notifications,v="",y=o.pathParts,_=[];var w;function x(e,n){t("pathParts",y=n.pathParts);const o=e.findDialog({connection_id:y[1]})||{};o!=$&&function(e){if(!e.url)return;const n=e.url.protocol.replace(/:$/,"");navigator.registerProtocolHandler&&navigator.registerProtocolHandler(n,mn.base+"/register?uri=%s","Convos "+n+" handler")}(t("connection",$=o));const a=1==y.length?e.notifications:e.findDialog({connection_id:y[1],dialog_id:y[2]});if(!a)return t("dialog",b=e.notifications);a==b&&v||(_&&_.forEach(e=>e()),v&&b.setLastRead&&b.setLastRead(),Ve(document,".message__embed",e=>e.remove()),t("dialog",b=a),m=0,v=n.path,h="bottom",t("settingsComponent",f=b.connection_id?b.dialog_id?bi:Xa:null),_=[],$.subscribe&&_.push($.subscribe(e=>{t("connection",$=e)})),b.subscribe&&_.push(b.subscribe(e=>{t("dialog",b=e)})),b.is("pending")&&b.load({before:b.messages[0]}))}function k(e,n){e.forEach(e=>{if(!e.isIntersecting)return;const n=b.messages[e.target.dataset.index]||{};n.embeds&&s.embedMaker.render(e.target,n.embeds)})}w=()=>{l=l||new IntersectionObserver(k,{rootMargin:"0px"}),Ve(document,".message",e=>{e.classList.contains("is-observed")||l.observe(e),e.classList.add("is-observed")}),"bottom"==h?t("messagesEl",d.scrollTop=g,d):m&&m<g&&(t("messagesEl",d.scrollTop=g-m,d),"top"!=h&&(m=0))},K().$$.after_update.push(w),function(e){K().$$.on_destroy.push(e)}(()=>{_.forEach(e=>e())});const E=qe(e=>{if(!d||!b.connection_id)return;const n=d.offsetHeight,t=d.scrollTop;"top"!=(h=n>g||t+20>g-n?"bottom":t<100?"top":"middle")||b.is("loading")||(b.messages.length&&b.load({before:b.messages[0]}),m=g)},20);return e.$$.update=(e={$user:1,$currentUrl:1})=>{(e.$user||e.$currentUrl)&&x(a,o)},{user:s,chatInput:c,messagesEl:d,settingsComponent:f,containerHeight:p,messagesHeight:g,connection:$,dialog:b,pathParts:y,addDialog:function(e){$.connection_id&&$.addDialog(e.target.closest("a").href.replace(/.*#add:/,""))},onScroll:E,$activeMenu:i,$container:r,onwindowresize:function(){t("containerHeight",p=window.innerHeight)},div_resize_handler:function(){g=this.offsetHeight,t("messagesHeight",g)},main_binding:function(e){J[e?"unshift":"push"](()=>{t("messagesEl",d=e)})},chatinput_binding:function(e){J[e?"unshift":"push"](()=>{t("chatInput",c=e)})}}}class Ri extends xe{constructor(e){super(),we(this,e,Ai,Mi,s,{})}}function Ti(n){let t;return{c(){(t=N("h1")).textContent=`${Yn("Add connection")}`},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Li(e){let n,t,o;const a=new fo({props:{$$slots:{default:[Ti]},$$scope:{ctx:e}}}),i=new Ga({});return{c(){ve(a.$$.fragment),n=S(),t=N("main"),ve(i.$$.fragment),A(t,"class","main")},m(e,r){ye(a,e,r),k(e,n,r),k(e,t,r),ye(i,t,null),o=!0},p(e,n){const t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),a.$set(t)},i(e){o||(pe(a.$$.fragment,e),pe(i.$$.fragment,e),o=!0)},o(e){ge(a.$$.fragment,e),ge(i.$$.fragment,e),o=!1},d(e){_e(a,e),e&&E(n),e&&E(t),_e(i)}}}class ji extends xe{constructor(e){super(),we(this,e,null,Li,s,{})}}function Ii(e,n,t){const o=Object.create(e);return o.opt=n[t],o.i=t,o}const Ui=()=>({}),zi=()=>({});function Bi(e){let n,t,o,a,r=(e.opt.length>1?e.opt[1]:e.opt[0])+"";function s(...n){return e.mouseover_handler(e,...n)}return{c(){n=N("a"),t=C(r),A(n,"href",o="#"+e.i+":"+e.opt[0]),A(n,"tabindex","-1"),j(n,"is-active",e.i==e.activeIndex),a=[P(n,"click",e.selectOption),P(n,"mouseover",s)]},m(e,o){k(e,n,o),x(n,t)},p(a,i){e=i,a.visibleOptions&&r!==(r=(e.opt.length>1?e.opt[1]:e.opt[0])+"")&&R(t,r),a.visibleOptions&&o!==(o="#"+e.i+":"+e.opt[0])&&A(n,"href",o),a.activeIndex&&j(n,"is-active",e.i==e.activeIndex)},d(e){e&&E(n),i(a)}}}function Hi(e){let n,t,o,a,r,s,c,d,u,g,m;const h=e.$$slots.label,$=l(h,e,zi);let b=e.visibleOptions,v=[];for(let n=0;n<b.length;n+=1)v[n]=Bi(Ii(e,b,n));return{c(){n=N("div"),t=N("label"),$||(o=C("Label")),$&&$.c(),a=S(),r=N("input"),s=S(),c=N("input"),d=S(),u=N("div");for(let e=0;e<v.length;e+=1)v[e].c();A(t,"for",e.id),A(r,"type","hidden"),A(r,"name",e.name),A(c,"type","text"),A(c,"placeholder",e.placeholder),A(c,"id",e.id),c.readOnly=e.readonly,A(c,"autocomplete","off"),A(u,"class","select-field__options"),A(n,"class","select-field text-field"),n.hidden=e.hidden,j(n,"is-open",e.open),m=[P(r,"input",e.input0_input_handler),P(r,"keydown",e.keydown),P(c,"keydown",e.keydown),P(c,"keyup",e.keyup),P(n,"click",M(e.toggle))]},m(i,l){k(i,n,l),x(n,t),$||x(t,o),$&&$.m(t,null),x(n,a),x(n,r),T(r,e.value),e.input0_binding(r),x(n,s),x(n,c),e.input1_binding(c),x(n,d),x(n,u);for(let e=0;e<v.length;e+=1)v[e].m(u,null);e.div1_binding(n),g=!0},p(e,o){if($&&$.p&&e.$$scope&&$.p(p(h,o,e,Ui),f(h,o,zi)),g&&!e.id||A(t,"for",o.id),g&&!e.name||A(r,"name",o.name),e.value&&T(r,o.value),g&&!e.placeholder||A(c,"placeholder",o.placeholder),g&&!e.id||A(c,"id",o.id),g&&!e.readonly||(c.readOnly=o.readonly),e.visibleOptions||e.activeIndex||e.selectOption){let n;for(b=o.visibleOptions,n=0;n<b.length;n+=1){const t=Ii(o,b,n);v[n]?v[n].p(e,t):(v[n]=Bi(t),v[n].c(),v[n].m(u,null))}for(;n<v.length;n+=1)v[n].d(1);v.length=b.length}g&&!e.hidden||(n.hidden=o.hidden),e.open&&j(n,"is-open",o.open)},i(e){g||(pe($,e),g=!0)},o(e){ge($,e),g=!1},d(t){t&&E(n),$&&$.d(t),e.input0_binding(null),e.input1_binding(null),O(v,t),e.div1_binding(null),i(m)}}}function qi(e,n,t){const o=["ArrowDown","ArrowUp","Enter"];let a,i,r,s=0,c=!1,d="",{hidden:u=!1}=n,{name:l=""}=n,{id:f=(l?"form_"+l:en())}=n,{options:p=[]}=n,{placeholder:g=""}=n,{readonly:m=!1}=n,{value:h=""}=n;async function $(e){let n;if("keydown"==e.type)n=y.length?y[s]:[];else{const t=e.target.href.replace(/^.*?#\d+:/,"");n=y.filter(e=>e[0]==t)[0]||[]}n.length||(n=[""]),t("value",h=n[0]),t("humanEl",i.value=n.length>1?n[1]:n[0],i),await(oe(),ee),i.setSelectionRange(0,9999),t("open",c=!1)}G(()=>{i.addEventListener("blur",()=>setTimeout(()=>{t("open",c=!1)},100)),t("value",h=a.value)});let{$$slots:b={},$$scope:v}=n;let y;return e.$set=e=>{"hidden"in e&&t("hidden",u=e.hidden),"name"in e&&t("name",l=e.name),"id"in e&&t("id",f=e.id),"options"in e&&t("options",p=e.options),"placeholder"in e&&t("placeholder",g=e.placeholder),"readonly"in e&&t("readonly",m=e.readonly),"value"in e&&t("value",h=e.value),"$$scope"in e&&t("$$scope",v=e.$$scope)},e.$$.update=(e={open:1,options:1,typed:1,hiddenEl:1,humanEl:1})=>{if(e.open&&0==c&&t("typed",d=""),(e.options||e.typed)&&t("visibleOptions",y=function(e,n){let t=new RegExp("(?:^|\\s|-)"+Ze(n),"i"),o=[];o.length||(o=e.filter(e=>e[0]==n)),o.length||(o=e.filter(e=>e[0].match(t)));for(let n=0;n<e.length;n++){const a=e[n];a.length>1&&-1!=o.indexOf(a)&&a[1].match(t)&&-1==e.map(e=>e[0]).indexOf(a[0])&&e.push(a)}return e}(p,d)),e.open&&1==c&&t("activeIndex",s=0),e.hiddenEl&&a&&!a.syncValue&&(t("hiddenEl",a.syncValue=function(){t("value",h=this.value)},a),a.syncValue()),(e.humanEl||e.options||e.hiddenEl)&&i&&!i.value&&i!=document.activeElement){const e=p.find(e=>e[0]==a.value);e&&t("humanEl",i.value=e[1]||e[0],i)}},{activeIndex:s,hiddenEl:a,humanEl:i,open:c,wrapperEl:r,hidden:u,name:l,id:f,options:p,placeholder:g,readonly:m,value:h,keydown:function(e){-1!=o.indexOf(e.key)&&e.preventDefault(),"Tab"!=e.key?c?("ArrowDown"==e.key&&t("activeIndex",s++,s),"ArrowUp"==e.key&&t("activeIndex",s--,s),"Enter"==e.key&&$(e),s>=p.length&&t("activeIndex",s=0),s<0&&t("activeIndex",s=p.length-1)):t("open",c=!0):c&&$(e)},keyup:function(e){1!=e.key.length&&"Backspace"!=e.key||t("typed",d=i.value)},selectOption:$,toggle:function(){t("open",c=!c)},visibleOptions:y,input0_input_handler:function(){h=this.value,t("value",h),t("hiddenEl",a)},input0_binding:function(e){J[e?"unshift":"push"](()=>{t("hiddenEl",a=e)})},input1_binding:function(e){J[e?"unshift":"push"](()=>{t("humanEl",i=e)})},mouseover_handler:({i:e})=>{t("activeIndex",s=e)},div1_binding:function(e){J[e?"unshift":"push"](()=>{t("wrapperEl",r=e)})},$$slots:b,$$scope:v}}class Fi extends xe{constructor(e){super(),we(this,e,qi,Hi,s,{hidden:0,name:0,id:0,options:0,placeholder:0,readonly:0,value:0})}}function Ki(e,n,t){const o=Object.create(e);return o.dialog=n[t],o}function Gi(n){let t;return{c(){(t=N("h1")).textContent=`${Yn("Add conversation")}`},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Wi(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Connection")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Vi(n){return{c:e,m:e,p:e,d:e}}function Zi(e){let n,t=Yn(e.availableDialogs.dialogs.length?"Refresh":"Load")+"";return{c(){n=C(t)},m(e,t){k(e,n,t)},p(e,o){e.availableDialogs&&t!==(t=Yn(o.availableDialogs.dialogs.length?"Refresh":"Load")+"")&&R(n,t)},d(e){e&&E(n)}}}function Yi(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Conversation name")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Ji(n){return{c:e,m:e,p:e,d:e}}function Qi(n){let t,o=Yn("Add")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Xi(e){let n,t,o,a,i=e.availableDialogs.error+"";return{c(){n=N("p"),t=C(e.connectionId),o=C(": "),a=C(i),A(n,"class","error")},m(e,i){k(e,n,i),x(n,t),x(n,o),x(n,a)},p(e,n){e.connectionId&&R(t,n.connectionId),e.availableDialogs&&i!==(i=n.availableDialogs.error+"")&&R(a,i)},d(e){e&&E(n)}}}function er(e){let n,t,o;function a(e,n){return n.availableDialogs.done?tr:nr}let i=a(0,e),r=i(e),s=e.availableDialogs.dialogs,c=[];for(let n=0;n<s.length;n+=1)c[n]=or(Ki(e,s,n));return{c(){n=N("p"),r.c(),t=S(),o=N("div");for(let e=0;e<c.length;e+=1)c[e].c();A(o,"class","dialog-add-list")},m(e,a){k(e,n,a),r.m(n,null),k(e,t,a),k(e,o,a);for(let e=0;e<c.length;e+=1)c[e].m(o,null)},p(e,t){if(i===(i=a(0,t))&&r?r.p(e,t):(r.d(1),(r=i(t))&&(r.c(),r.m(n,null))),e.availableDialogs||e.addDialog){let n;for(s=t.availableDialogs.dialogs,n=0;n<s.length;n+=1){const a=Ki(t,s,n);c[n]?c[n].p(e,a):(c[n]=or(a),c[n].c(),c[n].m(o,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=s.length}},d(e){e&&E(n),r.d(),e&&E(t),e&&E(o),O(c,e)}}}function nr(e){let n,t=Yn("Showing %1 of %2 conversations, but the list is still loading.",e.availableDialogs.dialogs.length,e.availableDialogs.n_dialogs)+"";return{c(){n=C(t)},m(e,t){k(e,n,t)},p(e,o){e.availableDialogs&&t!==(t=Yn("Showing %1 of %2 conversations, but the list is still loading.",o.availableDialogs.dialogs.length,o.availableDialogs.n_dialogs)+"")&&R(n,t)},d(e){e&&E(n)}}}function tr(e){let n,t=Yn("Showing %1 of %2 conversations.",e.availableDialogs.dialogs.length,e.availableDialogs.n_dialogs)+"";return{c(){n=C(t)},m(e,t){k(e,n,t)},p(e,o){e.availableDialogs&&t!==(t=Yn("Showing %1 of %2 conversations.",o.availableDialogs.dialogs.length,o.availableDialogs.n_dialogs)+"")&&R(n,t)},d(e){e&&E(n)}}}function or(e){let n,t,o,a,i,r,s,c,d,u,l,f,p=e.dialog.n_users+"",g=e.dialog.name+"",m=(e.dialog.topic||"No topic.")+"";return{c(){n=N("a"),t=N("span"),o=C(p),a=S(),i=N("b"),r=C(g),s=S(),c=N("i"),d=C(m),u=S(),A(t,"class","dialog-add-list__n-users"),A(i,"class","dialog-add-list__name"),A(c,"class","dialog-add-list__title"),A(n,"href",l="#add:"+e.dialog.name),f=P(n,"click",M(e.addDialog))},m(e,l){k(e,n,l),x(n,t),x(t,o),x(n,a),x(n,i),x(i,r),x(n,s),x(n,c),x(c,d),x(n,u)},p(e,t){e.availableDialogs&&p!==(p=t.dialog.n_users+"")&&R(o,p),e.availableDialogs&&g!==(g=t.dialog.name+"")&&R(r,g),e.availableDialogs&&m!==(m=(t.dialog.topic||"No topic.")+"")&&R(d,m),e.availableDialogs&&l!==(l="#add:"+t.dialog.name)&&A(n,"href",l)},d(e){e&&E(n),f()}}}function ar(e){let n,t,o,a,i,r,s,c,d,u,l,f,p,g,m,h;const $=new fo({props:{$$slots:{default:[Gi]},$$scope:{ctx:e}}});function b(n){e.selectfield_value_binding.call(null,n)}let v={name:"connection_id",options:e.connectionOptions,placeholder:Yn("Select..."),$$slots:{default:[Vi],label:[Wi]},$$scope:{ctx:e}};void 0!==e.connectionId&&(v.value=e.connectionId);const y=new Fi({props:v});J.push(()=>be(y,"value",b));const _=new Ko({props:{type:"button",icon:"sync-alt",disabled:!e.connectionId||!1===e.availableDialogs.done,$$slots:{default:[Zi]},$$scope:{ctx:e}}});function w(n){e.textfield_value_binding.call(null,n)}_.$on("click",e.loadConversations);let O={name:"dialog_id",placeholder:Yn("#room or nick"),autocomplete:"off",$$slots:{default:[Ji],label:[Yi]},$$scope:{ctx:e}};void 0!==e.dialogId&&(O.value=e.dialogId);const C=new Mn({props:O});J.push(()=>be(C,"value",w)),C.$on("keyup",e.debouncedLoadConversations);const D=new Ko({props:{icon:"comment",disabled:!e.connectionId||!e.dialogId,$$slots:{default:[Qi]},$$scope:{ctx:e}}});let R=e.availableDialogs.error&&Xi(e),T=null!==e.availableDialogs.done&&er(e);return{c(){ve($.$$.fragment),n=S(),t=N("main"),(o=N("p")).textContent=`${Yn("Enter the name of an exising conversation, or create a new conversation.")} \n    ${Yn("It is also possible to load in all existing conversations for a given connection.")}`,a=S(),i=N("form"),r=N("div"),ve(y.$$.fragment),c=S(),ve(_.$$.fragment),d=S(),u=N("div"),ve(C.$$.fragment),f=S(),ve(D.$$.fragment),p=S(),R&&R.c(),g=S(),T&&T.c(),A(r,"class","inputs-side-by-side"),A(u,"class","inputs-side-by-side"),A(i,"method","post"),A(t,"class","main"),h=P(i,"submit",M(e.addDialog))},m(s,l){ye($,s,l),k(s,n,l),k(s,t,l),x(t,o),x(t,a),x(t,i),x(i,r),ye(y,r,null),x(r,c),ye(_,r,null),x(i,d),x(i,u),ye(C,u,null),x(u,f),ye(D,u,null),x(i,p),R&&R.m(i,null),x(i,g),T&&T.m(i,null),e.form_binding(i),m=!0},p(e,n){const t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),$.$set(t);const o={};e.connectionOptions&&(o.options=n.connectionOptions),e.$$scope&&(o.$$scope={changed:e,ctx:n}),!s&&e.connectionId&&(s=!0,o.value=n.connectionId,ie(()=>s=!1)),y.$set(o);const a={};(e.connectionId||e.availableDialogs)&&(a.disabled=!n.connectionId||!1===n.availableDialogs.done),(e.$$scope||e.availableDialogs)&&(a.$$scope={changed:e,ctx:n}),_.$set(a);const r={};e.$$scope&&(r.$$scope={changed:e,ctx:n}),!l&&e.dialogId&&(l=!0,r.value=n.dialogId,ie(()=>l=!1)),C.$set(r);const c={};(e.connectionId||e.dialogId)&&(c.disabled=!n.connectionId||!n.dialogId),e.$$scope&&(c.$$scope={changed:e,ctx:n}),D.$set(c),n.availableDialogs.error?R?R.p(e,n):((R=Xi(n)).c(),R.m(i,g)):R&&(R.d(1),R=null),null!==n.availableDialogs.done?T?T.p(e,n):((T=er(n)).c(),T.m(i,null)):T&&(T.d(1),T=null)},i(e){m||(pe($.$$.fragment,e),pe(y.$$.fragment,e),pe(_.$$.fragment,e),pe(C.$$.fragment,e),pe(D.$$.fragment,e),m=!0)},o(e){ge($.$$.fragment,e),ge(y.$$.fragment,e),ge(_.$$.fragment,e),ge(C.$$.fragment,e),ge(D.$$.fragment,e),m=!1},d(o){_e($,o),o&&E(n),o&&E(t),_e(y),_e(_),_e(C),_e(D),R&&R.d(),T&&T.d(),e.form_binding(null),h()}}}function ir(e,n,t){let o;const a=V("user");u(e,a,e=>t("$user",o=e));let i,r,s={dialogs:[],done:null,n_dialogs:0},c="",d="";function l(e){let n="/list"+(d.length?" /"+d+"/":"");"click"==e.type&&s.done&&(n+=" refresh"),r&&clearTimeout(r),a.send({connection_id:c,message:n},n=>{const o=Ke(n);t("availableDialogs",s=o?{dialogs:[],done:!0,n_dialogs:0,error:o}:n);let a=e.interval?e.interval+500:500;a>2e3&&(a=2e3),o||n.done||(r=setTimeout(()=>l({interval:a}),a))})}G(()=>kn(i));const f=qe(l,250);let p;return e.$$.update=(e={$user:1,connectionId:1,connectionOptions:1})=>{e.$user&&t("connectionOptions",p=Array.from(o.connections.keys()).map(e=>[e])),(e.connectionId||e.connectionOptions)&&(c||t("connectionId",c=p[0]?p[0][0]:""))},{user:a,availableDialogs:s,connectionId:c,dialogId:d,formEl:i,addDialog:function(e){const n=e&&e.target&&e.target.closest("a");n&&n.href&&t("dialogId",d=n.href.replace(/.*#add:/,"")),c&&d&&a.findDialog({connection_id:c}).addDialog(d)},loadConversations:l,debouncedLoadConversations:f,connectionOptions:p,selectfield_value_binding:function(e){t("connectionId",c=e),t("connectionOptions",p),t("$user",o)},textfield_value_binding:function(e){t("dialogId",d=e)},form_binding:function(e){J[e?"unshift":"push"](()=>{t("formEl",i=e)})}}}class rr extends xe{constructor(e){super(),we(this,e,ir,ar,s,{})}}function sr(e){let n,t,o,a,i,r,s,c,d=Yn("This should not happen.")+"";const u=new Nn({props:{href:"/",class:"btn",$$slots:{default:[lr]},$$scope:{ctx:e}}});return{c(){n=N("p"),t=C(d),o=C("\n        Please submit "),(a=N("a")).textContent="an issue",i=C(",\n        if the problem does not go away."),r=S(),s=N("p"),ve(u.$$.fragment),A(a,"href","https://github.com/Nordaaker/convos/issues/")},m(e,d){k(e,n,d),x(n,t),x(n,o),x(n,a),x(n,i),k(e,r,d),k(e,s,d),ye(u,s,null),c=!0},p(e,n){const t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),u.$set(t)},i(e){c||(pe(u.$$.fragment,e),c=!0)},o(e){ge(u.$$.fragment,e),c=!1},d(e){e&&E(n),e&&E(r),e&&E(s),_e(u)}}}function cr(e){let n,t,o,a;const i=new Nn({props:{href:"/",class:"btn",$$slots:{default:[fr]},$$scope:{ctx:e}}});return{c(){(n=N("p")).textContent=`${Yn("Could not find the page you are looking for. Maybe you entered an invalid URL?")}`,t=S(),o=N("p"),ve(i.$$.fragment)},m(e,r){k(e,n,r),k(e,t,r),k(e,o,r),ye(i,o,null),a=!0},p(e,n){const t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),i.$set(t)},i(e){a||(pe(i.$$.fragment,e),a=!0)},o(e){ge(i.$$.fragment,e),a=!1},d(e){e&&E(n),e&&E(t),e&&E(o),_e(i)}}}function dr(n){let t,o,a,i=Yn("Starting Convos...")+"";return{c(){t=N("i"),o=S(),a=C(i),A(t,"class","fas fa-spinner fa-spin")},m(e,n){k(e,t,n),k(e,o,n),k(e,a,n)},p:e,i:e,o:e,d(e){e&&E(t),e&&E(o),e&&E(a)}}}function ur(e){let n,t,o,a,i,r,s,c=Yn("You seem to have lost connection to the internet.")+"";const d=new Nn({props:{href:"/",class:"btn",$$slots:{default:[pr]},$$scope:{ctx:e}}});return{c(){n=N("p"),t=N("i"),o=S(),a=C(c),i=S(),r=N("p"),ve(d.$$.fragment),A(t,"class","fas fa-exclamation-triangle")},m(e,c){k(e,n,c),x(n,t),x(n,o),x(n,a),k(e,i,c),k(e,r,c),ye(d,r,null),s=!0},p(e,n){const t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),d.$set(t)},i(e){s||(pe(d.$$.fragment,e),s=!0)},o(e){ge(d.$$.fragment,e),s=!1},d(e){e&&E(n),e&&E(i),e&&E(r),_e(d)}}}function lr(n){let t,o=Yn("Go to landing page")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function fr(n){let t,o=Yn("Go to landing page")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function pr(n){let t,o=Yn("Reload")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function gr(e){let n,t,o,a,i,r,s,c,d=Yn(e.messages[e.status])+"";const u=[ur,dr,cr,sr],l=[];function f(e,n){return"offline"==n.status?0:"loading"==n.status?1:"not_found"==n.status?2:3}return r=f(0,e),s=l[r]=u[r](e),{c(){n=N("main"),t=N("div"),o=N("h2"),a=C(d),i=S(),s.c(),A(n,"class","main align-content-middle")},m(e,s){k(e,n,s),x(n,t),x(t,o),x(o,a),x(t,i),l[r].m(t,null),c=!0},p(e,n){c&&!e.status||d===(d=Yn(n.messages[n.status])+"")||R(a,d);let o=r;(r=f(0,n))===o?l[r].p(e,n):(le(),ge(l[o],1,1,()=>{l[o]=null}),fe(),(s=l[r])||(s=l[r]=u[r](n)).c(),pe(s,1),s.m(t,null))},i(e){c||(pe(s),c=!0)},o(e){ge(s),c=!1},d(e){e&&E(n),l[r].d()}}}function mr(e,n,t){let o;const a=V("settings"),i=V("user");u(e,i,e=>t("$user",o=e));const r=a.loadUser?["loading","pending"]:["loading"];let s;return G(()=>{Ye("body",/(is-logged-)\S+/,"out"),Ye("body",/(page-)\S+/,s)}),e.$$.update=(e={$user:1})=>{e.$user&&t("status",s=o.is("offline")?"offline":o.is(r)?"loading":"not_found")},{user:i,messages:{loading:"Loading",not_found:"Not found",offline:"You appear to be offline"},status:s}}class hr extends xe{constructor(e){super(),we(this,e,mr,gr,s,{})}}const{Object:$r}=$e;function br(e,n,t){const o=$r.create(e);return o.command=n[t],o}function vr(n){let t,o;return{c(){(t=N("h1")).textContent=`${Yn("Help")}`,(o=N("small")).textContent=`v${n.settings.version}`},m(e,n){k(e,t,n),k(e,o,n)},p:e,d(e){e&&E(t),e&&E(o)}}}function yr(n){let t,o,a,i,r=n.command.example+"",s=Yn(n.command.description)+"";return{c(){t=N("dt"),o=C(r),a=N("dd"),i=C(s)},m(e,n){k(e,t,n),x(t,o),k(e,a,n),x(a,i)},p:e,d(e){e&&E(t),e&&E(a)}}}function _r(e){let n,t,o,a,i,r,s,c,d,u,l,f,p,g,m,h,$,b,v,y,_,w,C,D,P,M,R,T,L,j,U,z,B,H,q,F,K,G,W,V,Z,Y,J,Q,X,ee,ne,te,oe,ae,ie,re,se,ce,de,ue,le,fe,me,he=Jn('Got any questions? Come and talk to us in the "#convos" channel on https://freenode.net.')+"",$e=Jn("More information can also be found on https://convos.by.")+"",be=Jn('Using "_" around some text, will convert it into _italic_, __bold__ or ___italic bold___.')+"",we=Jn("Using backticks around some text, will format it as a `code fragment`.")+"";const xe=new fo({props:{$$slots:{default:[vr]},$$scope:{ctx:e}}});let ke=po,Ee=[];for(let n=0;n<ke.length;n+=1)Ee[n]=yr(br(e,ke,n));return{c(){ve(xe.$$.fragment),n=S(),t=N("main"),o=N("p"),i=S(),s=S(),(c=N("h2")).textContent=`${Yn("Shortcuts")}`,d=S(),u=N("dl"),(l=N("dt")).textContent=`${Yn("shift+enter")}`,(f=N("dd")).textContent=`${Yn("Shift focus between chat input and search in sidebar.")}`,p=S(),(g=N("h2")).textContent=`${Yn("Autocomplete")}`,m=S(),(h=N("p")).textContent=`${Yn("The following rules apply when typing a message:")}`,$=S(),b=N("dl"),(v=N("dt")).textContent="@nick",(y=N("dd")).textContent=`${Yn('"@" followed by a character will show matching nicks in the current conversation.')}`,(_=N("dt")).textContent=":emoji_name",(w=N("dd")).textContent=`${Yn('":" followed by a character will show matching emojis.')}`,(C=N("dt")).textContent="/command",(D=N("dd")).textContent=`${Yn('"/" will show the available commands.')}`,(P=N("dt")).textContent="#conversation",(M=N("dd")).textContent=`${Yn('"#" will show the matching conversation names.')}`,R=S(),(T=N("h2")).textContent=`${Yn("Text formatting")}`,L=S(),(j=N("p")).textContent=`${Yn("Convos supports some special way of formatting text:")}`,U=S(),z=N("dl"),(B=N("dt")).textContent=`${Object.keys(qn).sort().map(e.func).join(", ")}`,(H=N("dd")).textContent=`${Yn("Will be automatically converted into emojis.")}`,(q=N("dt")).textContent=`${Yn("> some text")}`,(F=N("dd")).textContent=`${Yn('A line starting with ">" will be converted into a quote.')}`,(K=N("dt")).textContent=`${Yn("_some text_, __some text__, ___some text___")}`,G=N("dd"),(W=N("dt")).textContent=`${Yn("`some fragment`")}`,V=N("dd"),(Z=N("dt")).textContent="https://...",(Y=N("dd")).textContent=`${Yn("URLs will be converted to links, and might be embedded in the chat.")}`,J=S(),(Q=N("h2")).textContent=`${Yn("Available commands")}`,X=S(),ee=N("dl");for(let e=0;e<Ee.length;e+=1)Ee[e].c();ne=S(),(te=N("h2")).textContent=`${Yn("Resources")}`,oe=S(),ae=N("ul"),ie=N("li"),(re=N("a")).textContent=`${Yn("Project homepage")}`,se=S(),ce=N("li"),(de=N("a")).textContent=`${Yn("Bug/issue tracker")}`,ue=S(),le=N("li"),(fe=N("a")).textContent=`${Yn("Source code")}`,a=new I(he,i),r=new I($e,null),A(re,"href","https://convos.by"),A(re,"target","_blank"),A(de,"href","https://github.com/Nordaaker/convos/issues"),A(de,"target","_blank"),A(fe,"href","https://github.com/Nordaaker/convos"),A(fe,"target","_blank"),A(t,"class","main")},m(e,E){ye(xe,e,E),k(e,n,E),k(e,t,E),x(t,o),a.m(o),x(o,i),r.m(o),x(t,s),x(t,c),x(t,d),x(t,u),x(u,l),x(u,f),x(t,p),x(t,g),x(t,m),x(t,h),x(t,$),x(t,b),x(b,v),x(b,y),x(b,_),x(b,w),x(b,C),x(b,D),x(b,P),x(b,M),x(t,R),x(t,T),x(t,L),x(t,j),x(t,U),x(t,z),x(z,B),x(z,H),x(z,q),x(z,F),x(z,K),x(z,G),G.innerHTML=be,x(z,W),x(z,V),V.innerHTML=we,x(z,Z),x(z,Y),x(t,J),x(t,Q),x(t,X),x(t,ee);for(let e=0;e<Ee.length;e+=1)Ee[e].m(ee,null);x(t,ne),x(t,te),x(t,oe),x(t,ae),x(ae,ie),x(ie,re),x(ae,se),x(ae,ce),x(ce,de),x(ae,ue),x(ae,le),x(le,fe),me=!0},p(e,n){const t={};if(e.$$scope&&(t.$$scope={changed:e,ctx:n}),xe.$set(t),e.l||e.commands){let t;for(ke=po,t=0;t<ke.length;t+=1){const o=br(n,ke,t);Ee[t]?Ee[t].p(e,o):(Ee[t]=yr(o),Ee[t].c(),Ee[t].m(ee,null))}for(;t<Ee.length;t+=1)Ee[t].d(1);Ee.length=ke.length}},i(e){me||(pe(xe.$$.fragment,e),me=!0)},o(e){ge(xe.$$.fragment,e),me=!1},d(e){_e(xe,e),e&&E(n),e&&E(t),O(Ee,e)}}}function wr(e){return{settings:V("settings"),func:e=>qn[e]}}class xr extends xe{constructor(e){super(),we(this,e,wr,_r,s,{})}}function kr(n){let t;return{c(){(t=N("span")).textContent=`${Yn("E-mail")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Er(n){return{c:e,m:e,p:e,d:e}}function Or(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Password")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Nr(n){return{c:e,m:e,p:e,d:e}}function Cr(e){let n,t,o,a,i,r,s,c,d,u,l,f,p,g,m,h=Yn("Log in")+"";const $=new Mn({props:{name:"email",placeholder:Yn("Ex: john@doe.com"),$$slots:{default:[Er],label:[kr]},$$scope:{ctx:e}}}),b=new ia({props:{name:"password",$$slots:{default:[Nr],label:[Or]},$$scope:{ctx:e}}}),v=new ea({props:{op:e.loginOp}});return{c(){n=N("main"),(t=N("h1")).textContent=`${Yn("Log in")}`,o=S(),a=N("form"),ve($.$$.fragment),i=S(),ve(b.$$.fragment),r=S(),s=N("div"),c=N("button"),d=C(h),u=S(),ve(v.$$.fragment),l=S(),f=N("article"),(p=N("p")).textContent=`${Yn("Convos is the simplest way to use IRC and it keeps you always online.")}`,A(c,"class","btn"),A(c,"op",e.loginOp),A(s,"class","form-actions"),A(a,"method","post"),A(n,"class","main align-content-middle"),m=P(a,"submit",M(e.submit_handler))},m(e,m){k(e,n,m),x(n,t),x(n,o),x(n,a),ye($,a,null),x(a,i),ye(b,a,null),x(a,r),x(a,s),x(s,c),x(c,d),x(a,u),ye(v,a,null),x(n,l),x(n,f),x(f,p),g=!0},p(e,n){const t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),$.$set(t);const o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),b.$set(o)},i(e){g||(pe($.$$.fragment,e),pe(b.$$.fragment,e),pe(v.$$.fragment,e),g=!0)},o(e){ge($.$$.fragment,e),ge(b.$$.fragment,e),ge(v.$$.fragment,e),g=!1},d(e){e&&E(n),_e($),_e(b),_e(v),m()}}}function Sr(e,n,t){let o;const a=V("user"),i=a.api.operation("loginUser");u(e,i,e=>t("$loginOp",o=e));return e.$$.update=(e={$loginOp:1})=>{e.$loginOp&&o.is("success")&&_n(a,i)},{loginOp:i,submit_handler:e=>i.perform(e.target)}}class Dr extends xe{constructor(e){super(),we(this,e,Sr,Cr,s,{})}}function Pr(n){let t;return{c(){(t=N("span")).textContent=`${Yn("E-mail")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Mr(n){return{c:e,m:e,p:e,d:e}}function Ar(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Password")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Rr(n){return{c:e,m:e,p:e,d:e}}function Tr(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Invite code")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Lr(n){return{c:e,m:e,p:e,d:e}}function jr(e){let n,t,o,a,i,r,s,c,d,u,l,f,p,g,m,h,$,b=Yn("Register")+"";const v=new Mn({props:{name:"email",placeholder:Yn("Ex: john@doe.com"),$$slots:{default:[Mr],label:[Pr]},$$scope:{ctx:e}}}),y=new ia({props:{name:"password",$$slots:{default:[Rr],label:[Ar]},$$scope:{ctx:e}}});let _=e.settings.invite_code&&function(e){let n,t,o,a=Jn("Ask %1 for an invite code.",e.settings.contact)+"";const i=new Mn({props:{name:"invite_code",$$slots:{default:[Lr],label:[Tr]},$$scope:{ctx:e}}});return{c(){ve(i.$$.fragment),n=S(),A(t=N("p"),"class","help")},m(e,r){ye(i,e,r),k(e,n,r),k(e,t,r),t.innerHTML=a,o=!0},p(e,n){const t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),i.$set(t)},i(e){o||(pe(i.$$.fragment,e),o=!0)},o(e){ge(i.$$.fragment,e),o=!1},d(e){_e(i,e),e&&E(n),e&&E(t)}}}(e);const w=new ea({props:{op:e.registerOp}});return{c(){n=N("main"),(t=N("h1")).textContent=`${Yn("Create account")}`,o=S(),a=N("form"),ve(v.$$.fragment),i=S(),(r=N("p")).textContent=`${Yn("Your email will be used if you forget your password.")}`,s=S(),ve(y.$$.fragment),c=S(),(d=N("p")).textContent=`${Yn("Hint: Use a phrase from a book.")}`,u=S(),_&&_.c(),l=S(),f=N("div"),p=N("button"),g=C(b),m=S(),ve(w.$$.fragment),A(r,"class","help"),A(d,"class","help"),A(p,"class","btn"),A(p,"op",e.registerOp),A(f,"class","form-actions"),A(a,"method","post"),A(n,"class","main align-content-middle"),$=P(a,"submit",M(e.submit_handler))},m(e,$){k(e,n,$),x(n,t),x(n,o),x(n,a),ye(v,a,null),x(a,i),x(a,r),x(a,s),ye(y,a,null),x(a,c),x(a,d),x(a,u),_&&_.m(a,null),x(a,l),x(a,f),x(f,p),x(p,g),x(a,m),ye(w,a,null),h=!0},p(e,n){const t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),v.$set(t);const o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),y.$set(o),n.settings.invite_code&&_.p(e,n)},i(e){h||(pe(v.$$.fragment,e),pe(y.$$.fragment,e),pe(_),pe(w.$$.fragment,e),h=!0)},o(e){ge(v.$$.fragment,e),ge(y.$$.fragment,e),ge(_),ge(w.$$.fragment,e),h=!1},d(e){e&&E(n),_e(v),_e(y),_&&_.d(),_e(w),$()}}}function Ir(e,n,t){let o;const a=V("settings"),i=V("user"),r=i.api.operation("registerUser");u(e,r,e=>t("$registerOp",o=e));return e.$$.update=(e={$registerOp:1})=>{e.$registerOp&&o.is("success")&&_n(i,r)},{settings:a,registerOp:r,submit_handler:e=>r.perform(e.target)}}class Ur extends xe{constructor(e){super(),we(this,e,Ir,jr,s,{})}}function zr(n){let t;return{c(){(t=N("h1")).textContent=`${Yn("Settings")}`},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Br(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Email")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Hr(n){return{c:e,m:e,p:e,d:e}}function qr(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Notification keywords")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Fr(n){return{c:e,m:e,p:e,d:e}}function Kr(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Enable notifications")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Gr(n){return{c:e,m:e,p:e,d:e}}function Wr(n){let t;return{c(){(t=N("p")).textContent=`${Yn("You cannot receive notifications, because it is denied by your browser.")}`,A(t,"class","error")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Vr(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Expand URL to media")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Zr(n){return{c:e,m:e,p:e,d:e}}function Yr(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Theme")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Jr(n){return{c:e,m:e,p:e,d:e}}function Qr(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Password")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function Xr(n){return{c:e,m:e,p:e,d:e}}function es(n){let t;return{c(){(t=N("span")).textContent=`${Yn("Repeat password")}`,A(t,"slot","label")},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function ns(n){return{c:e,m:e,p:e,d:e}}function ts(n){let t,o=Yn("Save settings")+"";return{c(){t=C(o)},m(e,n){k(e,t,n)},p:e,d(e){e&&E(t)}}}function os(e){let n,t,o,a,i,r,s,c,d,u,l,f,p,g,m,h,$,b,v,y;const _=new fo({props:{$$slots:{default:[zr]},$$scope:{ctx:e}}}),w=new Mn({props:{name:"email",value:e.$user.email,readonly:!0,$$slots:{default:[Hr],label:[Br]},$$scope:{ctx:e}}}),O=new Mn({props:{name:"highlight_keywords",placeholder:Yn("whatever, keywords"),value:e.highlight_keywords,$$slots:{default:[Fr],label:[qr]},$$scope:{ctx:e}}});function C(n){e.checkbox0_checked_binding.call(null,n)}let D={name:"notifications",$$slots:{default:[Gr],label:[Kr]},$$scope:{ctx:e}};void 0!==e.wantNotifications&&(D.checked=e.wantNotifications);const R=new Yo({props:D});J.push(()=>be(R,"checked",C));let T=e.notificationsDisabled&&Wr();function L(n){e.checkbox1_checked_binding.call(null,n)}let j={name:"expand_url",$$slots:{default:[Zr],label:[Vr]},$$scope:{ctx:e}};void 0!==e.expandUrlToMedia&&(j.checked=e.expandUrlToMedia);const I=new Yo({props:j});function U(n){e.selectfield_value_binding.call(null,n)}J.push(()=>be(I,"checked",L));let z={name:"theme",options:ro,$$slots:{default:[Jr],label:[Yr]},$$scope:{ctx:e}};void 0!==e.theme&&(z.value=e.theme);const B=new Fi({props:z});J.push(()=>be(B,"value",U));const H=new ia({props:{name:"password",$$slots:{default:[Xr],label:[Qr]},$$scope:{ctx:e}}}),q=new ia({props:{name:"password_again",$$slots:{default:[ns],label:[es]},$$scope:{ctx:e}}}),F=new Ko({props:{icon:"save",op:e.updateUserOp,$$slots:{default:[ts]},$$scope:{ctx:e}}}),K=new ea({props:{op:e.updateUserOp}});return{c(){ve(_.$$.fragment),n=S(),t=N("main"),o=N("form"),ve(w.$$.fragment),a=S(),ve(O.$$.fragment),i=S(),ve(R.$$.fragment),s=S(),T&&T.c(),c=S(),ve(I.$$.fragment),u=S(),ve(B.$$.fragment),f=S(),ve(H.$$.fragment),p=S(),ve(q.$$.fragment),g=S(),(m=N("p")).textContent=`${Yn("Leave the password fields empty to keep the current password.")}`,h=S(),$=N("div"),ve(F.$$.fragment),b=S(),ve(K.$$.fragment),A($,"class","form-actions"),A(o,"method","post"),A(t,"class","main"),y=P(o,"submit",M(e.updateUserFromForm))},m(r,d){ye(_,r,d),k(r,n,d),k(r,t,d),x(t,o),ye(w,o,null),x(o,a),ye(O,o,null),x(o,i),ye(R,o,null),x(o,s),T&&T.m(o,null),x(o,c),ye(I,o,null),x(o,u),ye(B,o,null),x(o,f),ye(H,o,null),x(o,p),ye(q,o,null),x(o,g),x(o,m),x(o,h),x(o,$),ye(F,$,null),x(o,b),ye(K,o,null),e.form_binding(o),v=!0},p(e,n){const t={};e.$$scope&&(t.$$scope={changed:e,ctx:n}),_.$set(t);const a={};e.$user&&(a.value=n.$user.email),e.$$scope&&(a.$$scope={changed:e,ctx:n}),w.$set(a);const i={};e.$$scope&&(i.$$scope={changed:e,ctx:n}),O.$set(i);const s={};e.$$scope&&(s.$$scope={changed:e,ctx:n}),!r&&e.wantNotifications&&(r=!0,s.checked=n.wantNotifications,ie(()=>r=!1)),R.$set(s),n.notificationsDisabled?T?T.p(e,n):((T=Wr()).c(),T.m(o,c)):T&&(T.d(1),T=null);const u={};e.$$scope&&(u.$$scope={changed:e,ctx:n}),!d&&e.expandUrlToMedia&&(d=!0,u.checked=n.expandUrlToMedia,ie(()=>d=!1)),I.$set(u);const f={};e.$$scope&&(f.$$scope={changed:e,ctx:n}),!l&&e.theme&&(l=!0,f.value=n.theme,ie(()=>l=!1)),B.$set(f);const p={};e.$$scope&&(p.$$scope={changed:e,ctx:n}),H.$set(p);const g={};e.$$scope&&(g.$$scope={changed:e,ctx:n}),q.$set(g);const m={};e.$$scope&&(m.$$scope={changed:e,ctx:n}),F.$set(m)},i(e){v||(pe(_.$$.fragment,e),pe(w.$$.fragment,e),pe(O.$$.fragment,e),pe(R.$$.fragment,e),pe(I.$$.fragment,e),pe(B.$$.fragment,e),pe(H.$$.fragment,e),pe(q.$$.fragment,e),pe(F.$$.fragment,e),pe(K.$$.fragment,e),v=!0)},o(e){ge(_.$$.fragment,e),ge(w.$$.fragment,e),ge(O.$$.fragment,e),ge(R.$$.fragment,e),ge(I.$$.fragment,e),ge(B.$$.fragment,e),ge(H.$$.fragment,e),ge(q.$$.fragment,e),ge(F.$$.fragment,e),ge(K.$$.fragment,e),v=!1},d(o){_e(_,o),o&&E(n),o&&E(t),_e(w),_e(O),_e(R),T&&T.d(),_e(I),_e(B),_e(H),_e(q),_e(F),_e(K),e.form_binding(null),y()}}}function as(e,n,t){let o;const a=window.Notification||{permission:"denied"},i=V("user");u(e,i,e=>t("$user",o=e));const r=i.api.operation("updateUser");let s,c=i.expandUrlToMedia,d="denied"==a.permission,l=i.theme,f=i.wantNotifications,p=i.highlight_keywords.join(", ");return r.on("start",e=>{e.body.highlight_keywords=e.body.highlight_keywords.split(/[.,\s]+/).map(e=>e.trim())}),{user:i,updateUserOp:r,formEl:s,expandUrlToMedia:c,notificationsDisabled:d,theme:l,wantNotifications:f,highlight_keywords:p,updateUserFromForm:function(e){const n=e.target,o=[n.password.value,n.password_again.value];if(f&&window.Notification&&"granted"!=a.permission&&a.requestPermission(e=>{"denied"==e&&(t("wantNotifications",f=!1),t("notificationsDisabled",d=!0))}),o.join("").length&&o[0]!=o[1])return r.error("Passwords does not match.");i.update({expandUrlToMedia:c,theme:l,wantNotifications:f}),r.perform(e.target)},$user:o,checkbox0_checked_binding:function(e){t("wantNotifications",f=e)},checkbox1_checked_binding:function(e){t("expandUrlToMedia",c=e)},selectfield_value_binding:function(e){t("theme",l=e)},form_binding:function(e){J[e?"unshift":"push"](()=>{t("formEl",s=e)})}}}class is extends xe{constructor(e){super(),we(this,e,as,os,s,{})}}const{window:rs}=$e;function ss(e){let n;const t=new ht({props:{transition:{duration:e.$container.wideScreen?0:250,x:e.$container.width}}});return{c(){ve(t.$$.fragment)},m(e,o){ye(t,e,o),n=!0},p(e,n){const o={};e.$container&&(o.transition={duration:n.$container.wideScreen?0:250,x:n.$container.width}),t.$set(o)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function cs(n){let t;const o=new xt({});return{c(){ve(o.$$.fragment)},m(e,n){ye(o,e,n),t=!0},p:e,i(e){t||(pe(o.$$.fragment,e),t=!0)},o(e){ge(o.$$.fragment,e),t=!1},d(e){_e(o,e)}}}function ds(e){let n,t,o;return{c(){(n=N("div")).textContent="",A(n,"class","overlay")},m(e,t){k(e,n,t),o=!0},i(e){o||(ae(()=>{t||(t=he(n,Rn,{duration:200},!0)),t.run(1)}),o=!0)},o(e){t||(t=he(n,Rn,{duration:200},!1)),t.run(0),o=!1},d(e){e&&E(n),e&&t&&t.end()}}}function us(e){let n,t,o,a,r,s,c,d;ae(e.onwindowresize);const u=[cs,ss],l=[];function f(e,t){return(null==n||e.$user)&&(n=!t.$user.is("loggedIn")),n?0:"nav"==t.$activeMenu||t.$container.wideScreen?1:-1}~(t=f(null,e))&&(o=l[t]=u[t](e));var p=e.$pageComponent;if(p)var g=new p({});let m=e.$activeMenu&&!e.$container.wideScreen&&ds();return{c(){o&&o.c(),a=S(),g&&ve(g.$$.fragment),r=S(),m&&m.c(),s=D(),d=[P(rs,"click",e.onWindowClick),P(rs,"focus",e.onWindowFocus),P(rs,"keydown",ls),P(rs,"resize",e.onwindowresize)]},m(e,n){~t&&l[t].m(e,n),k(e,a,n),g&&ye(g,e,n),k(e,r,n),m&&m.m(e,n),k(e,s,n),c=!0},p(e,n){let i=t;if((t=f(e,n))===i?~t&&l[t].p(e,n):(o&&(le(),ge(l[i],1,1,()=>{l[i]=null}),fe()),~t?((o=l[t])||(o=l[t]=u[t](n)).c(),pe(o,1),o.m(a.parentNode,a)):o=null),p!==(p=n.$pageComponent)){if(g){le();const e=g;ge(e.$$.fragment,1,0,()=>{_e(e,1)}),fe()}p?(ve((g=new p({})).$$.fragment),pe(g.$$.fragment,1),ye(g,r.parentNode,r)):g=null}n.$activeMenu&&!n.$container.wideScreen?m?pe(m,1):((m=ds()).c(),pe(m,1),m.m(s.parentNode,s)):m&&(le(),ge(m,1,1,()=>{m=null}),fe())},i(e){c||(pe(o),g&&pe(g.$$.fragment,e),pe(m),c=!0)},o(e){ge(o),g&&ge(g.$$.fragment,e),ge(m),c=!1},d(e){~t&&l[t].d(e),e&&E(a),g&&_e(g,e),e&&E(r),m&&m.d(e),e&&E(s),i(d)}}}function ls(e){if(!e.shiftKey||13!=e.keyCode)return;e.preventDefault();const n=document.getElementById("sidebar_left_search_input"),t=document.activeElement;if(t!=n&&!Xe(t,"body"))return n.focus();const o=["#chat_input_textarea",'.main input[type="text"]',".main a","#sidebar_left_search_input"];for(let e=0;e<o.length;e++){const n=document.querySelector(o[e]);if(n)return n.focus()}}function fs(e,n,t){let o,a,i,r,s,c;u(e,mn,e=>t("$currentUrl",o=e)),u(e,hn,e=>t("$docTitle",i=e)),u(e,pn,e=>t("$activeMenu",r=e)),u(e,gn,e=>t("$container",s=e)),u(e,$n,e=>t("$pageComponent",c=e));const d=[[new RegExp(".*"),hr,{user:"offline"}],[new RegExp("^/login"),Dr,{}],[new RegExp("^/register"),Ur,{}],[new RegExp("^/add/connection"),ji,{user:"loggedIn"}],[new RegExp("^/add/conversation"),rr,{user:"loggedIn"}],[new RegExp("^/chat"),Ri,{user:"loggedIn"}],[new RegExp("^/help"),xr,{user:"loggedIn"}],[new RegExp("^/settings"),is,{user:"loggedIn"}],[new RegExp("^/docs"),null,{}],[new RegExp("^/paste"),null,{}],[new RegExp("^/$"),null,{user:["error","success"],gotoLast:!0}],[new RegExp(".*"),hr,{}]],l=[window.__convos,delete window.__convos][0],f=new on(l.apiUrl,{debug:!0}),p=new io({api:f,wsUrl:l.wsUrl});u(e,p,e=>t("$user",a=e));let m=0;function h(e){let n=["","chat",e.connection_id];if(g(pn,r=""),"part"==e.command[0]){const e=document.querySelector('.sidebar-left [href$="'+n.map(encodeURIComponent).join("/")+'"]');vn(e?e.href:"/chat")}else e.dialog_id&&n.push(e.dialog_id),vn(n.map(encodeURIComponent).join("/"))}return window.hljs=an,mn.base=l.baseUrl,p.events.listenToGlobalEvents(),W("settings",l),W("user",p),"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(e=>{p.version!=l.assetVersion&&(console.log("[Convos] Version changed from "+p.version+" to "+l.assetVersion),p.update({version:l.assetVersion}),e.update(),location.href=xn("/"))}).catch(e=>{console.log("[Convos] ServiceWorker registration failed:",e)}),G(()=>{Ge(mn.base+"/images/emojis.js"),l.loadUser&&p.load(),p.showGrid&&document.querySelector("body").classList.add("with-grid");const e=[];return e.push(function(){var e=function(){return mn.set(yn(location.href))};return window.addEventListener("popstate",e),function(){return window.removeEventListener("popstate",e)}}()),e.push(p.on("wsEventSentJoin",h)),e.push(p.on("wsEventSentPart",h)),()=>e.forEach(e=>e())}),e.$$.update=(e={containerWidth:1,$currentUrl:1,$user:1,$docTitle:1})=>{e.containerWidth&&gn.set({wideScreen:m>800,width:m}),(e.$currentUrl||e.$user)&&function(e,n,t){var o=e.path,a=[n.status,o].join(":");if(a!=fn){for(var i=0;i<t.length;i++){var r=Ae(t[i],3),s=r[0],c=r[1],d=r[2];if(s.test(o)&&(!d.user||n.is(d.user))){if(d.gotoLast)return vn(n.calculateLastUrl());wn(c),Ye("body",/(is-logged-)\S+/,n.is("loggedIn")?"in":"out"),Ye("body",/(page-)\S+/,d.name||e.pathParts[0]),"success"==d.user&&n.update({lastUrl:e.toString()});break}}fn=a}}(o,a,d),e.$user&&function(e){0==ro.filter((function(n){return n[0]==e})).length&&(e="auto"),"auto"==e&&(e=so);var n=document.documentElement;n.className=n.className.replace(/theme-\S+/,(function(){return"theme-"+e}))}(a.theme),(e.$user||e.$docTitle)&&document&&(document.title=a.unread?"("+a.unread+") "+i:i)},{routingRules:d,user:p,containerWidth:m,onWindowClick:function(e){const n=He(e.target,"a"),t=n&&n.href.match(/#(call:user):(\w+)/)||["","",""];if(t[2])return e.preventDefault(),void p[t[2]]();const a=n&&n.href.match(/(.*)#(activeMenu):(\w*)/)||["","","",""];0==a[1].indexOf("http")&&o.toString()!=a[1]&&vn(a[1]),He(e.target,".sidebar-left")&&!n||He(e.target,".main")&&!a[3]||((a[2]||r)&&e.preventDefault(),g(pn,r=a[3]==r?"":a[3]))},onWindowFocus:function(){p.ensureConnected()},$user:a,$activeMenu:r,$container:s,$pageComponent:c,onwindowresize:function(){t("containerWidth",m=rs.innerWidth)}}}var ps=document.querySelector("body");new class extends xe{constructor(e){super(),we(this,e,fs,us,s,{routingRules:0})}get routingRules(){return this.$$.ctx.routingRules}}({target:document.body});ps.classList=ps.className.replace(/no-js/,"has-js")}();
//# sourceMappingURL=convos.5dcbab15.js.map
